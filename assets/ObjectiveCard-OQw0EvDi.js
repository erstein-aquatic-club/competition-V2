import{j as n}from"./vendor-query-DyA9aSKS.js";import{B as p}from"./badge-skqrzgTN.js";const w=["50NL","100NL","200NL","400NL","800NL","1500NL","50DOS","100DOS","200DOS","50BR","100BR","200BR","50PAP","100PAP","200PAP","200QN","400QN"];function h(e){const t=e.match(/^(\d+)(NL|DOS|BR|PAP|QN)$/);if(!t)return e;const s={NL:"Nage Libre",DOS:"Dos",BR:"Brasse",PAP:"Papillon",QN:"4 Nages"};return`${t[1]}m ${s[t[2]]||t[2]}`}function u(e){const t=Math.floor(e/60),s=e%60,a=Math.floor(s),l=Math.round((s-a)*100);return`${t}:${String(a).padStart(2,"0")}:${String(l).padStart(2,"0")}`}function E(e){const t=e.match(/^(\d+):(\d{2})[.::](\d{2})$/);return t?parseInt(t[1])*60+parseInt(t[2])+parseInt(t[3])/100:null}const _={"50NL":["50 NL","50 Nage Libre"],"100NL":["100 NL","100 Nage Libre"],"200NL":["200 NL","200 Nage Libre"],"400NL":["400 NL","400 Nage Libre"],"800NL":["800 NL","800 Nage Libre"],"1500NL":["1500 NL","1500 Nage Libre"],"50DOS":["50 Dos"],"100DOS":["100 Dos"],"200DOS":["200 Dos"],"50BR":["50 Brasse","50 Bra."],"100BR":["100 Brasse","100 Bra."],"200BR":["200 Brasse","200 Bra."],"50PAP":["50 Papillon","50 Pap","50 Pap."],"100PAP":["100 Papillon","100 Pap","100 Pap."],"200PAP":["200 Papillon","200 Pap","200 Pap."],"200QN":["200 4 Nages","200 4N","200 4 N."],"400QN":["400 4 Nages","400 4N","400 4 N."]},P={NL:"border-l-blue-500",DOS:"border-l-emerald-500",BR:"border-l-red-500",PAP:"border-l-violet-500",QN:"border-l-amber-500"};function L(e){const t=e.match(/^(\d+)(NL|DOS|BR|PAP|QN)$/);return t?t[2]:null}const b={50:1,100:4,200:10,400:15,800:30,1500:45};function B(e){const t=e.match(/^(\d+)(NL|DOS|BR|PAP|QN)$/);return t?Number(t[1]):null}function O(e,t,s){if(e<=t)return 100;const a=B(s),l=a?b[a]??10:10,r=t+l;return e>=r?0:Math.round((r-e)/(r-t)*100)}function D(e,t,s){const a=_[t];if(!a)return null;const l=a.map(o=>o.toLowerCase());let r=null;for(const o of e)o.time_seconds!=null&&l.includes(o.event_code.toLowerCase())&&(s!=null&&o.pool_length!=null&&o.pool_length!==s||(r===null||o.time_seconds<r.time)&&(r={time:o.time_seconds,date:o.competition_date??null}));return r}const S={NL:"border-t-blue-500",DOS:"border-t-emerald-500",BR:"border-t-rose-500",PAP:"border-t-violet-500",QN:"border-t-amber-500"};function j(e){return e==null?"#a1a1aa":e>=100?"#10b981":e>=75?"#22c55e":e>=50?"#eab308":e>=25?"#f97316":"#ef4444"}const R="#a1a1aa";function $(e){const t=new Date(e+"T00:00:00"),s=new Date;s.setHours(0,0,0,0);const a=Math.round((s.getTime()-t.getTime())/(1e3*60*60*24));return a<=0?"aujourd'hui":a===1?"hier":a<60?`il y a ${a}j`:`il y a ${Math.round(a/30)}m`}function x({size:e=40,strokeWidth:t=3,progress:s,color:a}){const l=(e-t)/2,r=2*Math.PI*l,o=s!=null?Math.min(Math.max(s,0),100):0,c=r-o/100*r;return n.jsxs("svg",{width:e,height:e,viewBox:`0 0 ${e} ${e}`,className:"shrink-0","aria-hidden":!0,children:[n.jsx("circle",{cx:e/2,cy:e/2,r:l,fill:"none",stroke:"currentColor",strokeWidth:t,className:"text-muted-foreground/10"}),s!=null&&n.jsx("circle",{cx:e/2,cy:e/2,r:l,fill:"none",stroke:a,strokeWidth:t,strokeDasharray:r,strokeDashoffset:c,strokeLinecap:"round",transform:`rotate(-90 ${e/2} ${e/2})`,className:"transition-all duration-700"}),s==null&&n.jsx("circle",{cx:e/2,cy:e/2,r:3,fill:a})]})}function v({children:e}){return n.jsx("div",{className:"grid grid-cols-2 gap-2",children:e})}function k({objective:e,performances:t=[],onClick:s,compact:a=!1,showCoachBadge:l=!1}){const r=!!e.event_code,o=r?L(e.event_code):null,c=o?S[o]??"":"",g=o?P[o]??"":"",d=r?D(t,e.event_code,e.pool_length):null;let i=null,m=null;d&&e.target_time_seconds!=null&&e.event_code&&(i=d.time-e.target_time_seconds,m=O(d.time,e.target_time_seconds,e.event_code));const f=j(m),N=s?"button":"div";return a?n.jsxs(N,{type:s?"button":void 0,className:["w-full text-left flex items-center gap-2.5 rounded-lg border-l-4 px-2.5 py-1.5",g||"border-l-muted-foreground/20","bg-card transition-colors hover:bg-muted/30 active:scale-[0.995]"].join(" "),onClick:s,children:[n.jsx(x,{size:22,strokeWidth:2.5,progress:m,color:f}),n.jsxs("div",{className:"flex-1 min-w-0 flex items-baseline gap-1.5",children:[n.jsx("span",{className:"text-xs font-semibold truncate",children:r?h(e.event_code):e.text??"â€”"}),r&&e.pool_length&&n.jsxs("span",{className:"text-[10px] text-muted-foreground/50 shrink-0",children:[e.pool_length,"m"]})]}),e.target_time_seconds!=null&&n.jsx("span",{className:"text-[11px] font-mono tabular-nums text-primary shrink-0",children:u(e.target_time_seconds)}),i!=null&&n.jsx("span",{className:`text-[10px] font-mono tabular-nums shrink-0 ${i<=0?"text-emerald-500 font-semibold":"text-muted-foreground/60"}`,children:i<=0?"OK":`+${i.toFixed(2)}`}),l&&n.jsx(p,{variant:"secondary",className:"text-[8px] px-1 py-0 leading-tight shrink-0",children:"C"})]}):n.jsx(N,{type:s?"button":void 0,className:["w-full text-left rounded-xl border shadow-sm bg-card overflow-hidden",c?`border-t-[3px] ${c}`:"","transition-all hover:shadow-md active:scale-[0.98]"].join(" "),onClick:s,children:n.jsxs("div",{className:"px-3 pt-3 pb-2.5 space-y-2",children:[n.jsxs("div",{className:"flex items-start justify-between gap-1",children:[n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-sm font-semibold truncate leading-tight",children:r?h(e.event_code):"Objectif"}),r&&e.pool_length&&n.jsxs("p",{className:"text-[10px] text-muted-foreground/50 mt-0.5",children:[e.pool_length,"m"]})]}),l&&n.jsx(p,{variant:"secondary",className:"text-[9px] px-1 py-0 leading-tight shrink-0",children:"Coach"})]}),e.text&&n.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 leading-relaxed",children:e.text}),e.target_time_seconds!=null&&n.jsxs("div",{className:"flex items-center gap-2.5",children:[n.jsx(x,{size:40,strokeWidth:3,progress:m,color:f}),n.jsxs("div",{className:"flex-1 min-w-0 space-y-0.5",children:[n.jsx("p",{className:"text-sm font-mono tabular-nums text-primary font-semibold leading-none",children:u(e.target_time_seconds)}),d&&n.jsxs("p",{className:"text-[10px] font-mono tabular-nums text-muted-foreground/50 leading-none",children:[u(d.time),d.date&&n.jsx("span",{className:"text-muted-foreground/30 font-sans ml-1",children:$(d.date)})]}),i!=null&&n.jsx("p",{className:`text-xs font-mono tabular-nums font-semibold leading-none ${i<=0?"text-emerald-500":"text-amber-500"}`,children:i<=0?"Atteint":`+${i.toFixed(2)}s`}),!d&&t.length>0&&n.jsx("p",{className:"text-[10px] text-muted-foreground/40 italic",children:"Pas encore de temps"})]})]}),!r&&n.jsxs("div",{className:"flex items-center gap-2.5",children:[n.jsx(x,{size:40,strokeWidth:3,progress:null,color:R}),n.jsx("p",{className:"text-[10px] text-muted-foreground/40 italic",children:"Objectif qualitatif"})]})]})})}export{w as F,k as O,v as a,h as e,u as f,E as p};
