const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CoachSwimmersOverview-CBTuZU1Z.js","assets/vendor-query-DyA9aSKS.js","assets/vendor-react-BzrpNAyj.js","assets/api-DdtoUjIe.js","assets/index-y3Wa70hQ.js","assets/vendor-charts-BrQ8X25f.js","assets/vendor-supabase-DFPLkPj_.js","assets/vendor-motion-lao-Njgm.js","assets/index-CWfZZog5.css","assets/swim-QnZcsSfv.js","assets/badge-COAMwhMx.js","assets/arrow-left-zijTUOgg.js","assets/search-C7MK64I2.js","assets/trophy-C94Qnhgz.js","assets/bell-ring-DThwqwzs.js","assets/chevron-right-BnjALnRv.js","assets/zap-DB5XfjJm.js","assets/clock-Bi3aMc-L.js","assets/CoachMessagesScreen-BMaCQhIK.js","assets/textarea-DiNAIg04.js","assets/select-CqENG-fm.js","assets/index-DPu_MBGZ.js","assets/index-ODEDP5HX.js","assets/index-DCX2sNhR.js","assets/chevron-down-BoUwxA-T.js","assets/chevron-up-DrNA8pkY.js","assets/CoachSmsScreen-DYmsUg6G.js","assets/command-6jkk1MyZ.js","assets/index-2iZcDYnp.js","assets/dialog-Bb411NLB.js","assets/smsUtils-C6j6VFaw.js","assets/copy-C6d1wF5i.js","assets/CoachCalendar-Ct6rUeYQ.js","assets/CalendarGrid-JSJ_F-RN.js","assets/chevron-left-DHN_ccs9.js","assets/toggle-group-BXjaM5ug.js","assets/index-BQPOxxRY.js","assets/sheet-C8Q_E7N_.js","assets/InlineBanner-B4aBkknm.js","assets/circle-alert-C1QkzbF1.js","assets/trash-2-DWiYVaRZ.js","assets/CoachGroupsScreen-St0KzHjQ.js","assets/checkbox-C3Qrt8Wo.js","assets/separator-mlL8fugj.js","assets/alert-dialog-BC77CPFA.js","assets/collapsible-DRyDdYpB.js","assets/user-plus-Cns6rt7w.js","assets/power-BHzqYM1h.js","assets/CoachCompetitionsScreen-DivS004w.js","assets/CoachObjectivesScreen-CJpsiU0B.js","assets/objectiveHelpers-D7Sv8PWO.js","assets/CoachTrainingSlotsScreen-DJ_cZ6Lf.js","assets/radio-group-XlygvUxZ.js","assets/circle-DoOj-2R5.js","assets/map-pin-D_zHNiKc.js","assets/CoachSwimmerDetail-CRFpuadE.js","assets/tabs-FjTVuA3E.js","assets/weekTypeColor-DC0MOUem.js","assets/chart-column-BJtzHm0k.js","assets/date-DrpgLmFD.js","assets/vendor-date-B8Mnp-Vt.js","assets/pencil-DIED5aLI.js","assets/StrengthCatalog-DtExU4Fq.js","assets/SessionListView-Djto7poC.js","assets/play-hYusgQ1y.js","assets/save-eytRFJAj.js","assets/share-2-DTmLZ2x0.js","assets/drawer-DGEhyYUF.js","assets/loader-circle-DD8xMYJw.js","assets/pen-WZj9ESLz.js","assets/SwimCatalog-CZoBzeen.js","assets/SwimSessionTimeline-DjYckyhS.js","assets/SwimTimeInput-n9ZKwZbr.js","assets/timer-CWgYLZjU.js","assets/eye-D-NvxnpP.js","assets/sparkles-DKpn8bnD.js"])))=>i.map(i=>d[i]);
import{c as Q,B as R,u as $,b as ie,C as ce,g as oe,i as de,U as W,j as me,e as ue,k as B,l as x,I as xe,W as H,D as he,_ as h}from"./index-y3Wa70hQ.js";import{j as e,r as a,u as A}from"./vendor-query-DyA9aSKS.js";import{a as k}from"./api-DdtoUjIe.js";import{A as pe}from"./arrow-left-zijTUOgg.js";import{S as ge}from"./search-C7MK64I2.js";import{T as D}from"./trophy-C94Qnhgz.js";import{B as K}from"./bell-ring-DThwqwzs.js";import{C as L}from"./chevron-right-BnjALnRv.js";import{Z as be}from"./zap-DB5XfjJm.js";import{C as fe}from"./clock-Bi3aMc-L.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}],["path",{d:"M3.22 13H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"auskq0"}]],U=Q("heart-pulse",je);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]],ye=Q("users-round",Ne),G=({title:t,description:g,onBack:b,actions:s})=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(R,{variant:"ghost",size:"sm",className:"-ml-2",onClick:b,children:[e.jsx(pe,{className:"mr-2 h-4 w-4"}),"Retour"]}),e.jsx("h2",{className:"text-2xl font-display font-semibold uppercase italic text-primary",children:t}),g?e.jsx("p",{className:"text-sm text-muted-foreground",children:g}):null]}),s?e.jsx("div",{className:"flex items-center gap-2",children:s}):null]}),we=a.lazy(()=>h(()=>import("./CoachSwimmersOverview-CBTuZU1Z.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]))),ke=a.lazy(()=>h(()=>import("./CoachMessagesScreen-BMaCQhIK.js"),__vite__mapDeps([18,1,2,3,4,5,6,7,8,9,19,20,21,22,23,24,25,14,11,12,13,15,16,17]))),ve=a.lazy(()=>h(()=>import("./CoachSmsScreen-DYmsUg6G.js"),__vite__mapDeps([26,1,2,4,5,6,7,8,10,19,27,22,28,29,12,30,31,3,9,11,13,14,15,16,17]))),_e=a.lazy(()=>h(()=>import("./CoachCalendar-Ct6rUeYQ.js"),__vite__mapDeps([32,1,2,33,34,4,5,6,7,8,15,13,3,9,20,21,22,23,24,25,35,36,37,28,38,39,40,11,12,14,16,17]))),Ce=a.lazy(()=>h(()=>import("./CoachGroupsScreen-St0KzHjQ.js"),__vite__mapDeps([41,1,2,3,4,5,6,7,8,9,10,42,23,22,43,37,28,44,45,11,46,24,47,40,12,13,14,15,16,17]))),Se=a.lazy(()=>h(()=>import("./CoachCompetitionsScreen-DivS004w.js"),__vite__mapDeps([48,1,2,3,4,5,6,7,8,9,19,37,28,22,44,42,23,20,21,24,25,13,11,12,14,15,16,17]))),Ae=a.lazy(()=>h(()=>import("./CoachObjectivesScreen-CJpsiU0B.js"),__vite__mapDeps([49,1,2,3,4,5,6,7,8,9,19,10,20,21,22,23,24,25,35,36,37,28,44,50,11,12,13,14,15,16,17]))),Le=a.lazy(()=>h(()=>import("./CoachTrainingSlotsScreen-DJ_cZ6Lf.js"),__vite__mapDeps([51,1,2,3,4,5,6,7,8,9,10,43,37,28,22,44,20,21,23,24,25,52,36,53,34,15,17,54,40,11,12,13,14,16]))),Ee=a.lazy(()=>h(()=>import("./CoachSwimmerDetail-CRFpuadE.js"),__vite__mapDeps([55,1,2,4,5,6,7,8,3,9,56,36,21,10,57,58,24,19,20,22,23,25,35,37,28,44,50,40,59,60,31,61,45,30,17,15,13,54,11]))),De=a.lazy(()=>h(()=>import("./StrengthCatalog-DtExU4Fq.js"),__vite__mapDeps([62,1,2,3,4,5,6,7,8,9,52,36,21,23,53,19,29,28,22,42,44,56,20,24,25,63,34,64,65,15,39,61,66,40,67,27,12,68,69]))),Re=a.lazy(()=>h(()=>import("./SwimCatalog-CZoBzeen.js"),__vite__mapDeps([70,1,2,3,4,5,6,7,8,9,29,28,22,44,15,71,72,25,73,74,24,17,63,34,64,65,21,36,53,39,61,66,40,19,20,23,31,75,59,60,12])));function P({children:t}){return e.jsxs("div",{className:"flex items-center gap-3 pb-0.5",children:[e.jsx("span",{className:"text-[9px] font-black uppercase tracking-[0.28em] text-muted-foreground/70",children:t}),e.jsx("div",{className:"flex-1 h-px bg-border/50"})]})}const Te=({onNavigate:t,onOpenRecordsAdmin:g,onOpenRecordsClub:b,onOpenAthlete:s,athletes:l,athletesLoading:v,kpiLoading:N,fatigueAlerts:c,mostLoadedAthlete:p,swimSessionCount:E,strengthSessionCount:T})=>{const O=new Date().toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"}),[w,_]=a.useState(""),d=a.useDeferredValue(w.trim().toLocaleLowerCase("fr-FR")),f=a.useMemo(()=>d?l.filter(n=>{const r=n.display_name.toLocaleLowerCase("fr-FR"),o=n.group_label?.toLocaleLowerCase("fr-FR")??"";return r.includes(d)||o.includes(d)}).slice(0,6):l.slice(0,5),[l,d]),m=c.length>0,j=m?{label:`${c.length} alerte${c.length>1?"s":""} fatigue`,detail:c.slice(0,2).map(n=>n.athleteName.split(" ")[0]).join(", ")+(c.length>2?"…":""),action:()=>t("swimmers")}:{label:"Séance du jour",detail:"Assigner · Planifier un groupe",action:()=>t("calendar")},C=[{label:"Natation",icon:H,action:()=>t("swim"),color:"text-cyan-500"},{label:"Muscu",icon:he,action:()=>t("strength"),color:"text-violet-500"},{label:"Groupes",icon:ye,action:()=>t("groups"),color:"text-emerald-500"},{label:"Compétitions",icon:D,action:()=>t("competitions"),color:"text-amber-500"},{label:"Créneaux",icon:fe,action:()=>t("training-slots"),color:"text-blue-500"},{label:"SMS",icon:K,action:()=>t("sms"),color:"text-rose-500"},{label:"Records",icon:D,action:b,color:"text-orange-500"},{label:"Admin rec.",icon:D,action:g,color:"text-slate-500"}];return e.jsxs("div",{className:"space-y-5 pb-24",children:[e.jsx("style",{children:`
        @keyframes cta-breathe {
          0%, 100% { opacity: 0.55; transform: scale(1); }
          50%       { opacity: 0.85; transform: scale(1.06); }
        }
        @keyframes cta-breathe-alert {
          0%, 100% { opacity: 0.45; }
          50%       { opacity: 0.85; }
        }
        @keyframes shimmer-slide {
          0%   { transform: translateX(-100%) skewX(-12deg); }
          100% { transform: translateX(300%) skewX(-12deg); }
        }
        .cta-glow     { animation: cta-breathe 3.5s ease-in-out infinite; }
        .cta-glow-alert { animation: cta-breathe-alert 1.4s ease-in-out infinite; }
        .cta-shimmer  { animation: shimmer-slide 2.8s ease-in-out infinite 0.8s; }
      `}),e.jsxs("div",{className:"sticky top-0 z-20 -mx-4 border-b bg-background/95 px-4 py-3 backdrop-blur",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>t("home"),className:"shrink-0 rounded-full border px-3 py-2 text-sm font-semibold active:bg-muted",children:"Aujourd'hui"}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ge,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(xe,{value:w,onChange:n=>_(n.target.value),placeholder:"Rechercher un nageur",className:"h-10 rounded-full pl-9"})]}),e.jsx(R,{size:"sm",className:"shrink-0 rounded-full",onClick:()=>t("messaging"),children:"Message"})]}),e.jsx("p",{className:"mt-2 text-[11px] uppercase tracking-[0.18em] text-muted-foreground capitalize",children:O})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsx(P,{children:"Le Quotidien"}),e.jsxs("button",{type:"button",onClick:j.action,className:["relative w-full overflow-hidden rounded-3xl text-white transition-all duration-200 active:scale-[0.97]",m?"bg-gradient-to-br from-rose-500 via-red-500 to-orange-500":"bg-gradient-to-br from-indigo-600 via-violet-600 to-blue-700"].join(" "),children:[e.jsx("div",{className:m?"cta-glow-alert absolute inset-0":"cta-glow absolute inset-0",style:{background:m?"radial-gradient(ellipse at 20% 60%, rgba(255,80,60,0.6) 0%, transparent 65%)":"radial-gradient(ellipse at 20% 60%, rgba(139,92,246,0.6) 0%, transparent 65%)"}}),e.jsx("div",{className:"cta-shimmer absolute top-0 bottom-0 left-0 w-1/3 pointer-events-none",style:{background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.12), transparent)"}}),e.jsxs("div",{className:"relative flex items-center gap-4 px-6 py-7",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[m&&e.jsxs("div",{className:"mb-2.5 inline-flex items-center gap-1.5 rounded-full bg-white/20 px-2.5 py-1",children:[e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-white opacity-75"}),e.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-white"})]}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-[0.22em]",children:"Attention requise"})]}),e.jsx("p",{className:"text-[1.6rem] font-bold leading-tight tracking-tight",children:j.label}),e.jsx("p",{className:"mt-1.5 text-sm opacity-75",children:j.detail})]}),e.jsx("div",{className:"flex h-14 w-14 shrink-0 items-center justify-center rounded-2xl bg-white/15 backdrop-blur-sm border border-white/20",children:m?e.jsx(U,{className:"h-7 w-7 animate-pulse"}):e.jsx(H,{className:"h-7 w-7"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>t("objectives"),className:"flex items-center gap-2.5 rounded-2xl border bg-card px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-xl bg-amber-100 dark:bg-amber-900/30",children:e.jsx(D,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Objectifs"}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Temps cibles"})]})]}),e.jsxs("button",{type:"button",onClick:()=>t("messaging"),className:"flex items-center gap-2.5 rounded-2xl border bg-card px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-xl bg-blue-100 dark:bg-blue-900/30",children:e.jsx(K,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Message"}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Notifier un groupe"})]})]})]})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsx(P,{children:"Tour de Contrôle"}),e.jsxs("div",{className:["rounded-3xl border p-4 space-y-3 transition-colors",m?"border-red-200 bg-red-50/70 dark:border-red-900/50 dark:bg-red-950/25":"bg-card border-border"].join(" "),children:[m&&!N&&e.jsx("div",{className:"space-y-1.5",children:c.map(n=>e.jsxs("button",{type:"button",onClick:()=>t("swimmers"),className:"flex w-full items-center gap-3 rounded-2xl bg-white/70 dark:bg-black/20 px-3.5 py-2.5 text-left transition-colors active:bg-white/90",children:[e.jsxs("span",{className:"relative flex h-3 w-3 shrink-0",children:[e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-red-400 opacity-60"}),e.jsx("span",{className:"relative inline-flex h-3 w-3 rounded-full bg-red-500"})]}),e.jsx("span",{className:"flex-1 text-sm font-semibold text-red-900 dark:text-red-200",children:n.athleteName}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-red-600 dark:text-red-400",children:"Fatigue max"}),e.jsx(L,{className:"h-3.5 w-3.5 text-red-400"})]},n.athleteName))}),e.jsxs("div",{className:"grid grid-cols-2 gap-2.5",children:[e.jsxs("div",{className:["rounded-2xl p-3.5",m?"bg-white/50 dark:bg-black/20":"bg-muted/40"].join(" "),children:[e.jsxs("div",{className:"mb-2 flex items-center gap-1.5",children:[e.jsx(U,{className:`h-3.5 w-3.5 ${c.length>0?"text-red-500":"text-muted-foreground"}`}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-[0.18em] text-muted-foreground",children:"Alertes"})]}),e.jsx("p",{className:`text-4xl font-black tabular-nums leading-none ${c.length>0?"text-red-600 dark:text-red-400":"text-foreground"}`,children:N?"–":c.length}),e.jsx("p",{className:"mt-1.5 text-[11px] text-muted-foreground truncate",children:N?"Calcul…":c.length>0?c.slice(0,2).map(n=>n.athleteName.split(" ")[0]).join(", "):"Aucune alerte"})]}),e.jsxs("div",{className:["rounded-2xl p-3.5",m?"bg-white/50 dark:bg-black/20":"bg-muted/40"].join(" "),children:[e.jsxs("div",{className:"mb-2 flex items-center gap-1.5",children:[e.jsx(be,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-[0.18em] text-muted-foreground",children:"Plus chargé"})]}),e.jsx("p",{className:"text-2xl font-black truncate leading-none",children:N?"–":p?.athleteName?.split(" ")[0]??"–"}),e.jsx("p",{className:"mt-1.5 text-[11px] text-muted-foreground",children:N?"Calcul…":p?`Charge ${Math.round(p.loadScore)}`:"Pas de données"})]})]})]})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-0.5",children:[e.jsx("span",{className:"text-[9px] font-black uppercase tracking-[0.28em] text-muted-foreground/70",children:"Nageurs"}),e.jsx("div",{className:"flex-1 h-px bg-border/50"}),w?e.jsx("button",{type:"button",onClick:()=>_(""),className:"text-[10px] font-bold text-primary",children:"Effacer"}):e.jsxs("button",{type:"button",onClick:()=>t("swimmers"),className:"flex items-center gap-0.5 text-[10px] font-bold text-primary",children:["Tous ",e.jsx(L,{className:"h-3 w-3"})]})]}),e.jsx("div",{className:"overflow-hidden rounded-3xl border bg-card shadow-sm",children:v?e.jsx("div",{className:"divide-y divide-border/60",children:[1,2,3,4].map(n=>e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3.5",children:[e.jsx("div",{className:"h-9 w-9 animate-pulse rounded-full bg-muted"}),e.jsxs("div",{className:"flex-1 space-y-1.5",children:[e.jsx("div",{className:"h-3.5 w-28 animate-pulse rounded bg-muted"}),e.jsx("div",{className:"h-3 w-18 animate-pulse rounded bg-muted"})]})]},n))}):f.length===0?e.jsx("p",{className:"px-4 py-8 text-center text-sm text-muted-foreground",children:"Aucun nageur trouvé."}):e.jsx("div",{className:"divide-y divide-border/60",children:f.map(n=>{const r=c.some(S=>S.athleteName===n.display_name),o=n.display_name.charAt(0).toUpperCase();return e.jsxs("button",{type:"button",onClick:()=>s(n),className:"flex w-full items-center gap-3 px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:["flex h-9 w-9 shrink-0 items-center justify-center rounded-full text-sm font-bold transition-all",r?"bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-400 ring-2 ring-red-400/60 ring-offset-1":"bg-primary/10 text-primary"].join(" "),children:o}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"truncate text-sm font-semibold",children:n.display_name}),e.jsx("p",{className:"truncate text-[11px] text-muted-foreground",children:n.group_label||"Sans groupe"})]}),r?e.jsxs("span",{className:"inline-flex shrink-0 items-center gap-1 rounded-full bg-red-100 px-2.5 py-1 text-[9px] font-black uppercase tracking-widest text-red-600 dark:bg-red-900/30 dark:text-red-400",children:[e.jsx("span",{className:"h-1.5 w-1.5 animate-pulse rounded-full bg-current"}),"Alerte"]}):e.jsx(L,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]},n.id??n.display_name)})})})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsx(P,{children:"Arsenal"}),e.jsxs("div",{className:"space-y-2 rounded-3xl border bg-card p-3 shadow-sm",children:[e.jsxs("button",{type:"button",onClick:()=>t("calendar"),className:"flex w-full items-center gap-3 rounded-2xl bg-muted/40 px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-9 w-9 shrink-0 items-center justify-center rounded-xl bg-violet-100 dark:bg-violet-900/30",children:e.jsx(B,{className:"h-4.5 w-4.5 text-violet-600 dark:text-violet-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Calendrier · Assigner"}),e.jsxs("p",{className:"text-[11px] text-muted-foreground",children:[E??0," séances nat · ",T??0," muscu"]})]}),e.jsx(L,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]}),e.jsx("div",{className:"grid grid-cols-4 gap-1.5",children:C.map(n=>e.jsxs("button",{type:"button",onClick:n.action,className:"flex flex-col items-center gap-1.5 rounded-2xl border bg-card px-1.5 py-3 text-center transition-colors active:bg-muted",children:[e.jsx(n.icon,{className:`h-4.5 w-4.5 ${n.color}`}),e.jsx("span",{className:"text-[9px] font-semibold leading-tight text-muted-foreground",children:n.label})]},n.label))}),e.jsxs("button",{type:"button",onClick:()=>t("swimmers"),className:"flex w-full items-center gap-3 rounded-2xl bg-muted/40 px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-9 w-9 shrink-0 items-center justify-center rounded-xl bg-blue-100 dark:bg-blue-900/30",children:e.jsx(W,{className:"h-4.5 w-4.5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Voir tous les nageurs"}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:v?"Chargement…":`${l.length} nageur${l.length>1?"s":""}`})]}),e.jsx(L,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]})]})]})]})},X=t=>t.toISOString().split("T")[0],Oe=t=>new Date(t.completed_at||t.started_at||t.date||t.created_at||0).getTime(),ze=t=>{if(!t.length)return null;const g=t.reduce((s,l)=>s+l,0)/t.length,b=Math.min(5,Math.max(1,Math.round(g/10*5)));return{average:g,rating:b}};function Pe(){const t=$(r=>r.role),g=$(r=>r.setSelectedAthlete),[,b]=ie(),[s,l]=a.useState(()=>window.location.hash.match(/[?&]section=([^&]+)/)?.[1]||"home"),v=7,[N,c]=a.useState(null);a.useEffect(()=>{const r="/coach",o=s&&s!=="home"?`#${r}?section=${s}`:`#${r}`;window.location.hash!==o&&window.history.replaceState(null,"",o)},[s]),a.useEffect(()=>{const r=()=>{l("home"),c(null)};return window.addEventListener("nav:reset",r),()=>window.removeEventListener("nav:reset",r)},[]),a.useEffect(()=>{const r=o=>{const S=o.detail;l(S),c(null)};return window.addEventListener("nav:section",r),()=>window.removeEventListener("nav:section",r)},[]);const p=t==="coach"||t==="admin",E=s==="home"||s==="calendar",T=s==="home"||s==="messaging"||s==="sms"||s==="swimmers"||s==="athlete"||s==="calendar"||s==="groups"||s==="objectives",O=s==="messaging"||s==="sms"||s==="calendar"||s==="groups"||s==="training-slots",{data:w}=A({queryKey:["swim_catalog"],queryFn:()=>k.getSwimCatalog(),enabled:p&&E}),{data:_}=A({queryKey:["strength_catalog"],queryFn:()=>k.getStrengthSessions(),enabled:p&&E}),{data:d=[],isLoading:f}=A({queryKey:["athletes"],queryFn:()=>k.getAthletes(),enabled:p&&T}),m=a.useMemo(()=>d.slice(0,5),[d]),{data:j=[]}=A({queryKey:["groups"],queryFn:()=>k.getGroups(),enabled:p&&O}),C=A({queryKey:["coach-kpis",v,m.map(r=>r.id??r.display_name)],enabled:p&&s==="home"&&m.length>0,queryFn:async()=>{const r=v,o=new Date;o.setDate(o.getDate()-r);const S=X(o),Z=X(new Date),I=await Promise.all(m.map(async u=>{const[z,ee]=await Promise.all([k.getSessions(u.display_name,u.id),k.getStrengthHistory(u.display_name,{athleteId:u.id,limit:50,from:S,to:Z})]),F=z.filter(i=>new Date(i.date).getTime()>=o.getTime()),se=F.map(i=>i.fatigue??i.feeling).filter(i=>Number.isFinite(i)),te=F.reduce((i,y)=>i+(Number(y.duration)||0)*(Number(y.effort)||0),0),M=(ee?.runs??[]).filter(i=>Oe(i)>=o.getTime()),ae=M.map(i=>i.fatigue??i.feeling??i.rpe).filter(i=>Number.isFinite(Number(i))).map(i=>Number(i)),ne=M.reduce((i,y)=>{const q=Number(y.feeling??y.rpe??0),V=Number(y.duration??0);if(V>0&&q>0)return i+V*q;const le=Array.isArray(y.logs)?y.logs.length:0;return i+le*5},0),re=ze([...se,...ae]);return{athleteName:u.display_name,loadScore:te+ne,fatigueRating:re}})),J=I.filter(u=>u.fatigueRating?.rating===5).map(u=>({athleteName:u.athleteName,rating:u.fatigueRating?.rating??0})),Y=I.filter(u=>u.loadScore>0).sort((u,z)=>z.loadScore-u.loadScore)[0];return{fatigueAlerts:J,mostLoadedAthlete:Y??null}}}),n=r=>{if(g({id:r.id??null,name:r.display_name}),r.id==null){b("/progress");return}c(r),l("athlete")};return p?e.jsxs("div",{className:"space-y-6",children:[s==="home"?e.jsx(Te,{onNavigate:l,onOpenRecordsAdmin:()=>b("/records-admin"),onOpenRecordsClub:()=>b("/records-club"),onOpenAthlete:n,athletes:d,athletesLoading:f,kpiLoading:C.isLoading,fatigueAlerts:C.data?.fatigueAlerts??[],mostLoadedAthlete:C.data?.mostLoadedAthlete??null,swimSessionCount:w?.length,strengthSessionCount:_?.length}):null,s==="swim"?e.jsxs("div",{className:"space-y-6",children:[e.jsx(G,{title:"Bibliothèque natation",description:"Accédez aux séances et aux templates natation.",onBack:()=>l("home"),actions:e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>l("calendar"),children:[e.jsx(B,{className:"mr-1.5 h-3.5 w-3.5"}),"Assigner"]})}),e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Re,{})})]}):null,s==="strength"?e.jsxs("div",{className:"space-y-6",children:[e.jsx(G,{title:"Bibliothèque musculation",description:"Consultez et créez des séances musculation.",onBack:()=>l("home"),actions:e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>l("calendar"),children:[e.jsx(B,{className:"mr-1.5 h-3.5 w-3.5"}),"Assigner"]})}),e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(De,{})})]}):null,s==="swimmers"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(we,{athletes:d,athletesLoading:f,onBack:()=>l("home"),onOpenAthlete:n})}):null,s==="athlete"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Ee,{athleteId:N?.id??null,athleteName:N?.display_name??null,onBack:()=>l("home")})}):null,s==="messaging"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(ke,{onBack:()=>l("home"),athletes:d,groups:j,athletesLoading:f})}):null,s==="sms"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(ve,{onBack:()=>l("home"),athletes:d,groups:j,athletesLoading:f})}):null,s==="calendar"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(_e,{onBack:()=>l("home"),athletes:d,groups:j,swimSessions:w,strengthSessions:_})}):null,s==="groups"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Ce,{onBack:()=>l("home"),athletes:d,groups:j,athletesLoading:f})}):null,s==="competitions"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Se,{onBack:()=>l("home")})}):null,s==="objectives"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Ae,{onBack:()=>l("home"),athletes:d,athletesLoading:f})}):null,s==="training-slots"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Le,{onBack:()=>l("home"),groups:j})}):null]}):e.jsx("div",{className:"flex items-center justify-center min-h-[60vh] animate-in fade-in motion-reduce:animate-none",children:e.jsxs(ce,{className:"w-full max-w-sm shadow-xl border-t-4 border-t-primary",children:[e.jsxs(oe,{children:[e.jsxs(de,{className:"flex items-center gap-2 uppercase italic",children:[e.jsx(W,{className:"h-5 w-5 text-primary"}),"Accès Coach"]}),e.jsx(me,{children:"Cette section est réservée aux coachs et administrateurs."})]}),e.jsx(ue,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Connectez-vous avec un compte autorisé pour accéder aux outils de gestion."})})]})})}const Xe=Object.freeze(Object.defineProperty({__proto__:null,default:Pe},Symbol.toStringTag,{value:"Module"}));export{G as C,ye as U,Xe as a};
