const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CoachSwimmersOverview-BZqYR1VP.js","assets/vendor-query-DyA9aSKS.js","assets/vendor-react-BzrpNAyj.js","assets/api-D2Tllh8s.js","assets/index-BOaNBvLi.js","assets/vendor-charts-BrQ8X25f.js","assets/vendor-supabase-DFPLkPj_.js","assets/vendor-motion-lao-Njgm.js","assets/index-D9BZ-CIh.css","assets/swim-C2h4iBds.js","assets/badge-BqVBcLrN.js","assets/arrow-left-D7EmMq6P.js","assets/search-BuDx8ije.js","assets/trophy-qMQgMj36.js","assets/bell-ring-CeDwwM6E.js","assets/chevron-right-jL56ZFJl.js","assets/zap-T3BeBZjp.js","assets/clock-C7j0j3Vq.js","assets/CoachMessagesScreen-BMiASaWj.js","assets/textarea-DC4sYf6Y.js","assets/select-Dr0N4gfo.js","assets/index-DZNP_ke5.js","assets/index-7hjYYUsE.js","assets/index-DCX2sNhR.js","assets/chevron-down-vjdOd1og.js","assets/chevron-up-Ci_LaZAm.js","assets/CoachSmsScreen-DthNTGgX.js","assets/command-Clv5GaEF.js","assets/index-BlA81OqL.js","assets/dialog-BUOzsYbx.js","assets/smsUtils-C1cP6in3.js","assets/external-link-BDdpSy1o.js","assets/copy-4VZGVijV.js","assets/CoachCalendar-7G7kz1Hb.js","assets/CalendarGrid-BBHk8mG2.js","assets/chevron-left-XoLlxIEY.js","assets/toggle-group-BQzHcNxL.js","assets/index-C7kKDxFB.js","assets/sheet-BjGxi9D5.js","assets/InlineBanner-C6d7oFL9.js","assets/circle-alert-DiuU5oz7.js","assets/trash-2-BLBNri9G.js","assets/CoachGroupsScreen-DJnI27Gy.js","assets/checkbox-DP8-bY2y.js","assets/separator-D9YMXn0z.js","assets/alert-dialog-TZ9Elvkk.js","assets/collapsible-Dwo7Gxls.js","assets/user-plus-BElsGoL1.js","assets/power-BfuRHYNk.js","assets/CoachCompetitionsScreen-Bah05duM.js","assets/CoachObjectivesScreen-DfdOjzGu.js","assets/objectiveHelpers-DC7i01Ud.js","assets/ObjectiveCard-CD8sCGto.js","assets/CoachTrainingSlotsScreen-B-BEe9xZ.js","assets/map-pin-CTuIF1Bq.js","assets/loader-circle-UaLInN3_.js","assets/pencil-2idgWwn9.js","assets/eye-off-Czm1q5LK.js","assets/eye-OdEBM77b.js","assets/swimSessionUtils-DN7EW4yB.js","assets/radio-group-CHY-CKen.js","assets/circle-d6i1jhWF.js","assets/CoachSwimmerDetail-D5xpAjv2.js","assets/tabs-BtvVEhRs.js","assets/weekTypeColor-4gjD3vCJ.js","assets/chart-column-CFfwQLww.js","assets/date-DrpgLmFD.js","assets/vendor-date-B8Mnp-Vt.js","assets/StrengthCatalog-BIwqN8E5.js","assets/SessionListView-JAzGCH_X.js","assets/play-CmxC3Keq.js","assets/save-D-z_ZAaN.js","assets/share-2-BEf24L0T.js","assets/drawer-BCdiGZTn.js","assets/pen-Bddg0oHk.js","assets/SwimCatalog-zKoKmeJ4.js","assets/SwimSessionTimeline-DkUIvjcm.js","assets/SwimTimeInput-DpFKsr1f.js","assets/timer-DlhnoFd6.js","assets/sparkles-Cr_Skj4s.js","assets/repeat-Dqiow67D.js"])))=>i.map(i=>d[i]);
import{b as se,B as H,u as X,a as xe,C as he,g as pe,i as ge,U as te,j as be,e as fe,k as x,l as $,I as je,W as Q,D as ye,_ as b}from"./index-BOaNBvLi.js";import{j as e,r as n,u as D}from"./vendor-query-DyA9aSKS.js";import{a as C}from"./api-D2Tllh8s.js";import{A as Ne}from"./arrow-left-D7EmMq6P.js";import{S as we}from"./search-BuDx8ije.js";import{T as q}from"./trophy-qMQgMj36.js";import{B as W}from"./bell-ring-CeDwwM6E.js";import{C as R}from"./chevron-right-jL56ZFJl.js";import{Z as ve}from"./zap-T3BeBZjp.js";import{C as ke}from"./clock-C7j0j3Vq.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}],["path",{d:"M3.22 13H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"auskq0"}]],Z=se("heart-pulse",_e);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]],Ce=se("users-round",Se),J=({title:a,description:h,onBack:p,actions:t})=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(H,{variant:"ghost",size:"sm",className:"-ml-2",onClick:p,children:[e.jsx(Ne,{className:"mr-2 h-4 w-4"}),"Retour"]}),e.jsx("h2",{className:"text-2xl font-display font-semibold uppercase italic text-primary",children:a}),h?e.jsx("p",{className:"text-sm text-muted-foreground",children:h}):null]}),t?e.jsx("div",{className:"flex items-center gap-2",children:t}):null]}),Ae=n.lazy(()=>b(()=>import("./CoachSwimmersOverview-BZqYR1VP.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]))),Le=n.lazy(()=>b(()=>import("./CoachMessagesScreen-BMiASaWj.js"),__vite__mapDeps([18,1,2,3,4,5,6,7,8,9,19,20,21,22,23,24,25,14,11,12,13,15,16,17]))),Ee=n.lazy(()=>b(()=>import("./CoachSmsScreen-DthNTGgX.js"),__vite__mapDeps([26,1,2,4,5,6,7,8,10,19,27,22,28,29,12,30,31,32,3,9,11,13,14,15,16,17]))),De=n.lazy(()=>b(()=>import("./CoachCalendar-7G7kz1Hb.js"),__vite__mapDeps([33,1,2,34,35,4,5,6,7,8,15,13,3,9,20,21,22,23,24,25,36,37,38,28,39,40,41,11,12,14,16,17]))),Re=n.lazy(()=>b(()=>import("./CoachGroupsScreen-DJnI27Gy.js"),__vite__mapDeps([42,1,2,3,4,5,6,7,8,9,10,43,23,22,44,38,28,45,46,11,47,24,48,41,12,13,14,15,16,17]))),Te=n.lazy(()=>b(()=>import("./CoachCompetitionsScreen-Bah05duM.js"),__vite__mapDeps([49,1,2,3,4,5,6,7,8,9,19,38,28,22,45,43,23,20,21,24,25,11,12,13,14,15,16,17]))),Oe=n.lazy(()=>b(()=>import("./CoachObjectivesScreen-DfdOjzGu.js"),__vite__mapDeps([50,1,2,3,4,5,6,7,8,9,19,10,20,21,22,23,24,25,36,37,38,28,45,51,52,11,12,13,14,15,16,17]))),Y=n.lazy(()=>b(()=>import("./CoachTrainingSlotsScreen-B-BEe9xZ.js"),__vite__mapDeps([53,1,2,3,4,5,6,7,8,9,38,28,22,10,43,23,44,45,17,54,55,56,32,57,58,41,59,12,20,21,24,25,60,37,61,35,15,11,13,14,16]))),Fe=n.lazy(()=>b(()=>import("./CoachSwimmerDetail-D5xpAjv2.js"),__vite__mapDeps([62,1,2,4,5,6,7,8,3,9,63,37,21,10,46,64,65,24,19,20,22,23,25,36,38,28,45,51,52,66,67,32,41,56,30,17,15,13,54,11]))),ze=n.lazy(()=>b(()=>import("./StrengthCatalog-BIwqN8E5.js"),__vite__mapDeps([68,1,2,3,4,5,6,7,8,9,60,37,21,23,61,19,29,28,22,43,45,63,20,24,25,69,35,70,71,15,40,56,72,41,73,27,12,55,74]))),Ie=n.lazy(()=>b(()=>import("./SwimCatalog-zKoKmeJ4.js"),__vite__mapDeps([75,1,2,3,4,5,6,7,8,9,29,28,22,45,15,76,77,51,25,78,59,58,24,17,69,35,70,71,21,37,61,40,56,72,41,19,20,23,32,79,80,66,67,12])));function V({children:a}){return e.jsxs("div",{className:"flex items-center gap-3 pb-0.5",children:[e.jsx("span",{className:"text-[9px] font-black uppercase tracking-[0.28em] text-muted-foreground/70",children:a}),e.jsx("div",{className:"flex-1 h-px bg-border/50"})]})}function Me({score:a}){if(a==null)return null;const h=Math.round(a),p=a>=3.5?"bg-emerald-500":a>=2.5?"bg-amber-500":"bg-red-500";return e.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:5}).map((t,r)=>e.jsx("div",{className:`h-1.5 w-1.5 rounded-full ${r<h?p:"bg-muted"}`},r))})}const Pe=({onNavigate:a,onOpenRecordsAdmin:h,onOpenRecordsClub:p,onOpenAthlete:t,athletes:r,athletesLoading:A,kpiLoading:j,fatigueAlerts:d,mostLoadedAthlete:f,formeScores:T,swimSessionCount:I,strengthSessionCount:M})=>{const O=new Date().toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"}),[w,m]=n.useState(""),g=n.useDeferredValue(w.trim().toLocaleLowerCase("fr-FR")),v=n.useMemo(()=>g?r.filter(s=>{const o=s.display_name.toLocaleLowerCase("fr-FR"),N=s.group_label?.toLocaleLowerCase("fr-FR")??"";return o.includes(g)||N.includes(g)}).slice(0,6):r.slice(0,5),[r,g]),c=d.length>0,y={label:"Créer une séance",detail:"Natation · Explorer la bibliothèque",action:()=>a("swim")},F=[{label:"Natation",icon:Q,action:()=>a("swim"),color:"text-cyan-500"},{label:"Muscu",icon:ye,action:()=>a("strength"),color:"text-violet-500"},{label:"Groupes",icon:Ce,action:()=>a("groups"),color:"text-emerald-500"},{label:"Échéances",icon:$,action:()=>a("competitions"),color:"text-orange-500"},{label:"Créneaux",icon:ke,action:()=>a("training-slots"),color:"text-blue-500"},{label:"SMS",icon:W,action:()=>a("sms"),color:"text-rose-500"},{label:"Records",icon:q,action:p,color:"text-orange-500"},{label:"Admin rec.",icon:q,action:h,color:"text-slate-500"}];return e.jsxs("div",{className:"space-y-5 pb-24",children:[e.jsx("style",{children:`
        @keyframes cta-breathe {
          0%, 100% { opacity: 0.55; transform: scale(1); }
          50%       { opacity: 0.85; transform: scale(1.06); }
        }
        @keyframes cta-breathe-alert {
          0%, 100% { opacity: 0.45; }
          50%       { opacity: 0.85; }
        }
        @keyframes shimmer-slide {
          0%   { transform: translateX(-100%) skewX(-12deg); }
          100% { transform: translateX(300%) skewX(-12deg); }
        }
        .cta-glow     { animation: cta-breathe 3.5s ease-in-out infinite; }
        .cta-glow-alert { animation: cta-breathe-alert 1.4s ease-in-out infinite; }
        .cta-shimmer  { animation: shimmer-slide 2.8s ease-in-out infinite 0.8s; }
      `}),e.jsxs("div",{className:"sticky top-0 z-20 -mx-4 border-b bg-background/95 px-4 py-3 backdrop-blur",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>a("home"),className:"shrink-0 rounded-full border px-3 py-2 text-sm font-semibold active:bg-muted",children:"Aujourd'hui"}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx(we,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(je,{value:w,onChange:s=>m(s.target.value),placeholder:"Rechercher un nageur",className:"h-10 rounded-full pl-9"})]}),e.jsx(H,{size:"sm",className:"shrink-0 rounded-full",onClick:()=>a("messaging"),children:"Message"})]}),e.jsx("p",{className:"mt-2 text-[11px] uppercase tracking-[0.18em] text-muted-foreground capitalize",children:O})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsx(V,{children:"Le Quotidien"}),e.jsxs("button",{type:"button",onClick:y.action,className:["relative w-full overflow-hidden rounded-3xl text-white transition-all duration-200 active:scale-[0.97]",c?"bg-gradient-to-br from-rose-500 via-red-500 to-orange-500":"bg-gradient-to-br from-primary via-primary/80 to-primary/60"].join(" "),children:[e.jsx("div",{className:c?"cta-glow-alert absolute inset-0":"cta-glow absolute inset-0",style:{background:c?"radial-gradient(ellipse at 20% 60%, rgba(255,80,60,0.6) 0%, transparent 65%)":"radial-gradient(ellipse at 20% 60%, rgba(255,255,255,0.2) 0%, transparent 65%)"}}),e.jsx("div",{className:"cta-shimmer absolute top-0 bottom-0 left-0 w-1/3 pointer-events-none",style:{background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.12), transparent)"}}),e.jsxs("div",{className:"relative flex items-center gap-4 px-6 py-7",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[c&&e.jsxs("div",{className:"mb-2.5 inline-flex items-center gap-1.5 rounded-full bg-white/20 px-2.5 py-1",children:[e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-white opacity-75"}),e.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-white"})]}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-[0.22em]",children:"Attention requise"})]}),e.jsx("p",{className:"text-[1.6rem] font-bold leading-tight tracking-tight",children:y.label}),e.jsx("p",{className:"mt-1.5 text-sm opacity-75",children:y.detail})]}),e.jsx("div",{className:"flex h-14 w-14 shrink-0 items-center justify-center rounded-2xl bg-white/15 backdrop-blur-sm border border-white/20",children:c?e.jsx(Z,{className:"h-7 w-7 animate-pulse"}):e.jsx(Q,{className:"h-7 w-7"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>a("objectives"),className:"flex items-center gap-2.5 rounded-2xl border bg-card px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-xl bg-amber-100 dark:bg-amber-900/30",children:e.jsx(q,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Objectifs"}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Temps cibles"})]})]}),e.jsxs("button",{type:"button",onClick:()=>a("messaging"),className:"flex items-center gap-2.5 rounded-2xl border bg-card px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-xl bg-blue-100 dark:bg-blue-900/30",children:e.jsx(W,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Message"}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Notifier un groupe"})]})]})]})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsx(V,{children:"Tour de Contrôle"}),e.jsxs("div",{className:["rounded-3xl border p-4 space-y-3 transition-colors",c?"border-red-200 bg-red-50/70 dark:border-red-900/50 dark:bg-red-950/25":"bg-card border-border"].join(" "),children:[c&&!j&&e.jsx("div",{className:"space-y-1.5",children:d.map(s=>e.jsxs("button",{type:"button",onClick:()=>a("swimmers"),className:"flex w-full items-center gap-3 rounded-2xl bg-white/70 dark:bg-black/20 px-3.5 py-2.5 text-left transition-colors active:bg-white/90",children:[e.jsxs("span",{className:"relative flex h-3 w-3 shrink-0",children:[e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-red-400 opacity-60"}),e.jsx("span",{className:"relative inline-flex h-3 w-3 rounded-full bg-red-500"})]}),e.jsx("span",{className:"flex-1 text-sm font-semibold text-red-900 dark:text-red-200",children:s.athleteName}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-red-600 dark:text-red-400",children:"Fatigue max"}),e.jsx(R,{className:"h-3.5 w-3.5 text-red-400"})]},s.athleteName))}),e.jsxs("div",{className:"grid grid-cols-2 gap-2.5",children:[e.jsxs("div",{className:["rounded-2xl p-3.5",c?"bg-white/50 dark:bg-black/20":"bg-muted/40"].join(" "),children:[e.jsxs("div",{className:"mb-2 flex items-center gap-1.5",children:[e.jsx(Z,{className:`h-3.5 w-3.5 ${d.length>0?"text-red-500":"text-muted-foreground"}`}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-[0.18em] text-muted-foreground",children:"Alertes"})]}),e.jsx("p",{className:`text-4xl font-black tabular-nums leading-none ${d.length>0?"text-red-600 dark:text-red-400":"text-foreground"}`,children:j?"–":d.length}),e.jsx("p",{className:"mt-1.5 text-[11px] text-muted-foreground truncate",children:j?"Calcul…":d.length>0?d.slice(0,2).map(s=>s.athleteName.split(" ")[0]).join(", "):"Aucune alerte"})]}),e.jsxs("div",{className:["rounded-2xl p-3.5",c?"bg-white/50 dark:bg-black/20":"bg-muted/40"].join(" "),children:[e.jsxs("div",{className:"mb-2 flex items-center gap-1.5",children:[e.jsx(ve,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-[0.18em] text-muted-foreground",children:"Plus chargé"})]}),e.jsx("p",{className:"text-2xl font-black truncate leading-none",children:j?"–":f?.athleteName?.split(" ")[0]??"–"}),e.jsx("p",{className:"mt-1.5 text-[11px] text-muted-foreground",children:j?"Calcul…":f?`Charge ${Math.round(f.loadScore)}`:"Pas de données"})]})]})]})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-0.5",children:[e.jsx("span",{className:"text-[9px] font-black uppercase tracking-[0.28em] text-muted-foreground/70",children:"Nageurs"}),e.jsx("div",{className:"flex-1 h-px bg-border/50"}),w?e.jsx("button",{type:"button",onClick:()=>m(""),className:"text-[10px] font-bold text-primary",children:"Effacer"}):e.jsxs("button",{type:"button",onClick:()=>a("swimmers"),className:"flex items-center gap-0.5 text-[10px] font-bold text-primary",children:["Tous ",e.jsx(R,{className:"h-3 w-3"})]})]}),e.jsx("div",{className:"overflow-hidden rounded-3xl border bg-card shadow-sm",children:A?e.jsx("div",{className:"divide-y divide-border/60",children:[1,2,3,4].map(s=>e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3.5",children:[e.jsx("div",{className:"h-9 w-9 animate-pulse rounded-full bg-muted"}),e.jsxs("div",{className:"flex-1 space-y-1.5",children:[e.jsx("div",{className:"h-3.5 w-28 animate-pulse rounded bg-muted"}),e.jsx("div",{className:"h-3 w-18 animate-pulse rounded bg-muted"})]})]},s))}):v.length===0?e.jsx("p",{className:"px-4 py-8 text-center text-sm text-muted-foreground",children:"Aucun nageur trouvé."}):e.jsx("div",{className:"divide-y divide-border/60",children:v.map(s=>{const o=d.some(L=>L.athleteName===s.display_name),N=s.display_name.charAt(0).toUpperCase(),z=s.id!=null?T.get(s.id)??null:null;return e.jsxs("button",{type:"button",onClick:()=>t(s),className:"flex w-full items-center gap-3 px-4 py-3.5 text-left transition-colors active:bg-muted",children:[s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:"",className:["h-9 w-9 shrink-0 rounded-full object-cover border",o?"border-red-400/60 ring-2 ring-red-400/60 ring-offset-1":"border-border"].join(" ")}):e.jsx("div",{className:["flex h-9 w-9 shrink-0 items-center justify-center rounded-full text-sm font-bold transition-all",o?"bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-400 ring-2 ring-red-400/60 ring-offset-1":"bg-primary/10 text-primary"].join(" "),children:N}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"truncate text-sm font-semibold",children:s.display_name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"truncate text-[11px] text-muted-foreground",children:s.group_label||"Sans groupe"}),z!=null&&e.jsx(Me,{score:z})]})]}),o?e.jsxs("span",{className:"inline-flex shrink-0 items-center gap-1 rounded-full bg-red-100 px-2.5 py-1 text-[9px] font-black uppercase tracking-widest text-red-600 dark:bg-red-900/30 dark:text-red-400",children:[e.jsx("span",{className:"h-1.5 w-1.5 animate-pulse rounded-full bg-current"}),"Alerte"]}):e.jsx(R,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]},s.id??s.display_name)})})})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsx(V,{children:"Arsenal"}),e.jsxs("div",{className:"space-y-2 rounded-3xl border bg-card p-3 shadow-sm",children:[e.jsxs("button",{type:"button",onClick:()=>a("calendar"),className:"flex w-full items-center gap-3 rounded-2xl bg-muted/40 px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-9 w-9 shrink-0 items-center justify-center rounded-xl bg-violet-100 dark:bg-violet-900/30",children:e.jsx($,{className:"h-4.5 w-4.5 text-violet-600 dark:text-violet-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Calendrier · Assigner"}),e.jsxs("p",{className:"text-[11px] text-muted-foreground",children:[I??0," séances nat · ",M??0," muscu"]})]}),e.jsx(R,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]}),e.jsx("div",{className:"grid grid-cols-4 gap-1.5",children:F.map(s=>e.jsxs("button",{type:"button",onClick:s.action,className:"flex flex-col items-center gap-1.5 rounded-2xl border bg-card px-1.5 py-3 text-center transition-colors active:bg-muted",children:[e.jsx(s.icon,{className:`h-4.5 w-4.5 ${s.color}`}),e.jsx("span",{className:"text-[9px] font-semibold leading-tight text-muted-foreground",children:s.label})]},s.label))}),e.jsxs("button",{type:"button",onClick:()=>a("swimmers"),className:"flex w-full items-center gap-3 rounded-2xl bg-muted/40 px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-9 w-9 shrink-0 items-center justify-center rounded-xl bg-blue-100 dark:bg-blue-900/30",children:e.jsx(te,{className:"h-4.5 w-4.5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Voir tous les nageurs"}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:A?"Chargement…":`${r.length} nageur${r.length>1?"s":""}`})]}),e.jsx(R,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]})]})]})]})},ee=a=>a.toISOString().split("T")[0],Be=a=>new Date(a.completed_at||a.started_at||a.date||a.created_at||0).getTime(),qe=a=>{if(!a.length)return null;const h=a.reduce((t,r)=>t+r,0)/a.length,p=Math.min(5,Math.max(1,Math.round(h)));return{average:h,rating:p}};function Ve(){const a=X(s=>s.role),h=X(s=>s.setSelectedAthlete),[,p]=xe(),[t,r]=n.useState(()=>window.location.hash.match(/[?&]section=([^&]+)/)?.[1]||"home"),A=7,[j,d]=n.useState(null);n.useEffect(()=>{const s="/coach",o=t&&t!=="home"?`#${s}?section=${t}`:`#${s}`;window.location.hash!==o&&window.history.replaceState(null,"",o)},[t]),n.useEffect(()=>{const s=()=>{r("home"),d(null)};return window.addEventListener("nav:reset",s),()=>window.removeEventListener("nav:reset",s)},[]),n.useEffect(()=>{const s=o=>{const N=o.detail;r(N),d(null)};return window.addEventListener("nav:section",s),()=>window.removeEventListener("nav:section",s)},[]);const f=a==="coach"||a==="admin",T=t==="home"||t==="calendar",I=t==="home"||t==="messaging"||t==="sms"||t==="swimmers"||t==="athlete"||t==="calendar"||t==="groups"||t==="objectives",M=t==="messaging"||t==="sms"||t==="calendar"||t==="groups"||t==="training-slots",{data:O}=D({queryKey:["swim_catalog"],queryFn:()=>C.getSwimCatalog(),enabled:f&&T}),{data:w}=D({queryKey:["strength_catalog"],queryFn:()=>C.getStrengthSessions(),enabled:f&&T}),{data:m=[],isLoading:g}=D({queryKey:["athletes"],queryFn:()=>C.getAthletes(),enabled:f&&I}),v=n.useMemo(()=>m.slice(0,5),[m]),{data:c=[]}=D({queryKey:["groups"],queryFn:()=>C.getGroups(),enabled:f&&M}),y=D({queryKey:["coach-kpis",A,v.map(s=>s.id??s.display_name)],enabled:f&&t==="home"&&v.length>0,queryFn:async()=>{const s=A,o=new Date;o.setDate(o.getDate()-s);const N=ee(o),z=ee(new Date),L=await Promise.all(v.map(async i=>{const[P,re]=await Promise.all([C.getSessions(i.display_name,i.id),C.getStrengthHistory(i.display_name,{athleteId:i.id,limit:50,from:N,to:z})]),B=P.filter(l=>new Date(l.date).getTime()>=o.getTime()),le=B.map(l=>l.fatigue??l.feeling).filter(l=>Number.isFinite(l)),ie=B.reduce((l,u)=>l+(Number(u.duration)||0)*(Number(u.effort)||0),0),U=(re?.runs??[]).filter(l=>Be(l)>=o.getTime()),oe=U.map(l=>l.fatigue??l.feeling??l.rpe).filter(l=>Number.isFinite(Number(l))).map(l=>Number(l)),ce=U.reduce((l,u)=>{const _=Number(u.feeling??u.rpe??0),S=Number(u.duration??0);if(S>0&&_>0)return l+S*_;const E=Array.isArray(u.logs)?u.logs.length:0;return l+E*5},0),de=qe([...le,...oe]),k=B[0];let G=null;if(k){const l=[],u=k.effort,_=k.fatigue??k.feeling,S=k.performance,E=k.engagement;u!=null&&Number.isFinite(u)&&l.push(6-u),_!=null&&Number.isFinite(_)&&l.push(6-_),S!=null&&Number.isFinite(S)&&l.push(S),E!=null&&Number.isFinite(E)&&l.push(E),l.length>0&&(G=Math.round(l.reduce((me,ue)=>me+ue,0)/l.length*10)/10)}return{athleteId:i.id,athleteName:i.display_name,loadScore:ie+ce,fatigueRating:de,formeScore:G}})),ae=L.filter(i=>i.fatigueRating?.rating===5).map(i=>({athleteName:i.athleteName,rating:i.fatigueRating?.rating??0})),ne=L.filter(i=>i.loadScore>0).sort((i,P)=>P.loadScore-i.loadScore)[0],K=new Map;for(const i of L)i.athleteId!=null&&K.set(i.athleteId,i.formeScore);return{fatigueAlerts:ae,mostLoadedAthlete:ne??null,formeScores:K}}}),F=s=>{if(h({id:s.id??null,name:s.display_name}),s.id==null){p("/progress");return}d(s),r("athlete")};return f?e.jsxs("div",{className:"space-y-6",children:[t==="home"?e.jsx(Pe,{onNavigate:r,onOpenRecordsAdmin:()=>p("/records-admin"),onOpenRecordsClub:()=>p("/records-club"),onOpenAthlete:F,athletes:m,athletesLoading:g,kpiLoading:y.isLoading,fatigueAlerts:y.data?.fatigueAlerts??[],mostLoadedAthlete:y.data?.mostLoadedAthlete??null,formeScores:y.data?.formeScores??new Map,swimSessionCount:O?.length,strengthSessionCount:w?.length}):null,t==="swim"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Y,{onBack:()=>r("home"),onOpenLibrary:()=>r("swim-library"),groups:c})}):null,t==="swim-library"?e.jsxs("div",{className:"space-y-6",children:[e.jsx(J,{title:"Bibliothèque natation",description:"Templates de séances.",onBack:()=>r("swim")}),e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Ie,{})})]}):null,t==="strength"?e.jsxs("div",{className:"space-y-6",children:[e.jsx(J,{title:"Bibliothèque musculation",description:"Consultez et créez des séances musculation.",onBack:()=>r("home"),actions:e.jsxs(H,{variant:"outline",size:"sm",onClick:()=>r("calendar"),children:[e.jsx($,{className:"mr-1.5 h-3.5 w-3.5"}),"Assigner"]})}),e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(ze,{})})]}):null,t==="swimmers"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Ae,{athletes:m,athletesLoading:g,onBack:()=>r("home"),onOpenAthlete:F})}):null,t==="athlete"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Fe,{athleteId:j?.id??null,athleteName:j?.display_name??null,onBack:()=>r("home")})}):null,t==="messaging"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Le,{onBack:()=>r("home"),athletes:m,groups:c,athletesLoading:g})}):null,t==="sms"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Ee,{onBack:()=>r("home"),athletes:m,groups:c,athletesLoading:g})}):null,t==="calendar"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(De,{onBack:()=>r("home"),athletes:m,groups:c,swimSessions:O,strengthSessions:w})}):null,t==="groups"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Re,{onBack:()=>r("home"),athletes:m,groups:c,athletesLoading:g})}):null,t==="competitions"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Te,{onBack:()=>r("home")})}):null,t==="objectives"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Oe,{onBack:()=>r("home"),athletes:m,athletesLoading:g})}):null,t==="training-slots"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Y,{onBack:()=>r("home"),groups:c,onOpenLibrary:()=>r("swim-library")})}):null]}):e.jsx("div",{className:"flex items-center justify-center min-h-[60vh] animate-in fade-in motion-reduce:animate-none",children:e.jsxs(he,{className:"w-full max-w-sm shadow-xl border-t-4 border-t-primary",children:[e.jsxs(pe,{children:[e.jsxs(ge,{className:"flex items-center gap-2 uppercase italic",children:[e.jsx(te,{className:"h-5 w-5 text-primary"}),"Accès Coach"]}),e.jsx(be,{children:"Cette section est réservée aux coachs et administrateurs."})]}),e.jsx(fe,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Connectez-vous avec un compte autorisé pour accéder aux outils de gestion."})})]})})}const es=Object.freeze(Object.defineProperty({__proto__:null,default:Ve},Symbol.toStringTag,{value:"Module"}));export{J as C,Ce as U,es as a};
