const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CoachSwimmersOverview-AQuP0tu9.js","assets/vendor-query-DyA9aSKS.js","assets/vendor-react-BzrpNAyj.js","assets/api-HuFCEWN3.js","assets/index-D4AlBQ_D.js","assets/vendor-charts-BrQ8X25f.js","assets/vendor-supabase-DFPLkPj_.js","assets/vendor-motion-lao-Njgm.js","assets/index-mBRVKyDM.css","assets/swim-CJN9oOr2.js","assets/badge-EbRnC5t8.js","assets/arrow-left-COS5F3eP.js","assets/select-Ck-N7aiY.js","assets/index-BoUBHMA8.js","assets/index-BA3lOMc8.js","assets/chevron-down-BY3AOPsY.js","assets/chevron-up-BerY6pHn.js","assets/zap-B8toFBnC.js","assets/message-square-BtcCsRT6.js","assets/trophy-QJMdaqxA.js","assets/clock-gcAepbwR.js","assets/search-CJLVAK1L.js","assets/bell-ring-Ba7md07v.js","assets/chevron-right-aucX45E0.js","assets/CoachMessagesScreen-DOg5cXLC.js","assets/textarea-CHQvT8KR.js","assets/CoachSmsScreen-BIIcNkhf.js","assets/command-Dmmv8jd7.js","assets/index-DpW2ahdf.js","assets/dialog-CnwE2rce.js","assets/smsUtils-CwQBrF0I.js","assets/copy-DQ32pPGn.js","assets/CoachCalendar-BYDe_--w.js","assets/CalendarGrid-CHC1RZ1X.js","assets/chevron-left-leHgO-wM.js","assets/toggle-group-CtubA6AX.js","assets/index-DWt_P6Gq.js","assets/sheet-Bm_Aex7h.js","assets/InlineBanner-BqP-PEnz.js","assets/circle-alert-Dcj8q80m.js","assets/trash-2-KyQho8Dc.js","assets/CoachGroupsScreen-DMeKKxF9.js","assets/checkbox-CQNefv96.js","assets/separator-Bry0ttJj.js","assets/alert-dialog-DQMipZ-2.js","assets/collapsible-D4aSH8MW.js","assets/user-plus-DK8Xf2G6.js","assets/power-Bt-ueKuB.js","assets/CoachCompetitionsScreen-CfAukt1P.js","assets/CoachObjectivesScreen-DB0YqXJz.js","assets/objectiveHelpers-D7Sv8PWO.js","assets/CoachTrainingSlotsScreen-W4v2mCfU.js","assets/radio-group-BJcjIqKm.js","assets/circle-Bp0YtxIU.js","assets/map-pin-D0Ez8WEc.js","assets/CoachSwimmerDetail-C9F1K1h4.js","assets/tabs-D1N4A8K5.js","assets/weekTypeColor-CDzbW0XO.js","assets/chart-column-CSt37C4u.js","assets/date-DrpgLmFD.js","assets/vendor-date-B8Mnp-Vt.js","assets/pencil-CliqpDr8.js","assets/StrengthCatalog-DZ2c9Evz.js","assets/SessionListView-CIohbToR.js","assets/play-D-sVyUvB.js","assets/save-D4vxvdke.js","assets/share-2-B4ZXUjGD.js","assets/drawer-C9p8kugP.js","assets/loader-circle-B97264CH.js","assets/pen-CTjx52hG.js","assets/SwimCatalog-DGnfEI8a.js","assets/SwimSessionTimeline-C4mkcwZa.js","assets/SwimTimeInput-B2UdQCjs.js","assets/timer-DUe97Rdr.js","assets/eye-WPqWo2ol.js","assets/sparkles-CTiUJrkU.js"])))=>i.map(i=>d[i]);
import{c as P,B as M,f as R,R as me,u as U,b as ue,C as xe,g as he,i as pe,U as W,j as ge,e as be,k as O,l as y,I as fe,W as Q,D as je,_ as v}from"./index-D4AlBQ_D.js";import{j as e,r as l,u as S}from"./vendor-query-DyA9aSKS.js";import{g as ye,b as ve,c as Ne,a as E}from"./api-HuFCEWN3.js";import{A as we}from"./arrow-left-COS5F3eP.js";import{B as ke}from"./badge-EbRnC5t8.js";import{S as _e,a as Ce,b as Se,c as Ae,d as Ee}from"./select-Ck-N7aiY.js";import{C as Z,Z as De}from"./zap-B8toFBnC.js";import{M as Te}from"./message-square-BtcCsRT6.js";import{T as F}from"./trophy-QJMdaqxA.js";import{C as ee}from"./clock-gcAepbwR.js";import{S as Le}from"./search-CJLVAK1L.js";import{B as Y}from"./bell-ring-Ba7md07v.js";import{C as L}from"./chevron-right-aucX45E0.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Re=P("funnel",Fe);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}],["path",{d:"M3.22 13H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"auskq0"}]],X=P("heart-pulse",Me);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]],Ie=P("users-round",Oe),B=({title:t,description:n,onBack:s,actions:a})=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(M,{variant:"ghost",size:"sm",className:"-ml-2",onClick:s,children:[e.jsx(we,{className:"mr-2 h-4 w-4"}),"Retour"]}),e.jsx("h2",{className:"text-2xl font-display font-semibold uppercase italic text-primary",children:t}),n?e.jsx("p",{className:"text-sm text-muted-foreground",children:n}):null]}),a?e.jsx("div",{className:"flex items-center gap-2",children:a}):null]}),Be={draft_athlete:"En attente nageur",draft_coach:"En attente coach",sent:"Envoyé, à signer"};function z(t,n){const s=new Date(t),a=new Date(n),r=s.getTime()-a.getTime(),x=Math.ceil(r/(1e3*60*60*24));return x<0?"overdue":x<=7?"imminent":x<=30?"upcoming":"future"}function $e(t,n){return t.map(s=>({id:`comp-${s.id}`,type:"competition",date:s.date,title:s.name,subtitle:s.location??void 0,urgency:z(s.date,n),metadata:{...s}}))}function Pe(t,n){return t.map(s=>({id:`intv-${s.id}`,type:"interview",date:s.date,title:`Entretien : ${s.athlete_name}`,subtitle:Be[s.status]??s.status,athleteName:s.athlete_name,athleteId:s.athlete_id,urgency:z(s.date,n),metadata:{...s}}))}function ze(t,n){return t.filter(s=>s.end_competition_date!=null).map(s=>({id:`cycle-${s.id}`,type:"cycle_end",date:s.end_competition_date,title:`Fin cycle : ${s.name}`,subtitle:s.end_competition_name??void 0,athleteId:s.athlete_id??void 0,urgency:z(s.end_competition_date,n),metadata:{...s}}))}function qe(t){return[...t].sort((n,s)=>new Date(n.date).getTime()-new Date(s.date).getTime())}function Ve(t,n){return n==="all"?t:t.filter(s=>s.type===n)}function Ke(t,n,s){if(n===0)return t;const a=new Date(s);return a.setDate(a.getDate()+n),t.filter(r=>new Date(r.date)<=a)}function He(){const[t,n]=l.useState("all"),[s,a]=l.useState(30),r=l.useMemo(()=>new Date().toISOString().slice(0,10),[]),x=S({queryKey:["coach-events-competitions"],queryFn:ye}),u=S({queryKey:["coach-events-interviews"],queryFn:ve}),d=S({queryKey:["coach-events-cycles"],queryFn:()=>Ne()}),i=x.isLoading||u.isLoading||d.isLoading,j=l.useMemo(()=>{const h=$e(x.data??[],r),N=Pe(u.data??[],r),p=ze(d.data??[],r);return qe([...h,...N,...p])},[x.data,u.data,d.data,r]),_=l.useMemo(()=>{let h=Ve(j,t);return h=Ke(h,s,r),h},[j,t,s,r]),A=l.useMemo(()=>{const h={competition:0,interview:0,cycle_end:0,total:0};for(const N of j)h[N.type]++,h.total++;return h},[j]);return{events:_,isLoading:i,typeFilter:t,setTypeFilter:n,periodDays:s,setPeriodDays:a,counts:A}}const Ge={competition:{icon:F,label:"Compétition",dotColor:"bg-blue-500",glowColor:"shadow-[0_0_8px_rgba(59,130,246,0.5)]",accentBorder:"border-l-blue-500",accentBg:"bg-blue-500/5 dark:bg-blue-500/10"},interview:{icon:Te,label:"Entretien",dotColor:"bg-amber-500",glowColor:"shadow-[0_0_8px_rgba(245,158,11,0.5)]",accentBorder:"border-l-amber-500",accentBg:"bg-amber-500/5 dark:bg-amber-500/10"},cycle_end:{icon:me,label:"Fin de cycle",dotColor:"bg-violet-500",glowColor:"shadow-[0_0_8px_rgba(139,92,246,0.5)]",accentBorder:"border-l-violet-500",accentBg:"bg-violet-500/5 dark:bg-violet-500/10"}},Ue={overdue:{label:"En retard",className:"bg-red-500/10 text-red-600 dark:text-red-400 border-red-500/20",icon:ee},imminent:{label:"Imminent",className:"bg-amber-500/10 text-amber-600 dark:text-amber-400 border-amber-500/20"},upcoming:{label:"À venir",className:"bg-sky-500/10 text-sky-600 dark:text-sky-400 border-sky-500/20"},future:{label:"Futur",className:"bg-muted text-muted-foreground border-border"}},Qe=[{value:"7",label:"7j"},{value:"30",label:"30j"},{value:"90",label:"90j"},{value:"0",label:"Tout"}],Ye=[{value:"all",label:"Tout"},{value:"competition",label:"Compétitions",dotClass:"bg-blue-500"},{value:"interview",label:"Entretiens",dotClass:"bg-amber-500"},{value:"cycle_end",label:"Cycles",dotClass:"bg-violet-500"}],Xe=["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"];function Je(t){const n=new Date(t);return`${n.getFullYear()}-${String(n.getMonth()).padStart(2,"0")}`}function We(t){const n=new Date(t);return`${Xe[n.getMonth()]} ${n.getFullYear()}`}function Ze(t){const n=new Map;for(const s of t){const a=Je(s.date);n.has(a)||n.set(a,{label:We(s.date),events:[]}),n.get(a).events.push(s)}return Array.from(n.entries()).map(([s,a])=>({monthKey:s,...a}))}function et({event:t,isLast:n}){const s=Ge[t.type],a=Ue[t.urgency],r=s.icon,x=new Date(t.date).toLocaleDateString("fr-FR",{weekday:"short",day:"numeric",month:"short"});return e.jsxs("div",{className:"relative flex gap-4 group",children:[e.jsxs("div",{className:"relative flex flex-col items-center",children:[e.jsx("div",{className:`
            relative z-10 flex h-9 w-9 shrink-0 items-center justify-center
            rounded-full ${s.dotColor} text-white
            ${s.glowColor}
            transition-shadow duration-300 group-hover:shadow-lg
          `,children:e.jsx(r,{className:"h-4 w-4"})}),!n&&e.jsx("div",{className:"w-px flex-1 bg-border"})]}),e.jsxs("div",{className:`
          flex-1 mb-4 rounded-xl border border-border/60
          ${s.accentBg}
          border-l-[3px] ${s.accentBorder}
          p-3.5
          shadow-sm dark:shadow-none
          transition-all duration-200
          group-hover:shadow-md group-hover:border-border
        `,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground leading-snug",children:t.title}),t.subtitle&&e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5 leading-relaxed",children:t.subtitle})]}),e.jsx(ke,{variant:"outline",className:`shrink-0 text-[10px] leading-none px-2 py-0.5 font-medium ${a.className}`,children:a.label})]}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-2 text-xs text-muted-foreground",children:[e.jsx(Z,{className:"h-3 w-3 opacity-50"}),e.jsx("span",{className:"capitalize",children:x})]})]})]})}function tt({label:t}){return e.jsxs("div",{className:"relative flex items-center gap-4 pt-2 pb-1",children:[e.jsx("div",{className:"flex items-center justify-center w-9",children:e.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-border"})}),e.jsx("span",{className:"text-[11px] font-bold uppercase tracking-[0.15em] text-muted-foreground",style:{fontFamily:"var(--font-display, 'Oswald', sans-serif)"},children:t}),e.jsx("div",{className:"flex-1 h-px bg-border/50"})]})}function st(){return e.jsx("div",{className:"space-y-5 ml-0.5",children:[1,2,3].map(t=>e.jsxs("div",{className:"flex gap-4 animate-pulse motion-reduce:animate-none",children:[e.jsx(R,{className:"h-9 w-9 rounded-full shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-2.5 pt-1",children:[e.jsx(R,{className:"h-4 w-3/4 rounded-md"}),e.jsx(R,{className:"h-3 w-1/2 rounded-md"}),e.jsx(R,{className:"h-3 w-1/3 rounded-md"})]})]},t))})}function at(){const{events:t,isLoading:n,typeFilter:s,setTypeFilter:a,periodDays:r,setPeriodDays:x,counts:u}=He(),d=Ze(t);return e.jsxs("div",{className:"mx-auto w-full max-w-2xl space-y-5",children:[e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsx("h2",{className:"text-xl font-bold tracking-tight text-foreground",style:{fontFamily:"var(--font-display, 'Oswald', sans-serif)"},children:"Échéances"}),u.total>0&&e.jsxs("span",{className:"text-xs tabular-nums text-muted-foreground",children:[u.total," événement",u.total!==1?"s":""]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Re,{className:"h-3.5 w-3.5 text-muted-foreground shrink-0"}),e.jsx("div",{className:"flex gap-1",children:Ye.map(i=>e.jsxs("button",{onClick:()=>a(i.value),className:`
                  flex items-center gap-1.5
                  rounded-full min-h-[36px] px-3 py-1.5
                  text-xs font-medium transition-all duration-150
                  active:scale-95
                  ${s===i.value?"bg-foreground text-background shadow-sm":"bg-muted/70 text-muted-foreground hover:bg-muted"}
                `,children:[i.dotClass&&e.jsx("span",{className:`inline-block h-1.5 w-1.5 rounded-full ${i.dotClass}`}),i.label,i.value!=="all"&&u[i.value]>0&&e.jsx("span",{className:"opacity-50 tabular-nums",children:u[i.value]})]},i.value))})]}),e.jsxs(_e,{value:String(r),onValueChange:i=>x(Number(i)),children:[e.jsx(Ce,{className:"h-9 w-20 text-xs rounded-full border-border/50",children:e.jsx(Se,{})}),e.jsx(Ae,{children:Qe.map(i=>e.jsx(Ee,{value:i.value,children:i.label},i.value))})]})]}),n?e.jsx(st,{}):t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"flex h-14 w-14 items-center justify-center rounded-2xl bg-muted/50 mb-4",children:e.jsx(Z,{className:"h-7 w-7 text-muted-foreground/40"})}),e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Aucune échéance à venir"}),e.jsx("p",{className:"text-xs text-muted-foreground/60 mt-1",children:"Les compétitions, entretiens et fins de cycles apparaîtront ici"})]}):e.jsx("div",{className:"relative",children:d.map((i,j)=>e.jsxs("div",{children:[e.jsx(tt,{label:i.label}),i.events.map((_,A)=>e.jsx(et,{event:_,isLast:j===d.length-1&&A===i.events.length-1},_.id))]},i.monthKey))})]})}const nt=l.lazy(()=>v(()=>import("./CoachSwimmersOverview-AQuP0tu9.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]))),rt=l.lazy(()=>v(()=>import("./CoachMessagesScreen-DOg5cXLC.js"),__vite__mapDeps([24,1,2,3,4,5,6,7,8,9,25,12,13,14,15,16,22,11,10,17,18,19,20,21,23]))),lt=l.lazy(()=>v(()=>import("./CoachSmsScreen-BIIcNkhf.js"),__vite__mapDeps([26,1,2,4,5,6,7,8,10,25,27,14,28,29,21,30,31,3,9,11,12,13,15,16,17,18,19,20,22,23]))),it=l.lazy(()=>v(()=>import("./CoachCalendar-BYDe_--w.js"),__vite__mapDeps([32,1,2,33,34,4,5,6,7,8,23,19,3,9,12,13,14,15,16,35,36,37,28,38,39,40,11,10,17,18,20,21,22]))),ot=l.lazy(()=>v(()=>import("./CoachGroupsScreen-DMeKKxF9.js"),__vite__mapDeps([41,1,2,3,4,5,6,7,8,9,10,42,12,13,14,15,16,43,37,28,44,45,11,46,47,40,17,18,19,20,21,22,23]))),ct=l.lazy(()=>v(()=>import("./CoachCompetitionsScreen-CfAukt1P.js"),__vite__mapDeps([48,1,2,3,4,5,6,7,8,9,25,37,28,14,44,42,12,13,15,16,19,11,10,17,18,20,21,22,23]))),dt=l.lazy(()=>v(()=>import("./CoachObjectivesScreen-DB0YqXJz.js"),__vite__mapDeps([49,1,2,3,4,5,6,7,8,9,25,10,12,13,14,15,16,35,36,37,28,44,50,11,17,18,19,20,21,22,23]))),mt=l.lazy(()=>v(()=>import("./CoachTrainingSlotsScreen-W4v2mCfU.js"),__vite__mapDeps([51,1,2,3,4,5,6,7,8,9,10,43,37,28,14,44,12,13,15,16,52,36,53,34,23,20,54,40,11,17,18,19,21,22]))),ut=l.lazy(()=>v(()=>import("./CoachSwimmerDetail-C9F1K1h4.js"),__vite__mapDeps([55,1,2,4,5,6,7,8,3,9,56,36,13,10,57,58,15,25,12,14,16,35,37,28,44,50,40,59,60,31,61,45,30,18,20,23,19,54,11]))),xt=l.lazy(()=>v(()=>import("./StrengthCatalog-DZ2c9Evz.js"),__vite__mapDeps([62,1,2,3,4,5,6,7,8,9,52,36,13,12,14,15,16,53,25,29,28,42,44,56,63,34,64,65,23,39,61,66,40,67,27,21,68,69,11,10,17,18,19,20,22]))),ht=l.lazy(()=>v(()=>import("./SwimCatalog-DGnfEI8a.js"),__vite__mapDeps([70,1,2,3,4,5,6,7,8,9,29,28,14,44,23,71,72,16,73,74,15,20,63,34,64,65,13,36,53,39,61,66,40,25,12,31,75,59,60,21])));function $({children:t}){return e.jsxs("div",{className:"flex items-center gap-3 pb-0.5",children:[e.jsx("span",{className:"text-[9px] font-black uppercase tracking-[0.28em] text-muted-foreground/70",children:t}),e.jsx("div",{className:"flex-1 h-px bg-border/50"})]})}const pt=({onNavigate:t,onOpenRecordsAdmin:n,onOpenRecordsClub:s,onOpenAthlete:a,athletes:r,athletesLoading:x,kpiLoading:u,fatigueAlerts:d,mostLoadedAthlete:i,swimSessionCount:j,strengthSessionCount:_})=>{const A=new Date().toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"}),[h,N]=l.useState(""),p=l.useDeferredValue(h.trim().toLocaleLowerCase("fr-FR")),w=l.useMemo(()=>p?r.filter(o=>{const c=o.display_name.toLocaleLowerCase("fr-FR"),g=o.group_label?.toLocaleLowerCase("fr-FR")??"";return c.includes(p)||g.includes(p)}).slice(0,6):r.slice(0,5),[r,p]),b=d.length>0,k=b?{label:`${d.length} alerte${d.length>1?"s":""} fatigue`,detail:d.slice(0,2).map(o=>o.athleteName.split(" ")[0]).join(", ")+(d.length>2?"…":""),action:()=>t("swimmers")}:{label:"Créer une séance",detail:"Natation · Explorer la bibliothèque",action:()=>t("swim")},D=[{label:"Natation",icon:Q,action:()=>t("swim"),color:"text-cyan-500"},{label:"Muscu",icon:je,action:()=>t("strength"),color:"text-violet-500"},{label:"Groupes",icon:Ie,action:()=>t("groups"),color:"text-emerald-500"},{label:"Compétitions",icon:F,action:()=>t("competitions"),color:"text-amber-500"},{label:"Échéances",icon:O,action:()=>t("deadlines"),color:"text-orange-500"},{label:"Créneaux",icon:ee,action:()=>t("training-slots"),color:"text-blue-500"},{label:"SMS",icon:Y,action:()=>t("sms"),color:"text-rose-500"},{label:"Records",icon:F,action:s,color:"text-orange-500"},{label:"Admin rec.",icon:F,action:n,color:"text-slate-500"}];return e.jsxs("div",{className:"space-y-5 pb-24",children:[e.jsx("style",{children:`
        @keyframes cta-breathe {
          0%, 100% { opacity: 0.55; transform: scale(1); }
          50%       { opacity: 0.85; transform: scale(1.06); }
        }
        @keyframes cta-breathe-alert {
          0%, 100% { opacity: 0.45; }
          50%       { opacity: 0.85; }
        }
        @keyframes shimmer-slide {
          0%   { transform: translateX(-100%) skewX(-12deg); }
          100% { transform: translateX(300%) skewX(-12deg); }
        }
        .cta-glow     { animation: cta-breathe 3.5s ease-in-out infinite; }
        .cta-glow-alert { animation: cta-breathe-alert 1.4s ease-in-out infinite; }
        .cta-shimmer  { animation: shimmer-slide 2.8s ease-in-out infinite 0.8s; }
      `}),e.jsxs("div",{className:"sticky top-0 z-20 -mx-4 border-b bg-background/95 px-4 py-3 backdrop-blur",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>t("home"),className:"shrink-0 rounded-full border px-3 py-2 text-sm font-semibold active:bg-muted",children:"Aujourd'hui"}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Le,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(fe,{value:h,onChange:o=>N(o.target.value),placeholder:"Rechercher un nageur",className:"h-10 rounded-full pl-9"})]}),e.jsx(M,{size:"sm",className:"shrink-0 rounded-full",onClick:()=>t("messaging"),children:"Message"})]}),e.jsx("p",{className:"mt-2 text-[11px] uppercase tracking-[0.18em] text-muted-foreground capitalize",children:A})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsx($,{children:"Le Quotidien"}),e.jsxs("button",{type:"button",onClick:k.action,className:["relative w-full overflow-hidden rounded-3xl text-white transition-all duration-200 active:scale-[0.97]",b?"bg-gradient-to-br from-rose-500 via-red-500 to-orange-500":"bg-gradient-to-br from-primary via-primary/80 to-primary/60"].join(" "),children:[e.jsx("div",{className:b?"cta-glow-alert absolute inset-0":"cta-glow absolute inset-0",style:{background:b?"radial-gradient(ellipse at 20% 60%, rgba(255,80,60,0.6) 0%, transparent 65%)":"radial-gradient(ellipse at 20% 60%, rgba(255,255,255,0.2) 0%, transparent 65%)"}}),e.jsx("div",{className:"cta-shimmer absolute top-0 bottom-0 left-0 w-1/3 pointer-events-none",style:{background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.12), transparent)"}}),e.jsxs("div",{className:"relative flex items-center gap-4 px-6 py-7",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[b&&e.jsxs("div",{className:"mb-2.5 inline-flex items-center gap-1.5 rounded-full bg-white/20 px-2.5 py-1",children:[e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-white opacity-75"}),e.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-white"})]}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-[0.22em]",children:"Attention requise"})]}),e.jsx("p",{className:"text-[1.6rem] font-bold leading-tight tracking-tight",children:k.label}),e.jsx("p",{className:"mt-1.5 text-sm opacity-75",children:k.detail})]}),e.jsx("div",{className:"flex h-14 w-14 shrink-0 items-center justify-center rounded-2xl bg-white/15 backdrop-blur-sm border border-white/20",children:b?e.jsx(X,{className:"h-7 w-7 animate-pulse"}):e.jsx(Q,{className:"h-7 w-7"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>t("objectives"),className:"flex items-center gap-2.5 rounded-2xl border bg-card px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-xl bg-amber-100 dark:bg-amber-900/30",children:e.jsx(F,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Objectifs"}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Temps cibles"})]})]}),e.jsxs("button",{type:"button",onClick:()=>t("messaging"),className:"flex items-center gap-2.5 rounded-2xl border bg-card px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-xl bg-blue-100 dark:bg-blue-900/30",children:e.jsx(Y,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Message"}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Notifier un groupe"})]})]})]})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsx($,{children:"Tour de Contrôle"}),e.jsxs("div",{className:["rounded-3xl border p-4 space-y-3 transition-colors",b?"border-red-200 bg-red-50/70 dark:border-red-900/50 dark:bg-red-950/25":"bg-card border-border"].join(" "),children:[b&&!u&&e.jsx("div",{className:"space-y-1.5",children:d.map(o=>e.jsxs("button",{type:"button",onClick:()=>t("swimmers"),className:"flex w-full items-center gap-3 rounded-2xl bg-white/70 dark:bg-black/20 px-3.5 py-2.5 text-left transition-colors active:bg-white/90",children:[e.jsxs("span",{className:"relative flex h-3 w-3 shrink-0",children:[e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-red-400 opacity-60"}),e.jsx("span",{className:"relative inline-flex h-3 w-3 rounded-full bg-red-500"})]}),e.jsx("span",{className:"flex-1 text-sm font-semibold text-red-900 dark:text-red-200",children:o.athleteName}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-red-600 dark:text-red-400",children:"Fatigue max"}),e.jsx(L,{className:"h-3.5 w-3.5 text-red-400"})]},o.athleteName))}),e.jsxs("div",{className:"grid grid-cols-2 gap-2.5",children:[e.jsxs("div",{className:["rounded-2xl p-3.5",b?"bg-white/50 dark:bg-black/20":"bg-muted/40"].join(" "),children:[e.jsxs("div",{className:"mb-2 flex items-center gap-1.5",children:[e.jsx(X,{className:`h-3.5 w-3.5 ${d.length>0?"text-red-500":"text-muted-foreground"}`}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-[0.18em] text-muted-foreground",children:"Alertes"})]}),e.jsx("p",{className:`text-4xl font-black tabular-nums leading-none ${d.length>0?"text-red-600 dark:text-red-400":"text-foreground"}`,children:u?"–":d.length}),e.jsx("p",{className:"mt-1.5 text-[11px] text-muted-foreground truncate",children:u?"Calcul…":d.length>0?d.slice(0,2).map(o=>o.athleteName.split(" ")[0]).join(", "):"Aucune alerte"})]}),e.jsxs("div",{className:["rounded-2xl p-3.5",b?"bg-white/50 dark:bg-black/20":"bg-muted/40"].join(" "),children:[e.jsxs("div",{className:"mb-2 flex items-center gap-1.5",children:[e.jsx(De,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-[0.18em] text-muted-foreground",children:"Plus chargé"})]}),e.jsx("p",{className:"text-2xl font-black truncate leading-none",children:u?"–":i?.athleteName?.split(" ")[0]??"–"}),e.jsx("p",{className:"mt-1.5 text-[11px] text-muted-foreground",children:u?"Calcul…":i?`Charge ${Math.round(i.loadScore)}`:"Pas de données"})]})]})]})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-0.5",children:[e.jsx("span",{className:"text-[9px] font-black uppercase tracking-[0.28em] text-muted-foreground/70",children:"Nageurs"}),e.jsx("div",{className:"flex-1 h-px bg-border/50"}),h?e.jsx("button",{type:"button",onClick:()=>N(""),className:"text-[10px] font-bold text-primary",children:"Effacer"}):e.jsxs("button",{type:"button",onClick:()=>t("swimmers"),className:"flex items-center gap-0.5 text-[10px] font-bold text-primary",children:["Tous ",e.jsx(L,{className:"h-3 w-3"})]})]}),e.jsx("div",{className:"overflow-hidden rounded-3xl border bg-card shadow-sm",children:x?e.jsx("div",{className:"divide-y divide-border/60",children:[1,2,3,4].map(o=>e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3.5",children:[e.jsx("div",{className:"h-9 w-9 animate-pulse rounded-full bg-muted"}),e.jsxs("div",{className:"flex-1 space-y-1.5",children:[e.jsx("div",{className:"h-3.5 w-28 animate-pulse rounded bg-muted"}),e.jsx("div",{className:"h-3 w-18 animate-pulse rounded bg-muted"})]})]},o))}):w.length===0?e.jsx("p",{className:"px-4 py-8 text-center text-sm text-muted-foreground",children:"Aucun nageur trouvé."}):e.jsx("div",{className:"divide-y divide-border/60",children:w.map(o=>{const c=d.some(T=>T.athleteName===o.display_name),g=o.display_name.charAt(0).toUpperCase();return e.jsxs("button",{type:"button",onClick:()=>a(o),className:"flex w-full items-center gap-3 px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:["flex h-9 w-9 shrink-0 items-center justify-center rounded-full text-sm font-bold transition-all",c?"bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-400 ring-2 ring-red-400/60 ring-offset-1":"bg-primary/10 text-primary"].join(" "),children:g}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"truncate text-sm font-semibold",children:o.display_name}),e.jsx("p",{className:"truncate text-[11px] text-muted-foreground",children:o.group_label||"Sans groupe"})]}),c?e.jsxs("span",{className:"inline-flex shrink-0 items-center gap-1 rounded-full bg-red-100 px-2.5 py-1 text-[9px] font-black uppercase tracking-widest text-red-600 dark:bg-red-900/30 dark:text-red-400",children:[e.jsx("span",{className:"h-1.5 w-1.5 animate-pulse rounded-full bg-current"}),"Alerte"]}):e.jsx(L,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]},o.id??o.display_name)})})})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsx($,{children:"Arsenal"}),e.jsxs("div",{className:"space-y-2 rounded-3xl border bg-card p-3 shadow-sm",children:[e.jsxs("button",{type:"button",onClick:()=>t("calendar"),className:"flex w-full items-center gap-3 rounded-2xl bg-muted/40 px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-9 w-9 shrink-0 items-center justify-center rounded-xl bg-violet-100 dark:bg-violet-900/30",children:e.jsx(O,{className:"h-4.5 w-4.5 text-violet-600 dark:text-violet-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Calendrier · Assigner"}),e.jsxs("p",{className:"text-[11px] text-muted-foreground",children:[j??0," séances nat · ",_??0," muscu"]})]}),e.jsx(L,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]}),e.jsx("div",{className:"grid grid-cols-4 gap-1.5",children:D.map(o=>e.jsxs("button",{type:"button",onClick:o.action,className:"flex flex-col items-center gap-1.5 rounded-2xl border bg-card px-1.5 py-3 text-center transition-colors active:bg-muted",children:[e.jsx(o.icon,{className:`h-4.5 w-4.5 ${o.color}`}),e.jsx("span",{className:"text-[9px] font-semibold leading-tight text-muted-foreground",children:o.label})]},o.label))}),e.jsxs("button",{type:"button",onClick:()=>t("swimmers"),className:"flex w-full items-center gap-3 rounded-2xl bg-muted/40 px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-9 w-9 shrink-0 items-center justify-center rounded-xl bg-blue-100 dark:bg-blue-900/30",children:e.jsx(W,{className:"h-4.5 w-4.5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Voir tous les nageurs"}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:x?"Chargement…":`${r.length} nageur${r.length>1?"s":""}`})]}),e.jsx(L,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]})]})]})]})},J=t=>t.toISOString().split("T")[0],gt=t=>new Date(t.completed_at||t.started_at||t.date||t.created_at||0).getTime(),bt=t=>{if(!t.length)return null;const n=t.reduce((a,r)=>a+r,0)/t.length,s=Math.min(5,Math.max(1,Math.round(n/10*5)));return{average:n,rating:s}};function ft(){const t=U(c=>c.role),n=U(c=>c.setSelectedAthlete),[,s]=ue(),[a,r]=l.useState(()=>window.location.hash.match(/[?&]section=([^&]+)/)?.[1]||"home"),x=7,[u,d]=l.useState(null);l.useEffect(()=>{const c="/coach",g=a&&a!=="home"?`#${c}?section=${a}`:`#${c}`;window.location.hash!==g&&window.history.replaceState(null,"",g)},[a]),l.useEffect(()=>{const c=()=>{r("home"),d(null)};return window.addEventListener("nav:reset",c),()=>window.removeEventListener("nav:reset",c)},[]),l.useEffect(()=>{const c=g=>{const T=g.detail;r(T),d(null)};return window.addEventListener("nav:section",c),()=>window.removeEventListener("nav:section",c)},[]);const i=t==="coach"||t==="admin",j=a==="home"||a==="calendar",_=a==="home"||a==="messaging"||a==="sms"||a==="swimmers"||a==="athlete"||a==="calendar"||a==="groups"||a==="objectives",A=a==="messaging"||a==="sms"||a==="calendar"||a==="groups"||a==="training-slots",{data:h}=S({queryKey:["swim_catalog"],queryFn:()=>E.getSwimCatalog(),enabled:i&&j}),{data:N}=S({queryKey:["strength_catalog"],queryFn:()=>E.getStrengthSessions(),enabled:i&&j}),{data:p=[],isLoading:w}=S({queryKey:["athletes"],queryFn:()=>E.getAthletes(),enabled:i&&_}),b=l.useMemo(()=>p.slice(0,5),[p]),{data:k=[]}=S({queryKey:["groups"],queryFn:()=>E.getGroups(),enabled:i&&A}),D=S({queryKey:["coach-kpis",x,b.map(c=>c.id??c.display_name)],enabled:i&&a==="home"&&b.length>0,queryFn:async()=>{const c=x,g=new Date;g.setDate(g.getDate()-c);const T=J(g),te=J(new Date),q=await Promise.all(b.map(async f=>{const[I,ne]=await Promise.all([E.getSessions(f.display_name,f.id),E.getStrengthHistory(f.display_name,{athleteId:f.id,limit:50,from:T,to:te})]),V=I.filter(m=>new Date(m.date).getTime()>=g.getTime()),re=V.map(m=>m.fatigue??m.feeling).filter(m=>Number.isFinite(m)),le=V.reduce((m,C)=>m+(Number(C.duration)||0)*(Number(C.effort)||0),0),K=(ne?.runs??[]).filter(m=>gt(m)>=g.getTime()),ie=K.map(m=>m.fatigue??m.feeling??m.rpe).filter(m=>Number.isFinite(Number(m))).map(m=>Number(m)),oe=K.reduce((m,C)=>{const H=Number(C.feeling??C.rpe??0),G=Number(C.duration??0);if(G>0&&H>0)return m+G*H;const de=Array.isArray(C.logs)?C.logs.length:0;return m+de*5},0),ce=bt([...re,...ie]);return{athleteName:f.display_name,loadScore:le+oe,fatigueRating:ce}})),se=q.filter(f=>f.fatigueRating?.rating===5).map(f=>({athleteName:f.athleteName,rating:f.fatigueRating?.rating??0})),ae=q.filter(f=>f.loadScore>0).sort((f,I)=>I.loadScore-f.loadScore)[0];return{fatigueAlerts:se,mostLoadedAthlete:ae??null}}}),o=c=>{if(n({id:c.id??null,name:c.display_name}),c.id==null){s("/progress");return}d(c),r("athlete")};return i?e.jsxs("div",{className:"space-y-6",children:[a==="home"?e.jsx(pt,{onNavigate:r,onOpenRecordsAdmin:()=>s("/records-admin"),onOpenRecordsClub:()=>s("/records-club"),onOpenAthlete:o,athletes:p,athletesLoading:w,kpiLoading:D.isLoading,fatigueAlerts:D.data?.fatigueAlerts??[],mostLoadedAthlete:D.data?.mostLoadedAthlete??null,swimSessionCount:h?.length,strengthSessionCount:N?.length}):null,a==="swim"?e.jsxs("div",{className:"space-y-6",children:[e.jsx(B,{title:"Bibliothèque natation",description:"Accédez aux séances et aux templates natation.",onBack:()=>r("home"),actions:e.jsxs(M,{variant:"outline",size:"sm",onClick:()=>r("calendar"),children:[e.jsx(O,{className:"mr-1.5 h-3.5 w-3.5"}),"Assigner"]})}),e.jsx(l.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(ht,{})})]}):null,a==="strength"?e.jsxs("div",{className:"space-y-6",children:[e.jsx(B,{title:"Bibliothèque musculation",description:"Consultez et créez des séances musculation.",onBack:()=>r("home"),actions:e.jsxs(M,{variant:"outline",size:"sm",onClick:()=>r("calendar"),children:[e.jsx(O,{className:"mr-1.5 h-3.5 w-3.5"}),"Assigner"]})}),e.jsx(l.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(xt,{})})]}):null,a==="swimmers"?e.jsx(l.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(nt,{athletes:p,athletesLoading:w,onBack:()=>r("home"),onOpenAthlete:o})}):null,a==="athlete"?e.jsx(l.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(ut,{athleteId:u?.id??null,athleteName:u?.display_name??null,onBack:()=>r("home")})}):null,a==="messaging"?e.jsx(l.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(rt,{onBack:()=>r("home"),athletes:p,groups:k,athletesLoading:w})}):null,a==="sms"?e.jsx(l.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(lt,{onBack:()=>r("home"),athletes:p,groups:k,athletesLoading:w})}):null,a==="calendar"?e.jsx(l.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(it,{onBack:()=>r("home"),athletes:p,groups:k,swimSessions:h,strengthSessions:N})}):null,a==="groups"?e.jsx(l.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(ot,{onBack:()=>r("home"),athletes:p,groups:k,athletesLoading:w})}):null,a==="competitions"?e.jsx(l.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(ct,{onBack:()=>r("home")})}):null,a==="objectives"?e.jsx(l.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(dt,{onBack:()=>r("home"),athletes:p,athletesLoading:w})}):null,a==="training-slots"?e.jsx(l.Suspense,{fallback:e.jsx(y,{}),children:e.jsx(mt,{onBack:()=>r("home"),groups:k})}):null,a==="deadlines"?e.jsxs("div",{className:"space-y-6",children:[e.jsx(B,{title:"Échéances",description:"Compétitions, entretiens et fins de cycles",onBack:()=>r("home")}),e.jsx(at,{})]}):null]}):e.jsx("div",{className:"flex items-center justify-center min-h-[60vh] animate-in fade-in motion-reduce:animate-none",children:e.jsxs(xe,{className:"w-full max-w-sm shadow-xl border-t-4 border-t-primary",children:[e.jsxs(he,{children:[e.jsxs(pe,{className:"flex items-center gap-2 uppercase italic",children:[e.jsx(W,{className:"h-5 w-5 text-primary"}),"Accès Coach"]}),e.jsx(ge,{children:"Cette section est réservée aux coachs et administrateurs."})]}),e.jsx(be,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Connectez-vous avec un compte autorisé pour accéder aux outils de gestion."})})]})})}const Ft=Object.freeze(Object.defineProperty({__proto__:null,default:ft},Symbol.toStringTag,{value:"Module"}));export{B as C,Re as F,Ie as U,Ft as a};
