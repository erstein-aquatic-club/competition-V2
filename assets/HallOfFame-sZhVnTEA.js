import{j as e,r as p,u as re}from"./vendor-query-DyA9aSKS.js";import{a as ne}from"./api-DgHNrwix.js";import{c as T,g as i,C as m,h as d,e as x,B as k,i as le,W as oe,D as ce,j as f,T as b}from"./index-DEw8lXrn.js";import{S as ie,a as me,b as de,c as xe,d as he}from"./sheet-DDucIX1O.js";import{T as ue,a as pe,b as U,c as q}from"./tabs-wFWituNE.js";import{B as fe}from"./badge-BYZrxhk6.js";import{s as ge}from"./score-CwBbkHfb.js";import{g as je}from"./design-tokens-CKgCpdH6.js";import{A as be,a as ve,b as Ne}from"./avatar-B1EtdDOM.js";import{P as we}from"./PageHeader-BWdT6OVz.js";import{C as ye}from"./circle-alert-Di0VRNg9.js";import{S as _e}from"./sliders-horizontal-D4jt2W6h.js";import{f as ke,a as Se}from"./vendor-date-B8Mnp-Vt.js";import"./vendor-react-BzrpNAyj.js";import"./swim-BadMaWRd.js";import"./vendor-charts-BrQ8X25f.js";import"./vendor-supabase-DFPLkPj_.js";import"./vendor-motion-CMsaQ8FX.js";import"./index-Mlw1bK_H.js";import"./index-BE3EncBH.js";import"./index-C74tTsj8.js";import"./index-C9wGSa99.js";import"./chevron-left-CtHJ-HcN.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Te=T("crown",Ce);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],$e=T("heart",Me);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]],C=T("medal",Re),Fe="rounded-full px-3 py-1 text-lg font-mono font-bold md:text-xl";function u({value:a,toneScore:t}){const r=ge(t??null)??"hsl(var(--muted-foreground))";return e.jsx(fe,{className:Fe,style:{backgroundColor:r,color:je(r)},children:a})}const v=[{rank:1,height:"h-28",avatarSize:"h-12 w-12 text-lg",colOrder:"order-2"},{rank:2,height:"h-20",avatarSize:"h-10 w-10 text-base",colOrder:"order-1"},{rank:3,height:"h-14",avatarSize:"h-10 w-10 text-base",colOrder:"order-3"}],ze={1:{icon:Te,color:"text-rank-gold",bg:"bg-rank-gold/10",border:"border-rank-gold",pedestal:"from-rank-gold/30"},2:{icon:C,color:"text-rank-silver",bg:"bg-rank-silver/10",border:"border-rank-silver",pedestal:"from-rank-silver/30"},3:{icon:C,color:"text-rank-bronze",bg:"bg-rank-bronze/10",border:"border-rank-bronze",pedestal:"from-rank-bronze/30"}};function Oe(a){return a.avatarUrl?a.avatarUrl:`https://api.dicebear.com/7.x/initials/svg?seed=${encodeURIComponent(a.name)}`}function N({entry:a,config:t}){const r=ze[t.rank],l=r.icon,c=a.name.slice(0,2).toUpperCase();return e.jsxs("div",{className:`flex flex-col items-center gap-1 ${t.colOrder} flex-1`,children:[e.jsx(l,{className:`h-5 w-5 ${r.color} ${t.rank===1?"fill-rank-gold":t.rank===2?"fill-rank-silver":"fill-rank-bronze"}`}),e.jsxs(be,{className:`${t.avatarSize} border-2 ${r.border}`,children:[e.jsx(ve,{src:Oe(a),alt:a.name}),e.jsx(Ne,{className:`${r.bg} font-bold font-display`,children:c})]}),e.jsx("div",{className:"font-bold uppercase tracking-tight text-xs text-center truncate max-w-full px-1",children:a.name}),e.jsx(u,{value:a.value,toneScore:a.toneScore}),e.jsx("div",{className:`${t.height} w-full rounded-t-xl bg-gradient-to-b ${r.pedestal} to-muted/50 border-t-2 ${r.border}`})]})}function g({entries:a}){if(a.length===0)return e.jsx("div",{className:"text-center text-muted-foreground py-4",children:"Aucune donnée"});const t=a.slice(0,3);return t.length===1?e.jsx("div",{className:"flex justify-center py-2",children:e.jsx("div",{className:"w-1/3",children:e.jsx(N,{entry:t[0],config:v[0]})})}):e.jsxs("div",{className:"flex items-end justify-center gap-2 py-2",children:[e.jsx(N,{entry:t[1],config:v[1]}),e.jsx(N,{entry:t[0],config:v[0]}),t[2]&&e.jsx(N,{entry:t[2],config:v[2]})]})}const B=a=>{if(a==null)return null;const t=Number(a);return!Number.isFinite(t)||t<=0?null:t<=5?Math.min(5,t):Math.min(5,t/2)},S=a=>{const t=a.filter(r=>Number.isFinite(r));return t.length===0?null:{min:Math.min(...t),max:Math.max(...t)}},h=(a,t)=>{if(!Number.isFinite(a)||a===null||a===void 0||a<=0||!t||t.max<=0)return null;if(t.max===t.min)return 5;const l=1+(a-t.min)/(t.max-t.min)*4;return Math.max(1,Math.min(5,l))},o=(a,t)=>{if(a==null||!Number.isFinite(a))return"-";const{decimals:r=0,suffix:l}=t??{},c=a.toLocaleString(void 0,{minimumFractionDigits:r,maximumFractionDigits:r});return l?`${c} ${l}`:c},V=[{value:"7",label:"7j"},{value:"30",label:"30j"},{value:"90",label:"3 mois"},{value:"365",label:"1 an"}];function rs(){const[a,t]=p.useState("30"),[r,l]=p.useState(!1);p.useEffect(()=>{const s=()=>{t("30")};return window.addEventListener("nav:reset",s),()=>window.removeEventListener("nav:reset",s)},[]);const c=p.useMemo(()=>ke(Se(new Date,Number(a)),"yyyy-MM-dd"),[a]),K=p.useMemo(()=>V.find(s=>s.value===a)?.label??`${a}j`,[a]),{data:j,isLoading:W,error:M,refetch:G}=re({queryKey:["hall-of-fame",c],queryFn:()=>ne.getHallOfFame(c)}),Q=j?.distance??[],Y=j?.performance??[],J=j?.engagement??[],$=j?.strength??[],w=Q.map(s=>({...s,total_distance:Number(s.total_distance??0)})),R=Y.map(s=>({...s,avg_effort:B(s.avg_effort)})),F=J.map(s=>({...s,avg_engagement:B(s.avg_engagement)})),y=[...$].sort((s,n)=>Number(n.total_volume??0)-Number(s.total_volume??0)).slice(0,5),_=[...$].sort((s,n)=>Number(n.total_reps??0)-Number(s.total_reps??0)).slice(0,5),z=S(w.map(s=>Number(s.total_distance??0))),O=S(y.map(s=>Number(s.total_volume??0))),D=S(_.map(s=>Number(s.total_reps??0))),X=w.slice(0,3).map(s=>({name:s.athlete_name,value:o(s.total_distance/1e3,{decimals:1,suffix:"km"}),toneScore:h(s.total_distance,z),avatarUrl:s.avatar_url})),L=w.slice(3),Z=R.slice(0,3).map(s=>({name:s.athlete_name,value:o(s.avg_effort,{decimals:1}),toneScore:s.avg_effort,avatarUrl:s.avatar_url})),P=R.slice(3),ee=F.slice(0,3).map(s=>({name:s.athlete_name,value:o(s.avg_engagement,{decimals:1}),toneScore:s.avg_engagement,avatarUrl:s.avatar_url})),A=F.slice(3),se=y.slice(0,3).map(s=>({name:s.athlete_name,value:o(Number(s.total_volume??0),{suffix:"kg"}),toneScore:h(Number(s.total_volume??0),O),avatarUrl:s.avatar_url})),E=y.slice(3),ae=_.slice(0,3).map(s=>({name:s.athlete_name,value:o(Number(s.total_reps??0),{suffix:"reps"}),toneScore:h(Number(s.total_reps??0),D),avatarUrl:s.avatar_url})),H=_.slice(3);return W?e.jsxs("div",{className:"space-y-6","aria-live":"polite","aria-busy":"true",children:[e.jsx("div",{className:"sr-only",children:"Chargement du Hall of Fame..."}),e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[e.jsx(i,{className:"h-10 w-48"}),e.jsx(i,{className:"h-10 w-48"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"h-10 w-full"}),e.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 pt-4",children:Array.from({length:3}).map((s,n)=>e.jsxs(m,{className:"border-t-4",children:[e.jsx(d,{children:e.jsx(i,{className:"h-6 w-32"})}),e.jsx(x,{className:"space-y-4",children:Array.from({length:5}).map((I,te)=>e.jsxs("div",{className:"flex items-center justify-between gap-3 p-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(i,{className:"h-6 w-6"}),e.jsx(i,{className:"h-5 w-32"})]}),e.jsx(i,{className:"h-6 w-16"})]},`item-${te}`))})]},`skeleton-${n}`))})]})]}):M?e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[e.jsx(ye,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"font-semibold",children:"Impossible de charger les données"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:M.message}),e.jsx(k,{onClick:()=>G(),className:"mt-4",children:"Réessayer"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(we,{title:"Classements",icon:e.jsx(C,{className:"h-3.5 w-3.5"}),action:e.jsx(le,{href:"/records-club",children:e.jsx(k,{variant:"outline",size:"sm",className:"border-primary/20 text-primary hover:bg-primary/5",children:"Records club"})})}),e.jsx("div",{className:"rounded-2xl border border-border/70 bg-card/90 px-4 py-3 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-muted-foreground",children:"Période active"}),e.jsxs("p",{className:"mt-1 text-sm font-semibold text-foreground",children:["Top calculé sur ",K]})]}),e.jsxs(k,{type:"button",variant:"outline",size:"sm",onClick:()=>l(!0),className:"gap-1.5 border-primary/20 text-primary hover:bg-primary/5",children:[e.jsx(_e,{className:"h-3.5 w-3.5"}),"Période"]})]})}),e.jsx(ie,{open:r,onOpenChange:l,children:e.jsxs(me,{side:"bottom",className:"max-h-[70vh] overflow-y-auto rounded-t-3xl",children:[e.jsxs(de,{className:"text-left",children:[e.jsx(xe,{children:"Filtrer les classements"}),e.jsx(he,{children:"Choisis la période à prendre en compte pour recalculer les podiums."})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3 pt-5",children:V.map(s=>e.jsxs("button",{type:"button",onClick:()=>{t(s.value),l(!1)},className:`rounded-2xl border px-4 py-4 text-left transition-colors ${a===s.value?"border-primary bg-primary/5 text-primary":"border-border hover:border-primary/30"}`,children:[e.jsx("div",{className:"text-sm font-semibold",children:s.label}),e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:["Classement glissant sur ",s.label]})]},s.value))})]})}),e.jsxs(ue,{defaultValue:"swim",className:"w-full",children:[e.jsxs(pe,{className:"grid w-full grid-cols-2",children:[e.jsxs(U,{value:"swim",children:[e.jsx(oe,{className:"mr-2 h-4 w-4"})," Bassin"]}),e.jsxs(U,{value:"strength",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"})," Muscu"]})]}),e.jsx(q,{value:"swim",className:"space-y-6 pt-4 animate-in slide-in-from-left-4 motion-reduce:animate-none",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs(m,{className:"border-t-4 border-t-yellow-500 shadow-md",children:[e.jsx(d,{children:e.jsxs(f,{className:"flex items-center gap-2 text-base",children:[e.jsx(b,{className:"h-5 w-5 text-yellow-500"}),"Top Distance"]})}),e.jsxs(x,{children:[e.jsx(g,{entries:X}),L.length>0&&e.jsx("div",{className:"space-y-2 mt-4",children:L.map((s,n)=>{const I=s.total_distance?s.total_distance/1e3:0;return e.jsxs("div",{className:"flex items-center justify-between gap-3 p-3 rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"flex items-center gap-4 min-w-0",children:[e.jsx("span",{className:"font-mono font-bold text-muted-foreground w-6 text-center",children:n+4}),e.jsx("div",{className:"font-bold uppercase tracking-tight truncate",children:s.athlete_name})]}),e.jsx("div",{className:"shrink-0",children:e.jsx(u,{value:o(I,{decimals:1,suffix:"km"}),toneScore:h(s.total_distance,z)})})]},s.athlete_name)})})]})]}),e.jsxs(m,{className:"border-t-4 border-t-orange-500 shadow-md",children:[e.jsx(d,{children:e.jsxs(f,{className:"flex items-center gap-2 text-base",children:[e.jsx(b,{className:"h-5 w-5 text-orange-500"}),"Top Intensité (RPE Avg)"]})}),e.jsxs(x,{children:[e.jsx(g,{entries:Z}),P.length>0&&e.jsx("div",{className:"space-y-2 mt-4",children:P.map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between gap-3 p-3 rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"flex items-center gap-4 min-w-0",children:[e.jsx("span",{className:"font-mono font-bold text-muted-foreground w-6 text-center",children:n+4}),e.jsx("div",{className:"font-bold uppercase tracking-tight truncate",children:s.athlete_name})]}),e.jsx("div",{className:"shrink-0",children:e.jsx(u,{value:o(s.avg_effort,{decimals:1}),toneScore:s.avg_effort})})]},s.athlete_name))})]})]}),e.jsxs(m,{className:"border-t-4 border-t-rose-500 shadow-md",children:[e.jsx(d,{children:e.jsxs(f,{className:"flex items-center gap-2 text-base",children:[e.jsx($e,{className:"h-5 w-5 text-rose-500"}),"Top Engagement"]})}),e.jsxs(x,{children:[e.jsx(g,{entries:ee}),A.length>0&&e.jsx("div",{className:"space-y-2 mt-4",children:A.map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between gap-3 p-3 rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"flex items-center gap-4 min-w-0",children:[e.jsx("span",{className:"font-mono font-bold text-muted-foreground w-6 text-center",children:n+4}),e.jsx("div",{className:"font-bold uppercase tracking-tight truncate",children:s.athlete_name})]}),e.jsx("div",{className:"shrink-0",children:e.jsx(u,{value:o(s.avg_engagement,{decimals:1}),toneScore:s.avg_engagement})})]},`${s.athlete_name}-engagement`))})]})]})]})}),e.jsx(q,{value:"strength",className:"space-y-6 pt-4 animate-in slide-in-from-right-4 motion-reduce:animate-none",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs(m,{className:"border-t-4 border-t-emerald-500 shadow-md",children:[e.jsx(d,{children:e.jsxs(f,{className:"flex items-center gap-2 text-base",children:[e.jsx(b,{className:"h-5 w-5 text-emerald-500"}),"Top Tonnage"]})}),e.jsxs(x,{children:[e.jsx(g,{entries:se}),E.length>0&&e.jsx("div",{className:"space-y-2 mt-4",children:E.map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between gap-3 p-3 rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"flex items-center gap-4 min-w-0",children:[e.jsx("span",{className:"font-mono font-bold text-muted-foreground w-6 text-center",children:n+4}),e.jsx("div",{className:"font-bold uppercase tracking-tight truncate",children:s.athlete_name})]}),e.jsx("div",{className:"shrink-0",children:e.jsx(u,{value:o(Number(s.total_volume??0),{suffix:"kg"}),toneScore:h(Number(s.total_volume??0),O)})})]},s.athlete_name))})]})]}),e.jsxs(m,{className:"border-t-4 border-t-violet-500 shadow-md",children:[e.jsx(d,{children:e.jsxs(f,{className:"flex items-center gap-2 text-base",children:[e.jsx(b,{className:"h-5 w-5 text-violet-500"}),"Top Volume (Répétitions)"]})}),e.jsxs(x,{children:[e.jsx(g,{entries:ae}),H.length>0&&e.jsx("div",{className:"space-y-2 mt-4",children:H.map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between gap-3 p-3 rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"flex items-center gap-4 min-w-0",children:[e.jsx("span",{className:"font-mono font-bold text-muted-foreground w-6 text-center",children:n+4}),e.jsx("div",{className:"font-bold uppercase tracking-tight truncate",children:s.athlete_name})]}),e.jsx("div",{className:"shrink-0",children:e.jsx(u,{value:o(Number(s.total_reps??0),{suffix:"reps"}),toneScore:h(Number(s.total_reps??0),D)})})]},`${s.athlete_name}-reps`))})]})]})]})})]})]})}export{rs as default};
