import{r as o,j as e,c as je,u as H,d as V}from"./vendor-query-BiSH4r2z.js";import{c as be,A as De,E as qe,G as Ue,p as Y,a as ce,d as Ne,B as _,L as j,I as k,s as Ve,u as $e,b as Be,S as L,T as ze,o as Ge}from"./index-Dz1G674X.js";import{a as A}from"./api-D5nrcq73.js";import{A as He,F as Ke,e as de,T as ye,f as ue,p as pe}from"./objectiveHelpers-CDq4g8Vj.js";import{S as ee,a as se,b as te,c as re,d as G}from"./select-CS4PbhrI.js";import{B as P}from"./badge-0qYR7AHK.js";import{S as ae,a as ne,b as ie,c as oe,d as le,A as Qe,e as We,f as Ze,g as Je,h as Xe,i as Ye,j as es,k as ss}from"./alert-dialog-AGUn_vgy.js";import{u as he,t as fe,o as we,s as E,l as ts}from"./types-D6NFhoV1.js";import{f as rs}from"./animations-CrcLFysI.js";import{T as as,a as X}from"./toggle-group-DdZNzTCF.js";import{P as ge}from"./plus-D2a48khI.js";import{T as Se}from"./target-BmbtZu6V.js";import{T as ns}from"./trash-2-D_phj0pB.js";import{C as is}from"./circle-alert-D-vzv-7J.js";import{m as os}from"./proxy-Dh0N-Z8G.js";import{P as ls}from"./pen-BMB0YOYt.js";import{S as cs}from"./save-oQkFXVhw.js";import"./vendor-react-BzrpNAyj.js";import"./vendor-supabase-6k692oZB.js";import"./swim-CusmRTEQ.js";import"./index-x_G3AtZ6.js";import"./chevron-down-DeyqN5a9.js";import"./check-CHXwkbMe.js";import"./chevron-up-BThDbMB2.js";import"./index-CPu5HhZp.js";import"./design-tokens-CKgCpdH6.js";import"./index-DwmTJ01u.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],us=be("log-out",ds);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],xs=be("lock",ms);function ps(s,r=[]){let a=[];function c(n,u){const d=o.createContext(u);d.displayName=n+"Context";const m=a.length;a=[...a,u];const g=h=>{const{scope:C,children:b,...N}=h,y=C?.[s]?.[m]||d,S=o.useMemo(()=>N,Object.values(N));return e.jsx(y.Provider,{value:S,children:b})};g.displayName=n+"Provider";function f(h,C){const b=C?.[s]?.[m]||d,N=o.useContext(b);if(N)return N;if(u!==void 0)return u;throw new Error(`\`${h}\` must be used within \`${n}\``)}return[g,f]}const l=()=>{const n=a.map(u=>o.createContext(u));return function(d){const m=d?.[s]||n;return o.useMemo(()=>({[`__scope${s}`]:{...d,[s]:m}}),[d,m])}};return l.scopeName=s,[c,hs(l,...r)]}function hs(...s){const r=s[0];if(s.length===1)return r;const a=()=>{const c=s.map(l=>({useScope:l(),scopeName:l.scopeName}));return function(n){const u=c.reduce((d,{useScope:m,scopeName:g})=>{const h=m(n)[`__scope${g}`];return{...d,...h}},{});return o.useMemo(()=>({[`__scope${r.scopeName}`]:u}),[u])}};return a.scopeName=r.scopeName,a}var fs=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],me=fs.reduce((s,r)=>{const a=De(`Primitive.${r}`),c=o.forwardRef((l,n)=>{const{asChild:u,...d}=l,m=u?a:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(m,{...d,ref:n})});return c.displayName=`Primitive.${r}`,{...s,[r]:c}},{});function gs(){return qe.useSyncExternalStore(vs,()=>!0,()=>!1)}function vs(){return()=>{}}var xe="Avatar",[js]=ps(xe),[bs,_e]=js(xe),Ce=o.forwardRef((s,r)=>{const{__scopeAvatar:a,...c}=s,[l,n]=o.useState("idle");return e.jsx(bs,{scope:a,imageLoadingStatus:l,onImageLoadingStatusChange:n,children:e.jsx(me.span,{...c,ref:r})})});Ce.displayName=xe;var Ae="AvatarImage",Le=o.forwardRef((s,r)=>{const{__scopeAvatar:a,src:c,onLoadingStatusChange:l=()=>{},...n}=s,u=_e(Ae,a),d=Ns(c,n),m=Ue(g=>{l(g),u.onImageLoadingStatusChange(g)});return Y(()=>{d!=="idle"&&m(d)},[d,m]),d==="loaded"?e.jsx(me.img,{...n,ref:r,src:c}):null});Le.displayName=Ae;var Ee="AvatarFallback",Pe=o.forwardRef((s,r)=>{const{__scopeAvatar:a,delayMs:c,...l}=s,n=_e(Ee,a),[u,d]=o.useState(c===void 0);return o.useEffect(()=>{if(c!==void 0){const m=window.setTimeout(()=>d(!0),c);return()=>window.clearTimeout(m)}},[c]),u&&n.imageLoadingStatus!=="loaded"?e.jsx(me.span,{...l,ref:r}):null});Pe.displayName=Ee;function ve(s,r){return s?r?(s.src!==r&&(s.src=r),s.complete&&s.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Ns(s,{referrerPolicy:r,crossOrigin:a}){const c=gs(),l=o.useRef(null),n=c?(l.current||(l.current=new window.Image),l.current):null,[u,d]=o.useState(()=>ve(n,s));return Y(()=>{d(ve(n,s))},[n,s]),Y(()=>{const m=h=>()=>{d(h)};if(!n)return;const g=m("loaded"),f=m("error");return n.addEventListener("load",g),n.addEventListener("error",f),r&&(n.referrerPolicy=r),typeof a=="string"&&(n.crossOrigin=a),()=>{n.removeEventListener("load",g),n.removeEventListener("error",f)}},[n,a,r]),u}var Te=Ce,ke=Le,Fe=Pe;const Me=o.forwardRef(({className:s,...r},a)=>e.jsx(Te,{ref:a,className:ce("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...r}));Me.displayName=Te.displayName;const Re=o.forwardRef(({className:s,...r},a)=>e.jsx(ke,{ref:a,className:ce("aspect-square h-full w-full",s),...r}));Re.displayName=ke.displayName;const Oe=o.forwardRef(({className:s,...r},a)=>e.jsx(Fe,{ref:a,className:ce("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...r}));Oe.displayName=Fe.displayName;function ys({onBack:s}){const{toast:r}=Ne(),a=je(),[c,l]=o.useState(!1),[n,u]=o.useState(null),[d,m]=o.useState(null),{data:g}=H({queryKey:["auth-user"],queryFn:async()=>{const{data:t}=await Ve.auth.getUser();return t.user}}),f=g?.id??null,{data:h=[],isLoading:C}=H({queryKey:["athlete-objectives"],queryFn:()=>A.getAthleteObjectives(),enabled:!!f}),b=o.useMemo(()=>h.filter(t=>t.created_by!==f),[h,f]),N=o.useMemo(()=>h.filter(t=>t.created_by===f),[h,f]),[y,S]=o.useState("chrono"),[F,M]=o.useState(""),[p,v]=o.useState("25"),[x,R]=o.useState(""),[O,I]=o.useState(""),$=()=>{S("chrono"),M(""),v("25"),R(""),I("")},D=()=>{u(null),$(),l(!0)},K=t=>{u(t);const Z=!!t.event_code,i=!!t.text;S(Z&&i?"both":i?"texte":"chrono"),M(t.event_code??""),v(String(t.pool_length??25)),R(t.target_time_seconds!=null?ue(t.target_time_seconds):""),I(t.text??""),l(!0)},q=()=>a.invalidateQueries({queryKey:["athlete-objectives"]}),U=V({mutationFn:t=>A.createObjective(t),onSuccess:()=>{r({title:"Objectif créé"}),q(),l(!1)},onError:t=>r({title:"Erreur",description:t.message,variant:"destructive"})}),B=V({mutationFn:t=>A.updateObjective(n.id,t),onSuccess:()=>{r({title:"Objectif mis à jour"}),q(),l(!1)},onError:t=>r({title:"Erreur",description:t.message,variant:"destructive"})}),Q=V({mutationFn:t=>A.deleteObjective(t),onSuccess:()=>{r({title:"Objectif supprimé"}),q(),m(null)},onError:t=>r({title:"Erreur",description:t.message,variant:"destructive"})}),w=y==="chrono"||y==="both",T=y==="texte"||y==="both",z=U.isPending||B.isPending,W=()=>{if(w&&!F){r({title:"Épreuve requise",variant:"destructive"});return}if(w&&x&&pe(x)===null){r({title:"Format invalide",description:"Format : m:ss:cc (ex: 1:05:30)",variant:"destructive"});return}if(T&&!O.trim()){r({title:"Texte requis",variant:"destructive"});return}if(!f)return;const t={athlete_id:f,event_code:w?F:null,pool_length:w?Number(p):null,target_time_seconds:w&&x?pe(x):null,text:T?O.trim():null};n?B.mutate(t):U.mutate(t)};return e.jsxs("div",{className:"space-y-6 pb-24",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(_,{variant:"ghost",size:"sm",className:"-ml-2",onClick:s,children:[e.jsx(He,{className:"mr-1.5 h-4 w-4"}),"Retour"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-display font-semibold uppercase italic text-primary",children:"Mon plan"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Mes objectifs d'entraînement"})]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:D,children:[e.jsx(ge,{className:"mr-1.5 h-3.5 w-3.5"}),"Ajouter"]})]})]}),C&&e.jsx("div",{className:"space-y-2",children:[1,2,3].map(t=>e.jsx("div",{className:"rounded-xl border p-3 animate-pulse motion-reduce:animate-none",children:e.jsx("div",{className:"h-4 w-40 rounded bg-muted"})},t))}),!C&&h.length===0&&e.jsxs("div",{className:"text-center py-12 space-y-3",children:[e.jsx(Se,{className:"h-10 w-10 text-muted-foreground mx-auto"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Aucun objectif pour le moment."}),e.jsxs(_,{variant:"outline",size:"sm",onClick:D,children:[e.jsx(ge,{className:"mr-1.5 h-3.5 w-3.5"}),"Ajouter un objectif"]})]}),b.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-[0.15em] text-muted-foreground",children:"Objectifs du coach"}),b.map(t=>e.jsx(ws,{objective:t},t.id))]}),N.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xs font-semibold uppercase tracking-[0.15em] text-muted-foreground",children:"Mes objectifs personnels"}),N.map(t=>e.jsx(Ss,{objective:t,onEdit:K,onDelete:m},t.id))]}),e.jsx(ae,{open:c,onOpenChange:l,children:e.jsxs(ne,{side:"bottom",className:"max-h-[85vh] overflow-y-auto",children:[e.jsxs(ie,{children:[e.jsx(oe,{children:n?"Modifier l'objectif":"Nouvel objectif"}),e.jsx(le,{children:n?"Modifiez votre objectif personnel.":"Ajoutez un objectif personnel."})]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Type d'objectif"}),e.jsxs(as,{type:"single",variant:"outline",value:y,onValueChange:t=>{t&&S(t)},className:"justify-start",children:[e.jsx(X,{value:"chrono",className:"text-xs",children:"Chrono"}),e.jsx(X,{value:"texte",className:"text-xs",children:"Texte"}),e.jsx(X,{value:"both",className:"text-xs",children:"Les deux"})]})]}),w&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Épreuve *"}),e.jsxs(ee,{value:F,onValueChange:M,children:[e.jsx(se,{children:e.jsx(te,{placeholder:"Choisir une épreuve"})}),e.jsx(re,{children:Ke.map(t=>e.jsx(G,{value:t,children:de(t)},t))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Bassin"}),e.jsxs(ee,{value:p,onValueChange:v,children:[e.jsx(se,{children:e.jsx(te,{})}),e.jsxs(re,{children:[e.jsx(G,{value:"25",children:"25m"}),e.jsx(G,{value:"50",children:"50m"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Temps cible (min:sec:centièmes)"}),e.jsx(k,{placeholder:"Ex : 1:05:30",value:x,onChange:t=>R(t.target.value)})]})]}),T&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Objectif texte *"}),e.jsx(ye,{placeholder:"Ex : Améliorer la coulée de dos",value:O,onChange:t=>I(t.target.value),rows:3})]}),e.jsx(_,{className:"w-full",onClick:W,disabled:z,children:z?"Enregistrement...":n?"Enregistrer":"Créer"})]})]})}),e.jsx(Qe,{open:!!d,onOpenChange:t=>{t||m(null)},children:e.jsxs(We,{children:[e.jsxs(Ze,{children:[e.jsx(Je,{children:"Supprimer l'objectif"}),e.jsx(Xe,{children:"Cette action est irréversible. L'objectif sera supprimé définitivement."})]}),e.jsxs(Ye,{children:[e.jsx(es,{children:"Annuler"}),e.jsx(ss,{onClick:()=>{d&&Q.mutate(d.id)},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Supprimer"})]})]})})]})}function ws({objective:s}){const r=!!s.event_code,a=!!s.text;return e.jsxs("div",{className:"rounded-xl border bg-card p-3 space-y-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(P,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:"Coach"}),r&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm font-semibold",children:de(s.event_code)}),s.pool_length&&e.jsxs(P,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:[s.pool_length,"m"]}),s.target_time_seconds!=null&&e.jsx(P,{variant:"outline",className:"text-[10px] px-1.5 py-0 font-mono",children:ue(s.target_time_seconds)})]})]}),a&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.text}),s.competition_name&&e.jsx(P,{variant:"outline",className:"border-orange-300 text-orange-600 dark:text-orange-400 text-[10px] px-1.5 py-0",children:s.competition_name})]})}function Ss({objective:s,onEdit:r,onDelete:a}){const c=!!s.event_code,l=!!s.text;return e.jsxs("div",{className:"rounded-xl border bg-card p-3 space-y-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[c&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm font-semibold",children:de(s.event_code)}),s.pool_length&&e.jsxs(P,{variant:"secondary",className:"text-[10px] px-1.5 py-0",children:[s.pool_length,"m"]}),s.target_time_seconds!=null&&e.jsx(P,{variant:"outline",className:"text-[10px] px-1.5 py-0 font-mono",children:ue(s.target_time_seconds)})]}),e.jsxs("div",{className:"ml-auto flex gap-1",children:[e.jsx("button",{type:"button",onClick:()=>r(s),className:"text-xs text-primary hover:underline",children:"Modifier"}),e.jsx("button",{type:"button",onClick:()=>a(s),className:"text-muted-foreground hover:text-destructive p-0.5",children:e.jsx(ns,{className:"h-3.5 w-3.5"})})]})]}),l&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.text})]})}const _s=s=>s!=="coach"&&s!=="admin"&&s!=="comite",Cs=s=>{switch(s){case"coach":return"Entraineur EAC";case"admin":return"Admin";case"comite":return"Comité";default:return"Nageur"}},As=we({group_id:E().optional(),bio:E().optional(),avatar_url:E().url("URL invalide").optional().or(ts("")),birthdate:E().optional().refine(s=>{if(!s)return!0;const r=new Date(s);if(isNaN(r.getTime()))return!1;const a=(new Date().getTime()-r.getTime())/(1e3*60*60*24*365.25);return a>=6&&a<=100},{message:"L'âge doit être entre 6 et 100 ans"}),ffn_iuf:E().optional().refine(s=>s?/^\d+$/.test(s):!0,{message:"L'IUF FFN doit être un nombre"})}),Ls=we({password:E().min(8,"Le mot de passe doit contenir au moins 8 caractères").regex(/[A-Z]/,"Le mot de passe doit contenir au moins une majuscule").regex(/\d/,"Le mot de passe doit contenir au moins un chiffre"),confirmPassword:E()}).refine(s=>s.password===s.confirmPassword,{message:"Les mots de passe ne correspondent pas",path:["confirmPassword"]});function tt(){const{user:s,userId:r,logout:a,role:c}=$e(),{toast:l}=Ne(),n=je(),[,u]=Be(),d=_s(c),m=c==="athlete"||c==="coach"||c==="admin",g=Cs(c),[f,h]=o.useState("home"),[C,b]=o.useState(!1),[N,y]=o.useState(!1),[S,F]=o.useState(!1),M=async()=>{F(!0),localStorage.removeItem("app_build_timestamp");try{const i=window.__pwaRegistration??await navigator.serviceWorker?.getRegistration();if(i&&(await i.update(),await new Promise(J=>setTimeout(J,1500))),"caches"in window){const J=await caches.keys();await Promise.all(J.map(Ie=>caches.delete(Ie)))}window.location.reload()}catch{window.location.reload()}},p=he({resolver:fe(As),defaultValues:{group_id:"",bio:"",avatar_url:"",birthdate:"",ffn_iuf:""}}),v=he({resolver:fe(Ls),defaultValues:{password:"",confirmPassword:""}}),{data:x,isLoading:R,error:O,refetch:I}=H({queryKey:["profile",s,r],queryFn:()=>A.getProfile({displayName:s,userId:r}),enabled:!!s}),{data:$=[],isLoading:D,error:K,refetch:q}=H({queryKey:["profile-groups"],queryFn:()=>A.getGroups(),enabled:!!s}),U=O||K,B=()=>{I(),q()},Q=o.useMemo(()=>{const i=x?.avatar_url;return i||(s?`https://api.dicebear.com/7.x/initials/svg?seed=${encodeURIComponent(s)}`:"")},[x,s]),w=V({mutationFn:i=>A.updateProfile({userId:r,profile:{group_id:i.group_id?Number(i.group_id):null,birthdate:i.birthdate||null,bio:i.bio,avatar_url:i.avatar_url,ffn_iuf:(i.ffn_iuf||"").trim()||null}}),onSuccess:()=>{n.invalidateQueries({queryKey:["profile"]}),b(!1),l({title:"Profil mis à jour"})},onError:i=>{l({title:"Mise à jour impossible",description:String(i?.message||i),variant:"destructive"})}}),T=V({mutationFn:i=>A.authPasswordUpdate(i),onSuccess:()=>{v.reset(),l({title:"Mot de passe mis à jour"})},onError:i=>{l({title:"Mise à jour impossible",description:String(i?.message||i),variant:"destructive"})}}),z=()=>{p.reset({group_id:x?.group_id?String(x.group_id):"",bio:x?.bio||"",avatar_url:x?.avatar_url||"",birthdate:x?.birthdate?String(x.birthdate).split("T")[0]:"",ffn_iuf:x?.ffn_iuf?String(x.ffn_iuf):""}),b(!0)},W=p.handleSubmit(i=>{w.mutate(i)}),t=v.handleSubmit(i=>{T.mutate({password:i.password})}),Z=$.find(i=>i.id===x?.group_id)?.name||x?.group_label||"Non défini";return R?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-xl bg-accent p-5",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(L,{className:"h-20 w-20 rounded-full"}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(L,{className:"h-6 w-32"}),e.jsx(L,{className:"h-4 w-24"})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(L,{className:"h-24 rounded-xl"}),e.jsx(L,{className:"h-24 rounded-xl"}),e.jsx(L,{className:"h-24 rounded-xl"}),e.jsx(L,{className:"h-24 rounded-xl"})]})]}):U?e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[e.jsx(is,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"font-semibold",children:"Impossible de charger les données"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:U.message}),e.jsx(_,{onClick:()=>B(),className:"mt-4",children:"Réessayer"})]}):f==="objectives"?e.jsx(ys,{onBack:()=>h("home")}):e.jsxs(os.div,{className:"space-y-6",variants:rs,initial:"hidden",animate:"visible",children:[e.jsx("div",{className:"rounded-xl bg-accent text-accent-foreground p-5",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(Me,{className:"h-20 w-20 ring-2 ring-primary ring-offset-2 ring-offset-accent",children:[e.jsx(Re,{src:Q,alt:s||"Profil"}),e.jsx(Oe,{className:"text-lg",children:(s||"?").slice(0,2).toUpperCase()})]}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:"text-2xl font-display font-bold uppercase italic text-accent-foreground truncate",children:s}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-1",children:[e.jsx(P,{variant:"secondary",className:"text-xs",children:g}),e.jsx("span",{className:"text-sm opacity-80",children:Z})]}),x?.bio&&e.jsx("p",{className:"text-xs opacity-70 mt-1.5 line-clamp-2",children:x.bio})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{type:"button",onClick:z,className:"rounded-xl border bg-card p-4 text-left shadow-sm active:bg-muted/50 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[e.jsx(ls,{className:"h-5 w-5 text-primary mb-2"}),e.jsx("p",{className:"text-sm font-bold",children:"Mon profil"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Modifier mes infos"})]}),m&&e.jsxs("button",{type:"button",onClick:()=>y(!0),className:"rounded-xl border bg-card p-4 text-left shadow-sm active:bg-muted/50 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[e.jsx(xs,{className:"h-5 w-5 text-primary mb-2"}),e.jsx("p",{className:"text-sm font-bold",children:"Sécurité"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Mot de passe"})]}),d&&e.jsxs("button",{type:"button",onClick:()=>u("/records"),className:"rounded-xl border bg-card p-4 text-left shadow-sm active:bg-muted/50 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[e.jsx(ze,{className:"h-5 w-5 text-primary mb-2"}),e.jsx("p",{className:"text-sm font-bold",children:"Records"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Mes perfs personnelles"})]}),e.jsxs("button",{type:"button",onClick:()=>h("objectives"),className:"rounded-xl border bg-card p-4 text-left shadow-sm active:bg-muted/50 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",children:[e.jsx(Se,{className:"h-5 w-5 text-primary mb-2"}),e.jsx("p",{className:"text-sm font-bold",children:"Objectifs"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Mon plan"})]})]}),e.jsxs(_,{variant:"destructive",onClick:a,className:"w-full gap-2",children:[e.jsx(us,{className:"h-4 w-4"}),"Se déconnecter"]}),e.jsxs("div",{className:"space-y-1 pt-2",children:[e.jsxs("button",{type:"button",onClick:M,disabled:S,className:"w-full flex items-center justify-center gap-2 text-xs text-muted-foreground hover:text-foreground transition-colors py-2",children:[e.jsx(Ge,{className:["h-3 w-3",S?"animate-bounce":""].join(" ")}),S?"Recherche en cours...":"Rechercher des mises à jour"]}),e.jsxs("p",{className:"text-[10px] text-center text-muted-foreground/60",children:["Version du ",new Date("2026-02-24T11:05:16.722Z").toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),e.jsx(ae,{open:C,onOpenChange:b,children:e.jsxs(ne,{side:"bottom",className:"max-h-[85vh] overflow-y-auto",children:[e.jsxs(ie,{children:[e.jsx(oe,{children:"Modifier le profil"}),e.jsx(le,{children:"Mettez à jour vos informations personnelles."})]}),e.jsxs("form",{onSubmit:W,className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{children:"Groupe"}),e.jsxs(ee,{value:p.watch("group_id"),onValueChange:i=>p.setValue("group_id",i),disabled:D,children:[e.jsx(se,{children:e.jsx(te,{placeholder:D?"Chargement...":"Choisir un groupe"})}),e.jsx(re,{children:$.map(i=>e.jsx(G,{value:String(i.id),children:i.name},i.id))})]})]}),d?e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{children:"IUF FFN"}),e.jsx(k,{...p.register("ffn_iuf"),placeholder:"879576",inputMode:"numeric"}),p.formState.errors.ffn_iuf&&e.jsx("p",{className:"text-xs text-destructive",role:"alert","aria-live":"assertive",children:p.formState.errors.ffn_iuf.message}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Identifiant unique FFN (utilisé pour importer vos records compétition)."})]}):null,e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{children:"Bio"}),e.jsx(ye,{...p.register("bio")}),p.formState.errors.bio&&e.jsx("p",{className:"text-xs text-destructive",role:"alert","aria-live":"assertive",children:p.formState.errors.bio.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{children:"Avatar (URL)"}),e.jsx(k,{...p.register("avatar_url"),placeholder:"https://..."}),p.formState.errors.avatar_url&&e.jsx("p",{className:"text-xs text-destructive",role:"alert","aria-live":"assertive",children:p.formState.errors.avatar_url.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{children:"Date de naissance"}),e.jsx(k,{type:"date",...p.register("birthdate")}),p.formState.errors.birthdate&&e.jsx("p",{className:"text-xs text-destructive",role:"alert","aria-live":"assertive",children:p.formState.errors.birthdate.message})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{type:"submit",disabled:w.isPending,className:"w-full",children:[e.jsx(cs,{className:"mr-2 h-4 w-4"}),"Enregistrer"]}),e.jsx(_,{type:"button",variant:"outline",onClick:()=>b(!1),disabled:w.isPending,children:"Annuler"})]})]})]})}),e.jsx(ae,{open:N,onOpenChange:y,children:e.jsxs(ne,{side:"bottom",className:"max-h-[85vh] overflow-y-auto",children:[e.jsxs(ie,{children:[e.jsx(oe,{children:"Changer le mot de passe"}),e.jsx(le,{children:"Votre mot de passe doit contenir au moins 8 caractères, une majuscule et un chiffre."})]}),e.jsxs("form",{onSubmit:t,className:"space-y-3 mt-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{children:"Nouveau mot de passe"}),e.jsx(k,{type:"password",...v.register("password"),placeholder:"••••••••"}),v.formState.errors.password&&e.jsx("p",{className:"text-xs text-destructive",role:"alert","aria-live":"assertive",children:v.formState.errors.password.message})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{children:"Confirmer"}),e.jsx(k,{type:"password",...v.register("confirmPassword"),placeholder:"••••••••"}),v.formState.errors.confirmPassword&&e.jsx("p",{className:"text-xs text-destructive",role:"alert","aria-live":"assertive",children:v.formState.errors.confirmPassword.message})]}),e.jsx(_,{type:"submit",className:"w-full",disabled:T.isPending,children:"Mettre à jour le mot de passe"})]})]})})]})}export{tt as default,Cs as getRoleLabel,_s as shouldShowRecords};
