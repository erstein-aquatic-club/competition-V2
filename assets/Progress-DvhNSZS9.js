import{r as m,u as w,e as mt,j as t}from"./vendor-query-DyA9aSKS.js";import{a as j}from"./api-DaVd0xqR.js";import{c as gt}from"./date-DrpgLmFD.js";import{u as K,T as xt,C as Re,e as _e,B as ft,f as ht}from"./index-DukBoFI0.js";import{T as pt,a as jt,b as ie,c as U,d as vt,e as I}from"./table-DwoYtEnP.js";import{T as yt,a as bt,b as $e,c as Oe}from"./tabs-3VoRu60Y.js";import{C as Nt,a as wt,b as St}from"./collapsible-Db7VRhne.js";import{s as Ve}from"./score-CwBbkHfb.js";import{i as Ct}from"./swim-DsbmPiVN.js";import{g as Dt}from"./design-tokens-CKgCpdH6.js";import{b as q}from"./animations-CrcLFysI.js";import{I as Pt}from"./InlineBanner-g4FAWLUV.js";import{P as At}from"./PageHeader-CwqZ_6od.js";import{s as le,a as D,e as Tt,f as A}from"./vendor-date-B8Mnp-Vt.js";import{C as Lt}from"./chart-column-8Wzt_RlC.js";import{m as k}from"./vendor-motion-CMsaQ8FX.js";import{a as T,A as Fe,X as E,T as L,b as Ke,P as Mt,d as kt,C as Rt,L as Ie,B as Ee,Y as de,e as ce,f as _t,g as $t}from"./vendor-charts-BrQ8X25f.js";import{T as Ot}from"./trending-down-iAQhVZgV.js";import{C as Ft}from"./chevron-down-DRe1EDOM.js";import"./vendor-react-BzrpNAyj.js";import"./vendor-supabase-DFPLkPj_.js";import"./index-BWlK1_Ix.js";import"./index-BAUf6cFa.js";import"./chevron-left-GXou_Vhn.js";function Y({label:x,value:u,max:g,invert:i=!1}){const v=u!==null?Math.min(100,u/g*100):0,S=Ve(u??null,{invert:i})??"hsl(var(--muted-foreground))";return t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"w-28 shrink-0 text-xs text-muted-foreground truncate",children:x}),t.jsx("div",{className:"relative h-2 flex-1 rounded-full bg-muted overflow-hidden",children:t.jsx(k.div,{className:"absolute inset-y-0 left-0 rounded-full",style:{backgroundColor:S},initial:{width:0},animate:{width:`${v}%`},transition:{duration:.6,ease:"easeOut"}})}),t.jsx("span",{className:"w-10 text-right text-sm font-mono font-semibold tabular-nums",children:u!==null?u.toFixed(1):"-"})]})}function qe({value:x,unit:u,label:g,trend:i,trendLabel:v}){return t.jsxs(k.div,{className:"flex flex-col items-center gap-0.5 py-2",variants:q,initial:"hidden",animate:"visible",children:[t.jsxs("div",{className:"flex items-baseline gap-1",children:[t.jsx("span",{className:"text-4xl font-mono font-bold tracking-tight",children:x}),u&&t.jsx("span",{className:"text-lg font-mono text-muted-foreground",children:u})]}),t.jsx("span",{className:"text-sm text-muted-foreground",children:g}),i!=null&&t.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-xs font-medium ${i>=0?"bg-emerald-500/10 text-emerald-600":"bg-red-500/10 text-red-600"}`,children:[i>=0?t.jsx(ht,{className:"h-3 w-3"}):t.jsx(Ot,{className:"h-3 w-3"}),i>=0?"+":"",i.toFixed(0),"%",v?` ${v}`:""]})]})}function M({value:x,label:u,colored:g,colorValue:i,invert:v}){const S="rounded-full px-3 py-1 text-sm font-mono";if(g&&i!==null&&i!==void 0){const d=Ve(i,{invert:v})??"hsl(var(--muted-foreground))";return t.jsx("span",{className:S,style:{backgroundColor:d,color:Dt(d)},children:x})}return t.jsxs("span",{className:`${S} bg-muted text-muted-foreground`,children:[x,u?` ${u}`:""]})}function ue(){return t.jsx("div",{className:"space-y-3 animate-pulse motion-reduce:animate-none",children:t.jsx("div",{className:"h-[180px] w-full rounded-xl bg-muted"})})}function me({title:x,children:u}){const[g,i]=m.useState(!1);return t.jsxs(Nt,{open:g,onOpenChange:i,children:[t.jsxs(wt,{className:"flex w-full items-center justify-between rounded-lg bg-muted/50 px-4 py-3 text-sm font-semibold hover:bg-muted transition-colors",children:[x,t.jsx(Ft,{className:`h-4 w-4 text-muted-foreground transition-transform duration-200 ${g?"rotate-180":""}`})]}),t.jsx(St,{className:"pt-4 animate-in fade-in slide-in-from-top-2 motion-reduce:animate-none",children:u})]})}const J={borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},X=[{value:7,label:"7j"},{value:30,label:"30j"},{value:365,label:"1 an"}];function ds(){const x=K(e=>e.user),u=K(e=>e.userId),g=K(e=>e.role),i=K(e=>e.selectedAthleteId),v=K(e=>e.selectedAthleteName),S=(g==="coach"||g==="admin")&&(i!==null||!!v),d=S?v:x,f=S?i:u,h=f??d,[Z]=m.useState("all"),[ge]=m.useState(""),[xe]=m.useState(""),[N,fe]=m.useState(30),[p,he]=m.useState(30);m.useEffect(()=>{const e=()=>{fe(30),he(30)};return window.addEventListener("nav:reset",e),()=>window.removeEventListener("nav:reset",e)},[]);const{data:ee=[]}=w({queryKey:["competitions"],queryFn:()=>j.getCompetitions()}),{data:V}=w({queryKey:["my-competition-ids",h],queryFn:()=>j.getMyCompetitionIds(f)}),{data:pe}=w({queryKey:["assignments",h],queryFn:()=>j.getAssignments(d,f),enabled:!!d}),{data:je=[]}=w({queryKey:["planned-absences",h],queryFn:()=>f?j.getPlannedAbsences({userId:f}):j.getMyPlannedAbsences()}),ve=m.useMemo(()=>new Set(je.map(e=>e.date)),[je]),{data:P,isLoading:Be}=w({queryKey:["sessions",h],queryFn:()=>j.getSessions(d,f),enabled:!!d}),R=mt({queryKey:["strength_history",h,"progress",Z,ge,xe],queryFn:({pageParam:e=0})=>j.getStrengthHistory(d,{athleteId:f,limit:10,offset:e,order:"desc",status:Z==="all"?void 0:Z,from:ge||void 0,to:xe||void 0}),enabled:!!d,getNextPageParam:e=>{const s=e.pagination.offset+e.pagination.limit;return s<e.pagination.total?s:void 0},initialPageParam:0}),ye=R.data?.pages.flatMap(e=>e.runs)??[],B=le(D(new Date,p)).toISOString(),H=Tt(new Date).toISOString(),be=le(D(new Date,p*2)).toISOString(),Ne=le(D(new Date,p)).toISOString(),{data:we,isLoading:He}=w({queryKey:["strength_history_summary",h,"progress",p,B,H],queryFn:()=>j.getStrengthHistory(d,{athleteId:f,limit:200,order:"desc",from:B,to:H}),enabled:!!d}),{data:We,isLoading:ze}=w({queryKey:["strength_history_aggregate",h,"progress",p,B,H],queryFn:()=>j.getStrengthHistoryAggregate(d,{athleteId:f,period:"day",limit:200,order:"asc",from:B,to:H}),enabled:!!d}),{data:Qe}=w({queryKey:["strength_history_aggregate_prev",h,"progress",p,be,Ne],queryFn:()=>j.getStrengthHistoryAggregate(d,{athleteId:f,period:"day",limit:200,order:"asc",from:be,to:Ne}),enabled:!!d}),Se=He||ze,te=we?.runs??[],Ge=we?.exercise_summary??[],_=We?.periods??[],Ue=Qe?.periods??[],Ce=m.useMemo(()=>!V||V.length===0?ee:ee.filter(e=>V.includes(e.id)),[ee,V]),y=m.useMemo(()=>{const e=new Date().toISOString().slice(0,10);return Ce.filter(s=>s.date.slice(0,10)>=e).sort((s,a)=>s.date.localeCompare(a.date))[0]??null},[Ce]),se=m.useMemo(()=>{if(!y)return null;const e=new Date;e.setHours(0,0,0,0);const s=new Date(y.date.slice(0,10)+"T00:00:00");return Math.round((s.getTime()-e.getTime())/(1e3*60*60*24))},[y]),De=m.useMemo(()=>{const e=`swim-dashboard-v2:${h}:presenceDefaults`;try{const a=window.localStorage.getItem(e);if(a)return JSON.parse(a)}catch{}const s={};for(let a=0;a<7;a++)s[a]={AM:!0,PM:!0};return s},[h]),W=m.useMemo(()=>y?gt({compDate:y.date.slice(0,10),assignments:pe,absenceDates:ve,presenceDefaults:De}):null,[y,pe,ve,De]),Ye=e=>{if(!P)return[];const s=D(new Date,e),a=P.filter(n=>new Date(n.date)>=s).reverse(),l=new Map;return a.forEach(n=>{const r=A(new Date(n.date),"dd/MM");l.has(r)||l.set(r,{date:r,distance:0,effort:0,rpe:0,performance:0,engagement:0,fatigue:0,count:0,rpeCount:0,performanceCount:0,engagementCount:0,fatigueCount:0});const o=l.get(r);o.distance+=n.distance,o.effort+=n.effort,o.count+=1,n.rpe!==null&&n.rpe!==void 0&&(o.rpe+=n.rpe,o.rpeCount+=1),n.performance!==null&&n.performance!==void 0&&(o.performance+=n.performance,o.performanceCount+=1),n.engagement!==null&&n.engagement!==void 0&&(o.engagement+=n.engagement,o.engagementCount+=1),n.fatigue!==null&&n.fatigue!==void 0&&(o.fatigue+=n.fatigue,o.fatigueCount+=1)}),Array.from(l.values()).map(n=>({...n,effort:Math.round(n.effort/n.count*10)/10,rpe:n.rpeCount?Math.round(n.rpe/n.rpeCount*10)/10:null,performance:n.performanceCount?Math.round(n.performance/n.performanceCount*10)/10:null,engagement:n.engagementCount?Math.round(n.engagement/n.engagementCount*10)/10:null,fatigue:n.fatigueCount?Math.round(n.fatigue/n.fatigueCount*10)/10:null}))},$=P?P.filter(e=>new Date(e.date)>=D(new Date,N)):[],O=$.length,c=$.reduce((e,s)=>(e.distance+=s.distance,e.duration+=s.duration,s.rpe!==null&&s.rpe!==void 0&&(e.rpeSum+=s.rpe,e.rpeCount+=1),s.performance!==null&&s.performance!==void 0&&(e.performanceSum+=s.performance,e.performanceCount+=1),s.engagement!==null&&s.engagement!==void 0&&(e.engagementSum+=s.engagement,e.engagementCount+=1),s.fatigue!==null&&s.fatigue!==void 0&&(e.fatigueSum+=s.fatigue,e.fatigueCount+=1),e),{distance:0,duration:0,rpeSum:0,rpeCount:0,performanceSum:0,performanceCount:0,engagementSum:0,engagementCount:0,fatigueSum:0,fatigueCount:0}),Je=c.rpeCount?c.rpeSum/c.rpeCount:null,Xe=c.performanceCount?c.performanceSum/c.performanceCount:null,Ze=c.engagementCount?c.engagementSum/c.engagementCount:null,et=c.fatigueCount?c.fatigueSum/c.fatigueCount:null,tt=O?c.duration/O:0,st=O?c.distance/O:0,Pe=Ye(N),nt=P?((e,s,a,l)=>{const n=new Date,r=D(n,a*2),o=D(n,a),F=s.filter(C=>{const b=new Date(C.date);return b>=r&&b<o}).reduce((C,b)=>C+(b.distance??0),0);return F===0?null:(e-F)/F*100})(c.distance,P,N):null,ne=["NL","DOS","BR","PAP","QN"],Ae={NL:"NL",DOS:"Dos",BR:"Brasse",PAP:"Pap",QN:"4N"},Te={NL:"hsl(210, 80%, 55%)",DOS:"hsl(160, 60%, 45%)",BR:"hsl(35, 85%, 55%)",PAP:"hsl(280, 60%, 55%)",QN:"hsl(340, 70%, 55%)"},z=m.useMemo(()=>{if(!$.length)return{pie:[],daily:[],hasData:!1};const e={NL:0,DOS:0,BR:0,PAP:0,QN:0};let s=!1;const a=new Map;for(const r of $){const o=r.stroke_distances;if(!o)continue;const G=A(new Date(r.date),"dd/MM");a.has(G)||a.set(G,{NL:0,DOS:0,BR:0,PAP:0,QN:0});const F=a.get(G);for(const C of ne){const b=o[C];b&&b>0&&(e[C]+=b,F[C]+=b,s=!0)}}const l=ne.filter(r=>e[r]>0).map(r=>({name:Ae[r],value:e[r],fill:Te[r]})),n=Array.from(a.entries()).map(([r,o])=>({date:r,...o}));return{pie:l,daily:n,hasData:s}},[$]),ae=e=>{const a=(Array.isArray(e?.logs)?e.logs:[]).map(r=>r?.rpe!==null&&r?.rpe!==void 0?Number(r.rpe):null).filter(r=>r!==null&&Number.isFinite(r));if(a.length>0)return a.reduce((r,o)=>r+o,0)/a.length;const l=e?.feeling??e?.rpe??null,n=l!=null?Number(l):null;return n!==null&&Number.isFinite(n)?n:null},at=e=>e==null||Number.isNaN(e)?"-":e.toFixed(1),Le=[...te].sort((e,s)=>{const a=new Date(e.started_at||e.date||e.created_at||0).getTime(),l=new Date(s.started_at||s.date||s.created_at||0).getTime();return a-l}).map(e=>({date:A(new Date(e.started_at||e.date||e.created_at||new Date),"dd/MM"),feeling:ae(e)})),Me=_.map(e=>({date:e.period,label:A(new Date(e.period),"dd/MM"),tonnage:Math.round(e.tonnage??0),volume:Math.round(e.volume??0)})),rt=_.reduce((e,s)=>e+(s.tonnage??0),0),ot=_.reduce((e,s)=>e+(s.volume??0),0),it=te.length,re=te.map(e=>ae(e)).filter(e=>e!==null&&Number.isFinite(e)),Q=re.length?re.reduce((e,s)=>e+s,0)/re.length:null,oe=[...Ge].map(e=>({exerciseId:Number(e.exercise_id),name:e.exercise_name||`Exercice ${e.exercise_id}`,totalSets:Number(e.total_sets??0),totalReps:Number(e.total_reps??0),totalVolume:Number(e.total_volume??0),maxWeight:e.max_weight!==null&&e.max_weight!==void 0?Number(e.max_weight):null,lastPerformedAt:e.last_performed_at??null})).sort((e,s)=>s.totalVolume-e.totalVolume),lt=(()=>{if(!_.length)return null;const e=_.reduce((a,l)=>a+(l.tonnage??0),0),s=Ue.reduce((a,l)=>a+(l.tonnage??0),0);return s===0?null:(e-s)/s*100})(),ke=oe.slice(0,8),dt=X.find(e=>e.value===N)?.label??`${N}j`,ct=X.find(e=>e.value===p)?.label??`${p}j`,ut=e=>{if(!e)return"-";const s=new Date(e);return Number.isNaN(s.getTime())?"-":A(s,"dd/MM/yyyy")};return t.jsxs("div",{className:"space-y-4 pb-4",children:[t.jsx(At,{title:"Analyse",icon:t.jsx(Lt,{className:"h-3.5 w-3.5"})}),t.jsx(Pt,{variant:"amber",icon:t.jsx(xt,{}),label:y?.name,badge:se===0?"Aujourd'hui":`J-${se}`,sublabel:y?.location,subbadge:W!=null&&W>0?`${W} séance${W>1?"s":""}`:void 0,visible:!!y&&se!=null}),t.jsxs(yt,{defaultValue:"swim",className:"w-full",children:[t.jsxs(bt,{className:"grid w-full max-w-[280px] grid-cols-2",children:[t.jsx($e,{value:"swim",children:"Natation"}),t.jsx($e,{value:"strength",children:"Musculation"})]}),t.jsxs(Oe,{value:"swim",className:"space-y-4 mt-4",children:[t.jsxs("div",{className:"rounded-2xl border border-border/70 bg-card/90 px-4 py-3 shadow-sm",children:[t.jsxs("div",{className:"min-w-0",children:[t.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-muted-foreground",children:"Période active"}),t.jsxs("p",{className:"mt-1 text-sm font-semibold text-foreground",children:["Natation sur ",dt]})]}),t.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:X.map(e=>t.jsx("button",{type:"button",onClick:()=>fe(e.value),className:`rounded-xl border px-3 py-1.5 text-xs font-semibold transition-colors ${N===e.value?"border-primary bg-primary/5 text-primary":"border-border text-muted-foreground hover:border-primary/30 hover:text-foreground"}`,children:e.label},e.value))})]}),t.jsx(qe,{value:(c.distance/1e3).toFixed(1),unit:"km",label:`volume sur ${N} jours`,trend:nt,trendLabel:"vs période préc."}),t.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[t.jsx(M,{value:`${O} séances`}),t.jsx(M,{value:`${Math.round(st).toLocaleString()}m moy`}),t.jsx(M,{value:`${Math.round(tt)}min moy`})]}),t.jsx(k.div,{variants:q,initial:"hidden",animate:"visible",children:t.jsx(Re,{className:"border-0 shadow-none bg-transparent",children:t.jsx(_e,{className:"p-0 h-[140px] w-full",children:Be?t.jsx(ue,{}):Pe.length===0?t.jsx("div",{className:"flex h-full items-center justify-center text-sm text-muted-foreground",children:"Aucune donnée disponible."}):t.jsx(T,{width:"100%",height:"100%",children:t.jsxs(Fe,{data:Pe,children:[t.jsx("defs",{children:t.jsxs("linearGradient",{id:"swimVolumeGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"0%",stopColor:"hsl(var(--primary))",stopOpacity:.3}),t.jsx("stop",{offset:"100%",stopColor:"hsl(var(--primary))",stopOpacity:0})]})}),t.jsx(E,{dataKey:"date",fontSize:10,tickLine:!1,axisLine:!1}),t.jsx(L,{contentStyle:J,formatter:e=>[`${e.toLocaleString()}m`,"Volume"]}),t.jsx(Ke,{type:"monotone",dataKey:"distance",stroke:"hsl(var(--primary))",strokeWidth:2,fill:"url(#swimVolumeGradient)",dot:!1,activeDot:{r:5,strokeWidth:2}})]})})})})}),t.jsxs(k.div,{className:"space-y-3",variants:q,initial:"hidden",animate:"visible",children:[t.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wider text-muted-foreground",children:"Ressentis moyens"}),t.jsx(Y,{label:"Difficulté",value:Je,max:5,invert:!0}),t.jsx(Y,{label:"Performance",value:Xe,max:5}),t.jsx(Y,{label:"Engagement",value:Ze,max:5}),t.jsx(Y,{label:"Fatigue",value:et,max:5,invert:!0})]}),z.hasData&&t.jsx(me,{title:`Répartition par nage (${N}j)`,children:t.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[t.jsx("div",{className:"h-[280px] w-full",children:t.jsx(T,{width:"100%",height:"100%",children:t.jsxs(Mt,{children:[t.jsx(kt,{data:z.pie,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:90,label:({name:e,percent:s})=>`${e} ${(s*100).toFixed(0)}%`,children:z.pie.map((e,s)=>t.jsx(Rt,{fill:e.fill},`pie-${s}`))}),t.jsx(L,{formatter:e=>[`${e.toLocaleString()}m`,"Distance"]}),t.jsx(Ie,{})]})})}),t.jsx("div",{className:"h-[280px] w-full",children:t.jsx(T,{width:"100%",height:"100%",children:t.jsxs(Ee,{data:z.daily,children:[t.jsx(E,{dataKey:"date",fontSize:10,tickLine:!1,axisLine:!1}),t.jsx(de,{fontSize:10,tickLine:!1,axisLine:!1}),t.jsx(L,{}),ne.map(e=>t.jsx(ce,{dataKey:e,stackId:"strokes",name:Ae[e],fill:Te[e],radius:0},e)),t.jsx(Ie,{})]})})})]})})]}),t.jsxs(Oe,{value:"strength",className:"space-y-4 mt-4",children:[t.jsxs("div",{className:"rounded-2xl border border-border/70 bg-card/90 px-4 py-3 shadow-sm",children:[t.jsxs("div",{className:"min-w-0",children:[t.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-[0.22em] text-muted-foreground",children:"Période active"}),t.jsxs("p",{className:"mt-1 text-sm font-semibold text-foreground",children:["Musculation sur ",ct]})]}),t.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:X.map(e=>t.jsx("button",{type:"button",onClick:()=>he(e.value),className:`rounded-xl border px-3 py-1.5 text-xs font-semibold transition-colors ${p===e.value?"border-primary bg-primary/5 text-primary":"border-border text-muted-foreground hover:border-primary/30 hover:text-foreground"}`,children:e.label},e.value))})]}),t.jsx(qe,{value:Math.round(rt).toLocaleString(),unit:"kg",label:`tonnage sur ${p} jours`,trend:lt,trendLabel:"vs période préc."}),t.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[t.jsx(M,{value:`${it} séances`}),t.jsx(M,{value:`${Math.round(ot).toLocaleString()} reps`}),t.jsx(M,{value:`RPE ${Q!==null?Q.toFixed(1):"-"}/10`,colored:!0,colorValue:Q!==null?Q/2:null,invert:!0})]}),t.jsx(k.div,{variants:q,initial:"hidden",animate:"visible",children:t.jsx(Re,{className:"border-0 shadow-none bg-transparent",children:t.jsx(_e,{className:"p-0 h-[140px] w-full",children:Se?t.jsx(ue,{}):Me.length===0?t.jsx("div",{className:"flex h-full items-center justify-center text-sm text-muted-foreground",children:"Aucune donnée disponible."}):t.jsx(T,{width:"100%",height:"100%",children:t.jsxs(_t,{data:Me,children:[t.jsx(E,{dataKey:"label",fontSize:10,tickLine:!1,axisLine:!1}),t.jsx(L,{contentStyle:J}),t.jsx(ce,{dataKey:"tonnage",name:"Tonnage (kg)",fill:"hsl(var(--primary))",radius:[4,4,0,0],opacity:.7}),t.jsx($t,{type:"monotone",dataKey:"volume",name:"Volume (reps)",stroke:"hsl(var(--accent))",strokeWidth:2,dot:!1})]})})})})}),t.jsxs(k.div,{variants:q,initial:"hidden",animate:"visible",children:[t.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wider text-muted-foreground mb-3",children:"Ressenti par séance"}),t.jsx("div",{className:"h-[130px] w-full",children:Se?t.jsx(ue,{}):Le.length===0?t.jsx("div",{className:"flex h-full items-center justify-center text-sm text-muted-foreground",children:"Aucune donnée disponible."}):t.jsx(T,{width:"100%",height:"100%",children:t.jsxs(Fe,{data:Le,children:[t.jsx("defs",{children:t.jsxs("linearGradient",{id:"strengthFeelingGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[t.jsx("stop",{offset:"0%",stopColor:"hsl(var(--foreground))",stopOpacity:.15}),t.jsx("stop",{offset:"100%",stopColor:"hsl(var(--foreground))",stopOpacity:0})]})}),t.jsx(E,{dataKey:"date",fontSize:10,tickLine:!1,axisLine:!1}),t.jsx(de,{domain:[0,10],hide:!0}),t.jsx(L,{contentStyle:J,formatter:e=>[e!==null?e.toFixed(1):"-","RPE"]}),t.jsx(Ke,{type:"monotone",dataKey:"feeling",stroke:"hsl(var(--foreground))",strokeWidth:2,fill:"url(#strengthFeelingGradient)",dot:{r:4,fill:"hsl(var(--background))",stroke:"hsl(var(--foreground))",strokeWidth:2},activeDot:{r:6}})]})})})]}),t.jsx(me,{title:"Détail par exercice",children:t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"h-[220px] w-full",children:ke.length===0?t.jsx("div",{className:"flex h-full items-center justify-center text-sm text-muted-foreground",children:"Aucun exercice enregistré."}):t.jsx(T,{width:"100%",height:"100%",children:t.jsxs(Ee,{data:ke,layout:"vertical",children:[t.jsx(E,{type:"number",fontSize:10,tickLine:!1,axisLine:!1}),t.jsx(de,{type:"category",dataKey:"name",fontSize:10,tickLine:!1,axisLine:!1,width:100}),t.jsx(L,{contentStyle:J,formatter:e=>[`${e.toLocaleString()} kg`,"Volume"]}),t.jsx(ce,{dataKey:"totalVolume",fill:"hsl(var(--primary))",radius:[0,4,4,0]})]})})}),t.jsx("div",{className:"w-full overflow-x-auto",children:t.jsxs(pt,{children:[t.jsx(jt,{children:t.jsxs(ie,{children:[t.jsx(U,{children:"Exercice"}),t.jsx(U,{className:"text-right",children:"Volume"}),t.jsx(U,{className:"text-right",children:"Max"}),t.jsx(U,{className:"text-right",children:"Dernier"})]})}),t.jsx(vt,{children:oe.length===0?t.jsx(ie,{children:t.jsx(I,{colSpan:4,className:"text-center text-sm text-muted-foreground",children:"Aucun exercice enregistré."})}):oe.map(e=>t.jsxs(ie,{children:[t.jsx(I,{className:"font-medium text-sm",children:e.name}),t.jsxs(I,{className:"text-right font-mono text-sm",children:[e.totalVolume.toLocaleString()," kg"]}),t.jsx(I,{className:"text-right font-mono text-sm",children:e.maxWeight!==null?Ct(e.maxWeight)?"PDC":`${e.maxWeight} kg`:"-"}),t.jsx(I,{className:"text-right text-xs text-muted-foreground",children:ut(e.lastPerformedAt)})]},e.exerciseId))})]})})]})}),t.jsx(me,{title:"Historique récent",children:t.jsxs("div",{className:"space-y-3",children:[ye.length===0&&t.jsx("div",{className:"text-center text-sm text-muted-foreground py-6",children:"Aucun historique disponible."}),ye.map(e=>t.jsxs("div",{className:"flex items-center justify-between border-b border-border/40 pb-2 last:border-b-0 last:pb-0",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-semibold",children:A(new Date(e.started_at||e.date||e.created_at||new Date),"dd/MM/yyyy")}),t.jsx("div",{className:"text-xs text-muted-foreground",children:e.status||"Séance"})]}),t.jsxs("div",{className:"text-sm font-mono font-semibold",children:[at(ae(e)),"/10"]})]},e.id)),R.hasNextPage&&t.jsx(ft,{variant:"outline",size:"sm",className:"w-full",onClick:()=>R.fetchNextPage(),disabled:R.isFetchingNextPage,children:R.isFetchingNextPage?"Chargement...":"Charger plus"})]})})]})]})]})}export{Y as ProgressBar,ds as default};
