const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CoachSwimmersOverview-Q4N4cRiR.js","assets/vendor-query-DyA9aSKS.js","assets/vendor-react-BzrpNAyj.js","assets/api-B2vWtBIi.js","assets/index-C8n7RHvM.js","assets/vendor-charts-BrQ8X25f.js","assets/vendor-supabase-DFPLkPj_.js","assets/vendor-motion-lao-Njgm.js","assets/index-CjFox4Qf.css","assets/swim-Ur09MvRu.js","assets/badge-eplu3J07.js","assets/arrow-left-B2XQPNp9.js","assets/search-D9doUYlU.js","assets/trophy-DAWqZUtL.js","assets/bell-ring-BoEdFDF5.js","assets/chevron-right-BBe-i3EZ.js","assets/zap-9Dlyyy7d.js","assets/clock-_7noDjKb.js","assets/CoachMessagesScreen-DuJfZZmo.js","assets/textarea-Dv6X0X9e.js","assets/select-o9R-Uy3P.js","assets/index-CNvkI8ip.js","assets/index-Czez78S2.js","assets/index-DCX2sNhR.js","assets/chevron-down-mWe9xaVK.js","assets/chevron-up-5WRfms-N.js","assets/CoachSmsScreen-DqVRgfBn.js","assets/command-Dnl9kd_r.js","assets/index-Cp1GxP9-.js","assets/dialog-C64CcAF4.js","assets/smsUtils-B5uW76OO.js","assets/external-link-YODzHiax.js","assets/copy-DL6j0hrZ.js","assets/CoachCalendar-D5oVZQzV.js","assets/CalendarGrid-BOfV-D-T.js","assets/chevron-left-DHXEMWkM.js","assets/toggle-group-BjNmVnG4.js","assets/index-B72Prd0s.js","assets/sheet-BRNG-zNr.js","assets/InlineBanner-DEKGNBSD.js","assets/circle-alert-DTh18tCk.js","assets/trash-2-DUbRsdUV.js","assets/CoachGroupsScreen-DIrkC1sS.js","assets/checkbox-DrJ6Tpew.js","assets/separator-Xky1WA-E.js","assets/alert-dialog-BduIZJJy.js","assets/collapsible-DIbFXK0y.js","assets/user-plus-B6qNoRj5.js","assets/power-KKiUAJ0h.js","assets/CoachCompetitionsScreen-BTnoWWFb.js","assets/CoachObjectivesScreen-CMDfk51x.js","assets/objectiveHelpers-DC7i01Ud.js","assets/ObjectiveCard-CaUJ_Zr2.js","assets/CoachTrainingSlotsScreen-CenVzNQj.js","assets/map-pin-Cb8-gHaO.js","assets/loader-circle-CyV-5MD3.js","assets/pencil-BNUUsfXE.js","assets/eye-off-5VhFyiXl.js","assets/eye-DCclIcSU.js","assets/swimSessionUtils-DN7EW4yB.js","assets/radio-group-yil_4Pg3.js","assets/circle-I1JpMk_2.js","assets/CoachSwimmerDetail-N81zmmtF.js","assets/tabs-BHhzs5HG.js","assets/weekTypeColor-CgTOHqNh.js","assets/chart-column-qpKEB4lM.js","assets/date-DrpgLmFD.js","assets/vendor-date-B8Mnp-Vt.js","assets/StrengthCatalog-C3KQYjpX.js","assets/SessionListView-BkUhi2B5.js","assets/play-BZN-DNU5.js","assets/save-C4WwUm0I.js","assets/share-2-C1P-x_ix.js","assets/drawer-sKLdV8yv.js","assets/pen-CFOfHK6Y.js","assets/SwimCatalog-Cudp4O5O.js","assets/SwimSessionTimeline-gAxvLjdi.js","assets/SwimTimeInput-C8cOKiBt.js","assets/timer-DF5fEg07.js","assets/sparkles-BWLwqTcy.js","assets/repeat-ZRMON7Mn.js"])))=>i.map(i=>d[i]);
import{b as ae,B as G,u as Z,a as ge,C as be,g as fe,i as je,U as ne,j as ye,e as Ne,k as x,l as U,I as we,W as J,D as ve,_ as b}from"./index-C8n7RHvM.js";import{j as e,r as a,u as F}from"./vendor-query-DyA9aSKS.js";import{a as L}from"./api-B2vWtBIi.js";import{A as ke}from"./arrow-left-B2XQPNp9.js";import{S as _e}from"./search-D9doUYlU.js";import{T as H}from"./trophy-DAWqZUtL.js";import{B as Y}from"./bell-ring-BoEdFDF5.js";import{C as z}from"./chevron-right-BBe-i3EZ.js";import{Z as Se}from"./zap-9Dlyyy7d.js";import{C as Ce}from"./clock-_7noDjKb.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}],["path",{d:"M3.22 13H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"auskq0"}]],Le=ae("heart-pulse",Ae);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]],De=ae("users-round",Ee),ee=({title:t,description:h,onBack:p,actions:s})=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(G,{variant:"ghost",size:"sm",className:"-ml-2",onClick:p,children:[e.jsx(ke,{className:"mr-2 h-4 w-4"}),"Retour"]}),e.jsx("h2",{className:"text-2xl font-display font-semibold uppercase italic text-primary",children:t}),h?e.jsx("p",{className:"text-sm text-muted-foreground",children:h}):null]}),s?e.jsx("div",{className:"flex items-center gap-2",children:s}):null]}),Re=a.lazy(()=>b(()=>import("./CoachSwimmersOverview-Q4N4cRiR.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]))),Te=a.lazy(()=>b(()=>import("./CoachMessagesScreen-DuJfZZmo.js"),__vite__mapDeps([18,1,2,3,4,5,6,7,8,9,19,20,21,22,23,24,25,14,11,12,13,15,16,17]))),Oe=a.lazy(()=>b(()=>import("./CoachSmsScreen-DqVRgfBn.js"),__vite__mapDeps([26,1,2,4,5,6,7,8,10,19,27,22,28,29,12,30,31,32,3,9,11,13,14,15,16,17]))),Fe=a.lazy(()=>b(()=>import("./CoachCalendar-D5oVZQzV.js"),__vite__mapDeps([33,1,2,34,35,4,5,6,7,8,15,13,3,9,20,21,22,23,24,25,36,37,38,28,39,40,41,11,12,14,16,17]))),ze=a.lazy(()=>b(()=>import("./CoachGroupsScreen-DIrkC1sS.js"),__vite__mapDeps([42,1,2,3,4,5,6,7,8,9,10,43,23,22,44,38,28,45,46,11,47,24,48,41,12,13,14,15,16,17]))),Ie=a.lazy(()=>b(()=>import("./CoachCompetitionsScreen-BTnoWWFb.js"),__vite__mapDeps([49,1,2,3,4,5,6,7,8,9,19,38,28,22,45,43,23,20,21,24,25,11,12,13,14,15,16,17]))),Me=a.lazy(()=>b(()=>import("./CoachObjectivesScreen-CMDfk51x.js"),__vite__mapDeps([50,1,2,3,4,5,6,7,8,9,19,10,20,21,22,23,24,25,36,37,38,28,45,51,52,11,12,13,14,15,16,17]))),se=a.lazy(()=>b(()=>import("./CoachTrainingSlotsScreen-CenVzNQj.js"),__vite__mapDeps([53,1,2,3,4,5,6,7,8,9,38,28,22,10,43,23,44,45,17,54,55,56,32,57,58,41,59,12,20,21,24,25,60,37,61,35,15,11,13,14,16]))),Pe=a.lazy(()=>b(()=>import("./CoachSwimmerDetail-N81zmmtF.js"),__vite__mapDeps([62,1,2,4,5,6,7,8,3,9,63,37,21,10,46,64,65,24,19,20,22,23,25,36,38,28,45,51,52,66,67,32,41,56,30,17,15,13,54,11]))),Be=a.lazy(()=>b(()=>import("./StrengthCatalog-C3KQYjpX.js"),__vite__mapDeps([68,1,2,3,4,5,6,7,8,9,60,37,21,23,61,19,29,28,22,43,45,63,20,24,25,69,35,70,71,15,40,56,72,41,73,27,12,55,74]))),qe=a.lazy(()=>b(()=>import("./SwimCatalog-Cudp4O5O.js"),__vite__mapDeps([75,1,2,3,4,5,6,7,8,9,29,28,22,45,15,76,77,51,25,78,59,58,24,17,69,35,70,71,21,37,61,40,56,72,41,19,20,23,32,79,80,66,67,12])));function K({children:t}){return e.jsxs("div",{className:"flex items-center gap-3 pb-0.5",children:[e.jsx("span",{className:"text-[9px] font-black uppercase tracking-[0.28em] text-muted-foreground/70",children:t}),e.jsx("div",{className:"flex-1 h-px bg-border/50"})]})}function Ve({score:t}){if(t==null)return null;const h=Math.round(t),p=t>=3.5?"bg-emerald-500":t>=2.5?"bg-amber-500":"bg-red-500";return e.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:5}).map((s,r)=>e.jsx("div",{className:`h-1.5 w-1.5 rounded-full ${r<h?p:"bg-muted"}`},r))})}const $e=({onNavigate:t,onOpenRecordsAdmin:h,onOpenRecordsClub:p,onOpenAthlete:s,athletes:r,athletesLoading:E,kpiLoading:f,fatigueAlerts:d,mostLoadedAthlete:D,formeScores:v,swimSessionCount:P,strengthSessionCount:I})=>{const j=new Date().toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"}),[k,M]=a.useState(""),_=a.useDeferredValue(k.trim().toLocaleLowerCase("fr-FR")),R=a.useMemo(()=>_?r.filter(n=>{const m=n.display_name.toLocaleLowerCase("fr-FR"),N=n.group_label?.toLocaleLowerCase("fr-FR")??"";return m.includes(_)||N.includes(_)}).slice(0,6):r.slice(0,5),[r,_]),w=d.length>0,c={label:"Créer une séance",detail:"Natation · Explorer la bibliothèque",action:()=>t("swim")},y=[{label:"Natation",icon:J,action:()=>t("swim"),color:"text-cyan-500"},{label:"Muscu",icon:ve,action:()=>t("strength"),color:"text-violet-500"},{label:"Groupes",icon:De,action:()=>t("groups"),color:"text-emerald-500"},{label:"Échéances",icon:U,action:()=>t("competitions"),color:"text-orange-500"},{label:"Créneaux",icon:Ce,action:()=>t("training-slots"),color:"text-blue-500"},{label:"SMS",icon:Y,action:()=>t("sms"),color:"text-rose-500"},{label:"Records",icon:H,action:p,color:"text-orange-500"},{label:"Admin rec.",icon:H,action:h,color:"text-slate-500"}];return e.jsxs("div",{className:"space-y-5 pb-24",children:[e.jsx("style",{children:`
        @keyframes cta-breathe {
          0%, 100% { opacity: 0.55; transform: scale(1); }
          50%       { opacity: 0.85; transform: scale(1.06); }
        }
        @keyframes shimmer-slide {
          0%   { transform: translateX(-100%) skewX(-12deg); }
          100% { transform: translateX(300%) skewX(-12deg); }
        }
        .cta-glow     { animation: cta-breathe 3.5s ease-in-out infinite; }
        .cta-shimmer  { animation: shimmer-slide 2.8s ease-in-out infinite 0.8s; }
      `}),e.jsxs("div",{className:"sticky top-0 z-20 -mx-4 border-b bg-background/95 px-4 py-3 backdrop-blur",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>t("home"),className:"shrink-0 rounded-full border px-3 py-2 text-sm font-semibold active:bg-muted",children:"Aujourd'hui"}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx(_e,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(we,{value:k,onChange:n=>M(n.target.value),placeholder:"Rechercher un nageur",className:"h-10 rounded-full pl-9"})]}),e.jsx(G,{size:"sm",className:"shrink-0 rounded-full",onClick:()=>t("messaging"),children:"Message"})]}),e.jsx("p",{className:"mt-2 text-[11px] uppercase tracking-[0.18em] text-muted-foreground capitalize",children:j})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsx(K,{children:"Le Quotidien"}),e.jsxs("button",{type:"button",onClick:c.action,className:"relative w-full overflow-hidden rounded-3xl text-white transition-all duration-200 active:scale-[0.97] bg-gradient-to-br from-primary via-primary/80 to-primary/60",children:[e.jsx("div",{className:"cta-glow absolute inset-0",style:{background:"radial-gradient(ellipse at 20% 60%, rgba(255,255,255,0.2) 0%, transparent 65%)"}}),e.jsx("div",{className:"cta-shimmer absolute top-0 bottom-0 left-0 w-1/3 pointer-events-none",style:{background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.12), transparent)"}}),e.jsxs("div",{className:"relative flex items-center gap-4 px-6 py-7",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-[1.6rem] font-bold leading-tight tracking-tight",children:c.label}),e.jsx("p",{className:"mt-1.5 text-sm opacity-75",children:c.detail})]}),e.jsx("div",{className:"flex h-14 w-14 shrink-0 items-center justify-center rounded-2xl bg-white/15 backdrop-blur-sm border border-white/20",children:e.jsx(J,{className:"h-7 w-7"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>t("objectives"),className:"flex items-center gap-2.5 rounded-2xl border bg-card px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-xl bg-amber-100 dark:bg-amber-900/30",children:e.jsx(H,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Objectifs"}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Temps cibles"})]})]}),e.jsxs("button",{type:"button",onClick:()=>t("messaging"),className:"flex items-center gap-2.5 rounded-2xl border bg-card px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-xl bg-blue-100 dark:bg-blue-900/30",children:e.jsx(Y,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Message"}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Notifier un groupe"})]})]})]})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsx(K,{children:"Tour de Contrôle"}),e.jsxs("div",{className:["rounded-3xl border p-4 space-y-3 transition-colors",w?"border-red-200 bg-red-50/70 dark:border-red-900/50 dark:bg-red-950/25":"bg-card border-border"].join(" "),children:[w&&!f&&e.jsx("div",{className:"space-y-1.5",children:d.map(n=>e.jsxs("button",{type:"button",onClick:()=>t("swimmers"),className:"flex w-full items-center gap-3 rounded-2xl bg-white/70 dark:bg-black/20 px-3.5 py-2.5 text-left transition-colors active:bg-white/90",children:[e.jsxs("span",{className:"relative flex h-3 w-3 shrink-0",children:[e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-red-400 opacity-60"}),e.jsx("span",{className:"relative inline-flex h-3 w-3 rounded-full bg-red-500"})]}),e.jsx("span",{className:"flex-1 text-sm font-semibold text-red-900 dark:text-red-200",children:n.athleteName}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-red-600 dark:text-red-400",children:"Fatigue max"}),e.jsx(z,{className:"h-3.5 w-3.5 text-red-400"})]},n.athleteName))}),e.jsxs("div",{className:"grid grid-cols-2 gap-2.5",children:[e.jsxs("div",{className:["rounded-2xl p-3.5",w?"bg-white/50 dark:bg-black/20":"bg-muted/40"].join(" "),children:[e.jsxs("div",{className:"mb-2 flex items-center gap-1.5",children:[e.jsx(Le,{className:`h-3.5 w-3.5 ${d.length>0?"text-red-500":"text-muted-foreground"}`}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-[0.18em] text-muted-foreground",children:"Alertes"})]}),e.jsx("p",{className:`text-4xl font-black tabular-nums leading-none ${d.length>0?"text-red-600 dark:text-red-400":"text-foreground"}`,children:f?"–":d.length}),e.jsx("p",{className:"mt-1.5 text-[11px] text-muted-foreground truncate",children:f?"Calcul…":d.length>0?d.slice(0,2).map(n=>n.athleteName.split(" ")[0]).join(", "):"Aucune alerte"})]}),e.jsxs("div",{className:["rounded-2xl p-3.5",w?"bg-white/50 dark:bg-black/20":"bg-muted/40"].join(" "),children:[e.jsxs("div",{className:"mb-2 flex items-center gap-1.5",children:[e.jsx(Se,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-[0.18em] text-muted-foreground",children:"Plus chargé"})]}),e.jsx("p",{className:"text-2xl font-black truncate leading-none",children:f?"–":D?.athleteName?.split(" ")[0]??"–"}),e.jsx("p",{className:"mt-1.5 text-[11px] text-muted-foreground",children:f?"Calcul…":D?`Charge ${Math.round(D.loadScore)}`:"Pas de données"})]})]})]})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-0.5",children:[e.jsx("span",{className:"text-[9px] font-black uppercase tracking-[0.28em] text-muted-foreground/70",children:"Nageurs"}),e.jsx("div",{className:"flex-1 h-px bg-border/50"}),k?e.jsx("button",{type:"button",onClick:()=>M(""),className:"text-[10px] font-bold text-primary",children:"Effacer"}):e.jsxs("button",{type:"button",onClick:()=>t("swimmers"),className:"flex items-center gap-0.5 text-[10px] font-bold text-primary",children:["Tous ",e.jsx(z,{className:"h-3 w-3"})]})]}),e.jsx("div",{className:"overflow-hidden rounded-3xl border bg-card shadow-sm",children:E?e.jsx("div",{className:"divide-y divide-border/60",children:[1,2,3,4].map(n=>e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3.5",children:[e.jsx("div",{className:"h-9 w-9 animate-pulse rounded-full bg-muted"}),e.jsxs("div",{className:"flex-1 space-y-1.5",children:[e.jsx("div",{className:"h-3.5 w-28 animate-pulse rounded bg-muted"}),e.jsx("div",{className:"h-3 w-18 animate-pulse rounded bg-muted"})]})]},n))}):R.length===0?e.jsx("p",{className:"px-4 py-8 text-center text-sm text-muted-foreground",children:"Aucun nageur trouvé."}):e.jsx("div",{className:"divide-y divide-border/60",children:R.map(n=>{const m=d.some(l=>l.athleteName===n.display_name),N=n.display_name.charAt(0).toUpperCase(),T=n.id!=null?v.get(n.id)??null:null;return e.jsxs("button",{type:"button",onClick:()=>s(n),className:"flex w-full items-center gap-3 px-4 py-3.5 text-left transition-colors active:bg-muted",children:[n.avatar_url?e.jsx("img",{src:n.avatar_url,alt:"",className:["h-9 w-9 shrink-0 rounded-full object-cover border",m?"border-red-400/60 ring-2 ring-red-400/60 ring-offset-1":"border-border"].join(" ")}):e.jsx("div",{className:["flex h-9 w-9 shrink-0 items-center justify-center rounded-full text-sm font-bold transition-all",m?"bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-400 ring-2 ring-red-400/60 ring-offset-1":"bg-primary/10 text-primary"].join(" "),children:N}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"truncate text-sm font-semibold",children:n.display_name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"truncate text-[11px] text-muted-foreground",children:n.group_label||"Sans groupe"}),T!=null&&e.jsx(Ve,{score:T})]})]}),m?e.jsxs("span",{className:"inline-flex shrink-0 items-center gap-1 rounded-full bg-red-100 px-2.5 py-1 text-[9px] font-black uppercase tracking-widest text-red-600 dark:bg-red-900/30 dark:text-red-400",children:[e.jsx("span",{className:"h-1.5 w-1.5 animate-pulse rounded-full bg-current"}),"Alerte"]}):e.jsx(z,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]},n.id??n.display_name)})})})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsx(K,{children:"Arsenal"}),e.jsxs("div",{className:"space-y-2 rounded-3xl border bg-card p-3 shadow-sm",children:[e.jsxs("button",{type:"button",onClick:()=>t("calendar"),className:"flex w-full items-center gap-3 rounded-2xl bg-muted/40 px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-9 w-9 shrink-0 items-center justify-center rounded-xl bg-violet-100 dark:bg-violet-900/30",children:e.jsx(U,{className:"h-4.5 w-4.5 text-violet-600 dark:text-violet-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Calendrier · Assigner"}),e.jsxs("p",{className:"text-[11px] text-muted-foreground",children:[P??0," séances nat · ",I??0," muscu"]})]}),e.jsx(z,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]}),e.jsx("div",{className:"grid grid-cols-4 gap-1.5",children:y.map(n=>e.jsxs("button",{type:"button",onClick:n.action,className:"flex flex-col items-center gap-1.5 rounded-2xl border bg-card px-1.5 py-3 text-center transition-colors active:bg-muted",children:[e.jsx(n.icon,{className:`h-4.5 w-4.5 ${n.color}`}),e.jsx("span",{className:"text-[9px] font-semibold leading-tight text-muted-foreground",children:n.label})]},n.label))}),e.jsxs("button",{type:"button",onClick:()=>t("swimmers"),className:"flex w-full items-center gap-3 rounded-2xl bg-muted/40 px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-9 w-9 shrink-0 items-center justify-center rounded-xl bg-blue-100 dark:bg-blue-900/30",children:e.jsx(ne,{className:"h-4.5 w-4.5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Voir tous les nageurs"}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:E?"Chargement…":`${r.length} nageur${r.length>1?"s":""}`})]}),e.jsx(z,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]})]})]})]})},te=t=>t.toISOString().split("T")[0],He=t=>new Date(t.completed_at||t.started_at||t.date||t.created_at||0).getTime(),Ke=t=>{if(!t.length)return null;const h=t.reduce((s,r)=>s+r,0)/t.length,p=Math.min(5,Math.max(1,Math.round(h)));return{average:h,rating:p}};function Ue(){const t=Z(l=>l.role),h=Z(l=>l.setSelectedAthlete),[,p]=ge(),[s,r]=a.useState(()=>window.location.hash.match(/[?&]section=([^&]+)/)?.[1]||"home"),E=7,[f,d]=a.useState(null),[D,v]=a.useState(null),[P,I]=a.useState("swim");a.useEffect(()=>{const l="/coach",g=s&&s!=="home"?`#${l}?section=${s}`:`#${l}`;window.location.hash!==g&&window.history.replaceState(null,"",g)},[s]),a.useEffect(()=>{const l=()=>{r("home"),d(null)};return window.addEventListener("nav:reset",l),()=>window.removeEventListener("nav:reset",l)},[]),a.useEffect(()=>{const l=g=>{const B=g.detail;r(B),d(null)};return window.addEventListener("nav:section",l),()=>window.removeEventListener("nav:section",l)},[]);const j=t==="coach"||t==="admin",k=s==="home"||s==="calendar",M=s==="home"||s==="messaging"||s==="sms"||s==="swimmers"||s==="athlete"||s==="calendar"||s==="groups"||s==="objectives",_=s==="swim"||s==="messaging"||s==="sms"||s==="calendar"||s==="groups"||s==="training-slots",{data:R}=F({queryKey:["swim_catalog"],queryFn:()=>L.getSwimCatalog(),enabled:j&&k}),{data:w}=F({queryKey:["strength_catalog"],queryFn:()=>L.getStrengthSessions(),enabled:j&&k}),{data:c=[],isLoading:y}=F({queryKey:["athletes"],queryFn:()=>L.getAthletes(),enabled:j&&M}),n=a.useMemo(()=>c.slice(0,5),[c]),{data:m=[]}=F({queryKey:["groups"],queryFn:()=>L.getGroups(),enabled:j&&_}),N=F({queryKey:["coach-kpis",E,n.map(l=>l.id??l.display_name)],enabled:j&&s==="home"&&n.length>0,queryFn:async()=>{const l=E,g=new Date;g.setDate(g.getDate()-l);const B=te(g),re=te(new Date),q=await Promise.all(n.map(async o=>{const[V,oe]=await Promise.all([L.getSessions(o.display_name,o.id),L.getStrengthHistory(o.display_name,{athleteId:o.id,limit:50,from:B,to:re})]),$=V.filter(i=>new Date(i.date).getTime()>=g.getTime()),ce=$.map(i=>i.fatigue??i.feeling).filter(i=>Number.isFinite(i)),de=$.reduce((i,u)=>i+(Number(u.duration)||0)*(Number(u.effort)||0),0),Q=(oe?.runs??[]).filter(i=>He(i)>=g.getTime()),me=Q.map(i=>i.fatigue??i.feeling??i.rpe).filter(i=>Number.isFinite(Number(i))).map(i=>Number(i)),ue=Q.reduce((i,u)=>{const C=Number(u.feeling??u.rpe??0),A=Number(u.duration??0);if(A>0&&C>0)return i+A*C;const O=Array.isArray(u.logs)?u.logs.length:0;return i+O*5},0),xe=Ke([...ce,...me]),S=$[0];let W=null;if(S){const i=[],u=S.effort,C=S.fatigue??S.feeling,A=S.performance,O=S.engagement;u!=null&&Number.isFinite(u)&&i.push(6-u),C!=null&&Number.isFinite(C)&&i.push(6-C),A!=null&&Number.isFinite(A)&&i.push(A),O!=null&&Number.isFinite(O)&&i.push(O),i.length>0&&(W=Math.round(i.reduce((he,pe)=>he+pe,0)/i.length*10)/10)}return{athleteId:o.id,athleteName:o.display_name,loadScore:de+ue,fatigueRating:xe,formeScore:W}})),le=q.filter(o=>o.fatigueRating?.rating===5).map(o=>({athleteName:o.athleteName,rating:o.fatigueRating?.rating??0})),ie=q.filter(o=>o.loadScore>0).sort((o,V)=>V.loadScore-o.loadScore)[0],X=new Map;for(const o of q)o.athleteId!=null&&X.set(o.athleteId,o.formeScore);return{fatigueAlerts:le,mostLoadedAthlete:ie??null,formeScores:X}}}),T=l=>{if(h({id:l.id??null,name:l.display_name}),l.id==null){p("/progress");return}d(l),r("athlete")};return j?e.jsxs("div",{className:"space-y-6",children:[s==="home"?e.jsx($e,{onNavigate:r,onOpenRecordsAdmin:()=>p("/records-admin"),onOpenRecordsClub:()=>p("/records-club"),onOpenAthlete:T,athletes:c,athletesLoading:y,kpiLoading:N.isLoading,fatigueAlerts:N.data?.fatigueAlerts??[],mostLoadedAthlete:N.data?.mostLoadedAthlete??null,formeScores:N.data?.formeScores??new Map,swimSessionCount:R?.length,strengthSessionCount:w?.length}):null,s==="swim"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(se,{onBack:()=>r("home"),onOpenLibrary:l=>{I("swim"),v(l??null),r("swim-library")},groups:m})}):null,s==="swim-library"?e.jsxs("div",{className:"space-y-6",children:[e.jsx(ee,{title:"Bibliothèque natation",description:"Templates de séances.",onBack:()=>{v(null),r(P)}}),e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(qe,{entryContext:D,onEntryContextConsumed:()=>v(null)})})]}):null,s==="strength"?e.jsxs("div",{className:"space-y-6",children:[e.jsx(ee,{title:"Bibliothèque musculation",description:"Consultez et créez des séances musculation.",onBack:()=>r("home"),actions:e.jsxs(G,{variant:"outline",size:"sm",onClick:()=>r("calendar"),children:[e.jsx(U,{className:"mr-1.5 h-3.5 w-3.5"}),"Assigner"]})}),e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Be,{})})]}):null,s==="swimmers"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Re,{athletes:c,athletesLoading:y,onBack:()=>r("home"),onOpenAthlete:T})}):null,s==="athlete"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Pe,{athleteId:f?.id??null,athleteName:f?.display_name??null,onBack:()=>r("home")})}):null,s==="messaging"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Te,{onBack:()=>r("home"),athletes:c,groups:m,athletesLoading:y})}):null,s==="sms"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Oe,{onBack:()=>r("home"),athletes:c,groups:m,athletesLoading:y})}):null,s==="calendar"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Fe,{onBack:()=>r("home"),athletes:c,groups:m,swimSessions:R,strengthSessions:w})}):null,s==="groups"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(ze,{onBack:()=>r("home"),athletes:c,groups:m,athletesLoading:y})}):null,s==="competitions"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Ie,{onBack:()=>r("home")})}):null,s==="objectives"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Me,{onBack:()=>r("home"),athletes:c,athletesLoading:y})}):null,s==="training-slots"?e.jsx(a.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(se,{onBack:()=>r("home"),groups:m,onOpenLibrary:l=>{I("training-slots"),v(l??null),r("swim-library")}})}):null]}):e.jsx("div",{className:"flex items-center justify-center min-h-[60vh] animate-in fade-in motion-reduce:animate-none",children:e.jsxs(be,{className:"w-full max-w-sm shadow-xl border-t-4 border-t-primary",children:[e.jsxs(fe,{children:[e.jsxs(je,{className:"flex items-center gap-2 uppercase italic",children:[e.jsx(ne,{className:"h-5 w-5 text-primary"}),"Accès Coach"]}),e.jsx(ye,{children:"Cette section est réservée aux coachs et administrateurs."})]}),e.jsx(Ne,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Connectez-vous avec un compte autorisé pour accéder aux outils de gestion."})})]})})}const ns=Object.freeze(Object.defineProperty({__proto__:null,default:Ue},Symbol.toStringTag,{value:"Module"}));export{ee as C,De as U,ns as a};
