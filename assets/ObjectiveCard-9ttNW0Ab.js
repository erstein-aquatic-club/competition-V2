import{j as n}from"./vendor-query-DyA9aSKS.js";import{B as N}from"./badge-D4Rs7Ty5.js";const E=["50NL","100NL","200NL","400NL","800NL","1500NL","50DOS","100DOS","200DOS","50BR","100BR","200BR","50PAP","100PAP","200PAP","200QN","400QN"];function f(t){const e=t.match(/^(\d+)(NL|DOS|BR|PAP|QN)$/);if(!e)return t;const s={NL:"Nage Libre",DOS:"Dos",BR:"Brasse",PAP:"Papillon",QN:"4 Nages"};return`${e[1]}m ${s[e[2]]||e[2]}`}function x(t){const e=Math.floor(t/60),s=t%60,l=Math.floor(s),o=Math.round((s-l)*100);return`${e}:${String(l).padStart(2,"0")}:${String(o).padStart(2,"0")}`}function w(t){const e=t.match(/^(\d+):(\d{2})[.::](\d{2})$/);return e?parseInt(e[1])*60+parseInt(e[2])+parseInt(e[3])/100:null}const P={"50NL":["50 NL","50 Nage Libre"],"100NL":["100 NL","100 Nage Libre"],"200NL":["200 NL","200 Nage Libre"],"400NL":["400 NL","400 Nage Libre"],"800NL":["800 NL","800 Nage Libre"],"1500NL":["1500 NL","1500 Nage Libre"],"50DOS":["50 Dos"],"100DOS":["100 Dos"],"200DOS":["200 Dos"],"50BR":["50 Brasse","50 Bra."],"100BR":["100 Brasse","100 Bra."],"200BR":["200 Brasse","200 Bra."],"50PAP":["50 Papillon","50 Pap","50 Pap."],"100PAP":["100 Papillon","100 Pap","100 Pap."],"200PAP":["200 Papillon","200 Pap","200 Pap."],"200QN":["200 4 Nages","200 4N","200 4 N."],"400QN":["400 4 Nages","400 4N","400 4 N."]};function L(t){const e=t.match(/^(\d+)(NL|DOS|BR|PAP|QN)$/);return e?e[2]:null}const B={50:1,100:4,200:10,400:15,800:30,1500:45};function D(t){const e=t.match(/^(\d+)(NL|DOS|BR|PAP|QN)$/);return e?Number(e[1]):null}function S(t,e,s){if(t<=e)return 100;const l=D(s),o=l?B[l]??10:10,a=e+o;return t>=a?0:Math.round((a-t)/(a-e)*100)}function y(t,e,s){const l=P[e];if(!l)return null;const o=l.map(r=>r.toLowerCase());let a=null;for(const r of t)r.time_seconds!=null&&o.includes(r.event_code.toLowerCase())&&(s!=null&&r.pool_length!=null&&r.pool_length!==s||(a===null||r.time_seconds<a.time)&&(a={time:r.time_seconds,date:r.competition_date??null}));return a}function A(t){const e=new Date;e.setHours(0,0,0,0);const s=new Date(t+"T00:00:00");return Math.ceil((s.getTime()-e.getTime())/(1e3*60*60*24))}const O={NL:"#3b82f6",DOS:"#10b981",BR:"#f43f5e",PAP:"#8b5cf6",QN:"#f59e0b"},h="#a1a1aa";function g({size:t=36,strokeWidth:e=3,progress:s,color:l}){const o=(t-e)/2,a=2*Math.PI*o,r=s!=null?Math.min(Math.max(s,0),100):0,m=a-r/100*a;return n.jsxs("svg",{width:t,height:t,viewBox:`0 0 ${t} ${t}`,className:"shrink-0","aria-hidden":!0,children:[n.jsx("circle",{cx:t/2,cy:t/2,r:o,fill:"none",stroke:"currentColor",strokeWidth:e,className:"text-muted-foreground/10"}),s!=null&&n.jsx("circle",{cx:t/2,cy:t/2,r:o,fill:"none",stroke:l,strokeWidth:e,strokeDasharray:a,strokeDashoffset:m,strokeLinecap:"round",transform:`rotate(-90 ${t/2} ${t/2})`,className:"transition-all duration-700"}),s==null&&n.jsx("circle",{cx:t/2,cy:t/2,r:3,fill:l})]})}function k({objective:t,performances:e=[],onClick:s,compact:l=!1,showCoachBadge:o=!1}){const a=!!t.event_code,r=a?L(t.event_code):null,m=r?O[r]??h:h,i=a?y(e,t.event_code,t.pool_length):null;let c=null,d=null;i&&t.target_time_seconds!=null&&t.event_code&&(c=i.time-t.target_time_seconds,d=S(i.time,t.target_time_seconds,t.event_code));const _=!!t.competition_name,u=t.competition_date?A(t.competition_date):null,p=s?"button":"div";return l?n.jsxs(p,{type:s?"button":void 0,className:"w-full text-left flex items-center gap-2.5 rounded-lg px-2 py-1.5 transition-colors hover:bg-muted/40 active:scale-[0.995]",onClick:s,children:[n.jsx(g,{size:24,strokeWidth:2.5,progress:d,color:m}),n.jsxs("div",{className:"flex-1 min-w-0 flex items-baseline gap-1.5",children:[n.jsx("span",{className:"text-xs font-semibold truncate",children:a?f(t.event_code):t.text??"—"}),a&&t.pool_length&&n.jsxs("span",{className:"text-[10px] text-muted-foreground/50 shrink-0",children:[t.pool_length,"m"]})]}),t.target_time_seconds!=null&&n.jsx("span",{className:"text-[11px] font-mono tabular-nums text-primary shrink-0",children:x(t.target_time_seconds)}),c!=null&&n.jsx("span",{className:`text-[10px] font-mono tabular-nums shrink-0 ${c<=0?"text-emerald-500 font-semibold":"text-muted-foreground/60"}`,children:c<=0?"OK":`+${c.toFixed(1)}`}),o&&n.jsx(N,{variant:"secondary",className:"text-[8px] px-1 py-0 leading-tight shrink-0",children:"C"})]}):n.jsxs(p,{type:s?"button":void 0,className:"w-full text-left flex items-start gap-3 rounded-xl px-3 py-3 transition-colors hover:bg-muted/30 active:scale-[0.995]",onClick:s,children:[n.jsx("div",{className:"pt-0.5",children:n.jsx(g,{size:36,strokeWidth:3,progress:d,color:m})}),n.jsxs("div",{className:"flex-1 min-w-0 space-y-0.5",children:[n.jsxs("div",{className:"flex items-baseline gap-2 min-w-0",children:[n.jsx("span",{className:"text-sm font-semibold truncate",children:a?f(t.event_code):t.text?"Objectif":"—"}),a&&t.pool_length&&n.jsxs("span",{className:"text-xs text-muted-foreground/50 shrink-0",children:[t.pool_length,"m"]}),o&&n.jsx(N,{variant:"secondary",className:"text-[9px] px-1 py-0 leading-tight ml-auto shrink-0",children:"Coach"})]}),t.text&&a&&n.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:t.text}),t.target_time_seconds!=null&&n.jsxs("div",{className:"flex items-baseline gap-2 font-mono tabular-nums text-xs mt-1",children:[n.jsx("span",{className:"text-primary font-medium",children:x(t.target_time_seconds)}),i&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-muted-foreground/40",children:"→"}),n.jsx("span",{className:"text-muted-foreground",children:x(i.time)}),c!=null&&n.jsx("span",{className:c<=0?"text-emerald-500 font-semibold":"text-muted-foreground/50",children:c<=0?"Atteint":`+${c.toFixed(1)}s`})]})]}),a&&t.target_time_seconds!=null&&!i&&e.length>0&&n.jsx("p",{className:"text-[10px] text-muted-foreground/40 mt-0.5 italic",children:"Pas encore de temps"}),!a&&t.text&&n.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:t.text}),_&&n.jsxs("p",{className:"text-[10px] text-muted-foreground/50 mt-0.5",children:[t.competition_name,u!=null&&u>0&&n.jsxs("span",{children:[" · J-",u]})]})]})]})}export{E as F,k as O,f as e,x as f,w as p};
