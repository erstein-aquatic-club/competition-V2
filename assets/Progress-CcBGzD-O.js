import{R as g,c as _e,r as X,u as en,a as Ge,j as i,S as ft,b as pt,d as mt,e as ht,f as ce,C as L,g as R,h as I,i as M,B as tn,k as ke}from"./index-ctSa7tft.js";import{u as nn}from"./useInfiniteQuery-CW5qz_PJ.js";import{T as rn,a as an,b as Ze,c as ue,d as on,e as ie}from"./table-Di8K8j1M.js";import{T as sn,a as ln,b as yt,c as vt}from"./tabs-Bvtjihss.js";import{s as $e}from"./score-CwBbkHfb.js";import{B as Ot}from"./badge-DLZmQGUg.js";import{t as Nt,c as cn,s as un,f as be}from"./format-B9mPVj_w.js";import{i as De,D as _t,f as at,E as Dt,L as H,a as W,C as Se,A as it,b as K,c as Te,d as Q,h as Et,e as ot,g as re,u as st,G as lt,j as me,m as Ce,k as fe,l as dn,S as gt,n as fn,o as pn,p as mn,q as kt,r as Ct,X as oe,Y as Le,s as $t,B as pe,R as je,t as Qe,v as Ae,T as Pe}from"./BarChart-JbC4gTGs.js";var hn=["type","layout","connectNulls","ref"],yn=["key"];function he(e){"@babel/helpers - typeof";return he=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},he(e)}function xt(e,t){if(e==null)return{};var r=vn(e,t),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function vn(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function we(){return we=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},we.apply(this,arguments)}function bt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bt(Object(r),!0).forEach(function(n){Z(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bt(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function de(e){return jn(e)||bn(e)||xn(e)||gn()}function gn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xn(e,t){if(e){if(typeof e=="string")return Je(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Je(e,t)}}function bn(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function jn(e){if(Array.isArray(e))return Je(e)}function Je(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function An(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Lt(n.key),n)}}function Pn(e,t,r){return t&&jt(e.prototype,t),r&&jt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sn(e,t,r){return t=Re(t),wn(e,Tt()?Reflect.construct(t,r||[],Re(e).constructor):t.apply(e,r))}function wn(e,t){if(t&&(he(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return On(e)}function On(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Tt=function(){return!!e})()}function Re(e){return Re=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Re(e)}function Nn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&et(e,t)}function et(e,t){return et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},et(e,t)}function Z(e,t,r){return t=Lt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lt(e){var t=_n(e,"string");return he(t)=="symbol"?t:t+""}function _n(e,t){if(he(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(he(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ae=(function(e){function t(){var r;An(this,t);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return r=Sn(this,t,[].concat(a)),Z(r,"state",{isAnimationFinished:!0,totalLength:0}),Z(r,"generateSimpleStrokeDasharray",function(s,c){return"".concat(c,"px ").concat(s-c,"px")}),Z(r,"getStrokeDasharray",function(s,c,u){var d=u.reduce(function(b,P){return b+P});if(!d)return r.generateSimpleStrokeDasharray(c,s);for(var p=Math.floor(s/d),f=s%d,m=c-s,h=[],y=0,v=0;y<u.length;v+=u[y],++y)if(v+u[y]>f){h=[].concat(de(u.slice(0,y)),[f-v]);break}var x=h.length%2===0?[0,m]:[m];return[].concat(de(t.repeat(u,p)),de(h),x).map(function(b){return"".concat(b,"px")}).join(", ")}),Z(r,"id",st("recharts-line-")),Z(r,"pathRef",function(s){r.mainCurve=s}),Z(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),Z(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return Nn(t,e),Pn(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,s=o.points,c=o.xAxis,u=o.yAxis,d=o.layout,p=o.children,f=at(p,Dt);if(!f)return null;var m=function(v,x){return{x:v.x,y:v.y,value:v.value,errorVal:re(v.payload,x)}},h={clipPath:n?"url(#clipPath-".concat(a,")"):null};return g.createElement(H,h,f.map(function(y){return g.cloneElement(y,{key:"bar-".concat(y.props.dataKey),data:s,xAxis:c,yAxis:u,layout:d,dataPointFormatter:m})}))}},{key:"renderDots",value:function(n,a,o){var s=this.props.isAnimationActive;if(s&&!this.state.isAnimationFinished)return null;var c=this.props,u=c.dot,d=c.points,p=c.dataKey,f=W(this.props,!1),m=W(u,!0),h=d.map(function(v,x){var b=V(V(V({key:"dot-".concat(x),r:3},f),m),{},{index:x,cx:v.x,cy:v.y,value:v.value,dataKey:p,payload:v.payload,points:d});return t.renderDotItem(u,b)}),y={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(o,")"):null};return g.createElement(H,we({className:"recharts-line-dots",key:"dots"},y),h)}},{key:"renderCurveStatically",value:function(n,a,o,s){var c=this.props,u=c.type,d=c.layout,p=c.connectNulls;c.ref;var f=xt(c,hn),m=V(V(V({},W(f,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(o,")"):null,points:n},s),{},{type:u,layout:d,connectNulls:p});return g.createElement(Se,we({},m,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var o=this,s=this.props,c=s.points,u=s.strokeDasharray,d=s.isAnimationActive,p=s.animationBegin,f=s.animationDuration,m=s.animationEasing,h=s.animationId,y=s.animateNewValues,v=s.width,x=s.height,b=this.state,P=b.prevPoints,A=b.totalLength;return g.createElement(it,{begin:p,duration:f,isActive:d,easing:m,from:{t:0},to:{t:1},key:"line-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(j){var S=j.t;if(P){var N=P.length/c.length,_=c.map(function(D,Y){var G=Math.floor(Y*N);if(P[G]){var B=P[G],E=K(B.x,D.x),ze=K(B.y,D.y);return V(V({},D),{},{x:E(S),y:ze(S)})}if(y){var Ve=K(v*2,D.x),We=K(x/2,D.y);return V(V({},D),{},{x:Ve(S),y:We(S)})}return V(V({},D),{},{x:D.x,y:D.y})});return o.renderCurveStatically(_,n,a)}var k=K(0,A),$=k(S),C;if(u){var T="".concat(u).split(/[,\s]+/gim).map(function(D){return parseFloat(D)});C=o.getStrokeDasharray($,A,T)}else C=o.generateSimpleStrokeDasharray(A,$);return o.renderCurveStatically(c,n,a,{strokeDasharray:C})})}},{key:"renderCurve",value:function(n,a){var o=this.props,s=o.points,c=o.isAnimationActive,u=this.state,d=u.prevPoints,p=u.totalLength;return c&&s&&s.length&&(!d&&p>0||!Te(d,s))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(s,n,a)}},{key:"render",value:function(){var n,a=this.props,o=a.hide,s=a.dot,c=a.points,u=a.className,d=a.xAxis,p=a.yAxis,f=a.top,m=a.left,h=a.width,y=a.height,v=a.isAnimationActive,x=a.id;if(o||!c||!c.length)return null;var b=this.state.isAnimationFinished,P=c.length===1,A=_e("recharts-line",u),j=d&&d.allowDataOverflow,S=p&&p.allowDataOverflow,N=j||S,_=Q(x)?this.id:x,k=(n=W(s,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},$=k.r,C=$===void 0?3:$,T=k.strokeWidth,D=T===void 0?2:T,Y=Et(s)?s:{},G=Y.clipDot,B=G===void 0?!0:G,E=C*2+D;return g.createElement(H,{className:A},j||S?g.createElement("defs",null,g.createElement("clipPath",{id:"clipPath-".concat(_)},g.createElement("rect",{x:j?m:m-h/2,y:S?f:f-y/2,width:j?h:h*2,height:S?y:y*2})),!B&&g.createElement("clipPath",{id:"clipPath-dots-".concat(_)},g.createElement("rect",{x:m-E/2,y:f-E/2,width:h+E,height:y+E}))):null,!P&&this.renderCurve(N,_),this.renderErrorBar(N,_),(P||s)&&this.renderDots(N,B,_),(!v||b)&&ot.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var o=n.length%2!==0?[].concat(de(n),[0]):n,s=[],c=0;c<a;++c)s=[].concat(de(s),de(o));return s}},{key:"renderDotItem",value:function(n,a){var o;if(g.isValidElement(n))o=g.cloneElement(n,a);else if(De(n))o=n(a);else{var s=a.key,c=xt(a,yn),u=_e("recharts-line-dot",typeof n!="boolean"?n.className:"");o=g.createElement(_t,we({key:s},c,{className:u}))}return o}}])})(X.PureComponent);Z(ae,"displayName","Line");Z(ae,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!lt.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Z(ae,"getComposedData",function(e){var t=e.props,r=e.xAxis,n=e.yAxis,a=e.xAxisTicks,o=e.yAxisTicks,s=e.dataKey,c=e.bandSize,u=e.displayedData,d=e.offset,p=t.layout,f=u.map(function(m,h){var y=re(m,s);return p==="horizontal"?{x:me({axis:r,ticks:a,bandSize:c,entry:m,index:h}),y:Q(y)?null:n.scale(y),value:y,payload:m}:{x:Q(y)?null:r.scale(y),y:me({axis:n,ticks:o,bandSize:c,entry:m,index:h}),value:y,payload:m}});return V({points:f,layout:p},d)});var Dn=["layout","type","stroke","connectNulls","isRange","ref"],En=["key"],Rt;function ye(e){"@babel/helpers - typeof";return ye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ye(e)}function It(e,t){if(e==null)return{};var r=kn(e,t),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function kn(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function se(){return se=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},se.apply(this,arguments)}function At(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?At(Object(r),!0).forEach(function(n){J(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):At(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kt(n.key),n)}}function $n(e,t,r){return t&&Pt(e.prototype,t),r&&Pt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tn(e,t,r){return t=Ie(t),Ln(e,Mt()?Reflect.construct(t,r||[],Ie(e).constructor):t.apply(e,r))}function Ln(e,t){if(t&&(ye(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rn(e)}function Rn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Mt=function(){return!!e})()}function Ie(e){return Ie=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ie(e)}function In(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tt(e,t)}function tt(e,t){return tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},tt(e,t)}function J(e,t,r){return t=Kt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kt(e){var t=Mn(e,"string");return ye(t)=="symbol"?t:t+""}function Mn(e,t){if(ye(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ye(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var le=(function(e){function t(){var r;Cn(this,t);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return r=Tn(this,t,[].concat(a)),J(r,"state",{isAnimationFinished:!0}),J(r,"id",st("recharts-area-")),J(r,"handleAnimationEnd",function(){var s=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),De(s)&&s()}),J(r,"handleAnimationStart",function(){var s=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),De(s)&&s()}),r}return In(t,e),$n(t,[{key:"renderDots",value:function(n,a,o){var s=this.props.isAnimationActive,c=this.state.isAnimationFinished;if(s&&!c)return null;var u=this.props,d=u.dot,p=u.points,f=u.dataKey,m=W(this.props,!1),h=W(d,!0),y=p.map(function(x,b){var P=te(te(te({key:"dot-".concat(b),r:3},m),h),{},{index:b,cx:x.x,cy:x.y,dataKey:f,value:x.value,payload:x.payload,points:p});return t.renderDotItem(d,P)}),v={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(o,")"):null};return g.createElement(H,se({className:"recharts-area-dots"},v),y)}},{key:"renderHorizontalRect",value:function(n){var a=this.props,o=a.baseLine,s=a.points,c=a.strokeWidth,u=s[0].x,d=s[s.length-1].x,p=n*Math.abs(u-d),f=Ce(s.map(function(m){return m.y||0}));return fe(o)&&typeof o=="number"?f=Math.max(o,f):o&&Array.isArray(o)&&o.length&&(f=Math.max(Ce(o.map(function(m){return m.y||0})),f)),fe(f)?g.createElement("rect",{x:u<d?u:u-p,y:0,width:p,height:Math.floor(f+(c?parseInt("".concat(c),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var a=this.props,o=a.baseLine,s=a.points,c=a.strokeWidth,u=s[0].y,d=s[s.length-1].y,p=n*Math.abs(u-d),f=Ce(s.map(function(m){return m.x||0}));return fe(o)&&typeof o=="number"?f=Math.max(o,f):o&&Array.isArray(o)&&o.length&&(f=Math.max(Ce(o.map(function(m){return m.x||0})),f)),fe(f)?g.createElement("rect",{x:0,y:u<d?u:u-p,width:f+(c?parseInt("".concat(c),10):1),height:Math.floor(p)}):null}},{key:"renderClipRect",value:function(n){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,a,o,s){var c=this.props,u=c.layout,d=c.type,p=c.stroke,f=c.connectNulls,m=c.isRange;c.ref;var h=It(c,Dn);return g.createElement(H,{clipPath:o?"url(#clipPath-".concat(s,")"):null},g.createElement(Se,se({},W(h,!0),{points:n,connectNulls:f,type:d,baseLine:a,layout:u,stroke:"none",className:"recharts-area-area"})),p!=="none"&&g.createElement(Se,se({},W(this.props,!1),{className:"recharts-area-curve",layout:u,type:d,connectNulls:f,fill:"none",points:n})),p!=="none"&&m&&g.createElement(Se,se({},W(this.props,!1),{className:"recharts-area-curve",layout:u,type:d,connectNulls:f,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(n,a){var o=this,s=this.props,c=s.points,u=s.baseLine,d=s.isAnimationActive,p=s.animationBegin,f=s.animationDuration,m=s.animationEasing,h=s.animationId,y=this.state,v=y.prevPoints,x=y.prevBaseLine;return g.createElement(it,{begin:p,duration:f,isActive:d,easing:m,from:{t:0},to:{t:1},key:"area-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(b){var P=b.t;if(v){var A=v.length/c.length,j=c.map(function(k,$){var C=Math.floor($*A);if(v[C]){var T=v[C],D=K(T.x,k.x),Y=K(T.y,k.y);return te(te({},k),{},{x:D(P),y:Y(P)})}return k}),S;if(fe(u)&&typeof u=="number"){var N=K(x,u);S=N(P)}else if(Q(u)||dn(u)){var _=K(x,0);S=_(P)}else S=u.map(function(k,$){var C=Math.floor($*A);if(x[C]){var T=x[C],D=K(T.x,k.x),Y=K(T.y,k.y);return te(te({},k),{},{x:D(P),y:Y(P)})}return k});return o.renderAreaStatically(j,S,n,a)}return g.createElement(H,null,g.createElement("defs",null,g.createElement("clipPath",{id:"animationClipPath-".concat(a)},o.renderClipRect(P))),g.createElement(H,{clipPath:"url(#animationClipPath-".concat(a,")")},o.renderAreaStatically(c,u,n,a)))})}},{key:"renderArea",value:function(n,a){var o=this.props,s=o.points,c=o.baseLine,u=o.isAnimationActive,d=this.state,p=d.prevPoints,f=d.prevBaseLine,m=d.totalLength;return u&&s&&s.length&&(!p&&m>0||!Te(p,s)||!Te(f,c))?this.renderAreaWithAnimation(n,a):this.renderAreaStatically(s,c,n,a)}},{key:"render",value:function(){var n,a=this.props,o=a.hide,s=a.dot,c=a.points,u=a.className,d=a.top,p=a.left,f=a.xAxis,m=a.yAxis,h=a.width,y=a.height,v=a.isAnimationActive,x=a.id;if(o||!c||!c.length)return null;var b=this.state.isAnimationFinished,P=c.length===1,A=_e("recharts-area",u),j=f&&f.allowDataOverflow,S=m&&m.allowDataOverflow,N=j||S,_=Q(x)?this.id:x,k=(n=W(s,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},$=k.r,C=$===void 0?3:$,T=k.strokeWidth,D=T===void 0?2:T,Y=Et(s)?s:{},G=Y.clipDot,B=G===void 0?!0:G,E=C*2+D;return g.createElement(H,{className:A},j||S?g.createElement("defs",null,g.createElement("clipPath",{id:"clipPath-".concat(_)},g.createElement("rect",{x:j?p:p-h/2,y:S?d:d-y/2,width:j?h:h*2,height:S?y:y*2})),!B&&g.createElement("clipPath",{id:"clipPath-dots-".concat(_)},g.createElement("rect",{x:p-E/2,y:d-E/2,width:h+E,height:y+E}))):null,P?null:this.renderArea(N,_),(s||P)&&this.renderDots(N,B,_),(!v||b)&&ot.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:n.points!==a.curPoints||n.baseLine!==a.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])})(X.PureComponent);Rt=le;J(le,"displayName","Area");J(le,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!lt.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});J(le,"getBaseValue",function(e,t,r,n){var a=e.layout,o=e.baseValue,s=t.props.baseValue,c=s??o;if(fe(c)&&typeof c=="number")return c;var u=a==="horizontal"?n:r,d=u.scale.domain();if(u.type==="number"){var p=Math.max(d[0],d[1]),f=Math.min(d[0],d[1]);return c==="dataMin"?f:c==="dataMax"||p<0?p:Math.max(Math.min(d[0],d[1]),0)}return c==="dataMin"?d[0]:c==="dataMax"?d[1]:d[0]});J(le,"getComposedData",function(e){var t=e.props,r=e.item,n=e.xAxis,a=e.yAxis,o=e.xAxisTicks,s=e.yAxisTicks,c=e.bandSize,u=e.dataKey,d=e.stackedData,p=e.dataStartIndex,f=e.displayedData,m=e.offset,h=t.layout,y=d&&d.length,v=Rt.getBaseValue(t,r,n,a),x=h==="horizontal",b=!1,P=f.map(function(j,S){var N;y?N=d[p+S]:(N=re(j,u),Array.isArray(N)?b=!0:N=[v,N]);var _=N[1]==null||y&&re(j,u)==null;return x?{x:me({axis:n,ticks:o,bandSize:c,entry:j,index:S}),y:_?null:a.scale(N[1]),value:N,payload:j}:{x:_?null:n.scale(N[1]),y:me({axis:a,ticks:s,bandSize:c,entry:j,index:S}),value:N,payload:j}}),A;return y||b?A=P.map(function(j){var S=Array.isArray(j.value)?j.value[0]:null;return x?{x:j.x,y:S!=null&&j.y!=null?a.scale(S):null}:{x:S!=null?n.scale(S):null,y:j.y}}):A=x?a.scale(v):n.scale(v),te({points:P,baseLine:A,layout:h,isRange:b},m)});J(le,"renderDotItem",function(e,t){var r;if(g.isValidElement(e))r=g.cloneElement(e,t);else if(De(e))r=e(t);else{var n=_e("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,o=It(t,En);r=g.createElement(_t,se({},o,{key:a,className:n}))}return r});function ve(e){"@babel/helpers - typeof";return ve=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ve(e)}function Kn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zt(n.key),n)}}function Fn(e,t,r){return t&&Bn(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function zn(e,t,r){return t=Me(t),Vn(e,Bt()?Reflect.construct(t,r||[],Me(e).constructor):t.apply(e,r))}function Vn(e,t){if(t&&(ve(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wn(e)}function Wn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Bt=function(){return!!e})()}function Me(e){return Me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Me(e)}function Hn(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nt(e,t)}function nt(e,t){return nt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},nt(e,t)}function Ft(e,t,r){return t=zt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zt(e){var t=qn(e,"string");return ve(t)=="symbol"?t:t+""}function qn(e,t){if(ve(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ve(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Be=(function(e){function t(){return Kn(this,t),zn(this,t,arguments)}return Hn(t,e),Fn(t,[{key:"render",value:function(){return null}}])})(X.Component);Ft(Be,"displayName","ZAxis");Ft(Be,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var Xn=["option","isActive"];function Oe(){return Oe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Oe.apply(this,arguments)}function Yn(e,t){if(e==null)return{};var r=Gn(e,t),n,a;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Gn(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Zn(e){var t=e.option,r=e.isActive,n=Yn(e,Xn);return typeof t=="string"?X.createElement(gt,Oe({option:X.createElement(fn,Oe({type:t},n)),isActive:r,shapeType:"symbols"},n)):X.createElement(gt,Oe({option:t,isActive:r,shapeType:"symbols"},n))}function ge(e){"@babel/helpers - typeof";return ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ge(e)}function Ne(){return Ne=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ne.apply(this,arguments)}function St(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?St(Object(r),!0).forEach(function(n){ne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):St(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Qn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wt(n.key),n)}}function Un(e,t,r){return t&&wt(e.prototype,t),r&&wt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Jn(e,t,r){return t=Ke(t),er(e,Vt()?Reflect.construct(t,r||[],Ke(e).constructor):t.apply(e,r))}function er(e,t){if(t&&(ge(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tr(e)}function tr(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Vt=function(){return!!e})()}function Ke(e){return Ke=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ke(e)}function nr(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rt(e,t)}function rt(e,t){return rt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},rt(e,t)}function ne(e,t,r){return t=Wt(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wt(e){var t=rr(e,"string");return ge(t)=="symbol"?t:t+""}function rr(e,t){if(ge(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ge(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Fe=(function(e){function t(){var r;Qn(this,t);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return r=Jn(this,t,[].concat(a)),ne(r,"state",{isAnimationFinished:!1}),ne(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0})}),ne(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1})}),ne(r,"id",st("recharts-scatter-")),r}return nr(t,e),Un(t,[{key:"renderSymbolsStatically",value:function(n){var a=this,o=this.props,s=o.shape,c=o.activeShape,u=o.activeIndex,d=W(this.props,!1);return n.map(function(p,f){var m=u===f,h=m?c:s,y=q(q({},d),p);return g.createElement(H,Ne({className:"recharts-scatter-symbol",key:"symbol-".concat(p?.cx,"-").concat(p?.cy,"-").concat(p?.size,"-").concat(f)},pn(a.props,p,f),{role:"img"}),g.createElement(Zn,Ne({option:h,isActive:m,key:"symbol-".concat(f)},y)))})}},{key:"renderSymbolsWithAnimation",value:function(){var n=this,a=this.props,o=a.points,s=a.isAnimationActive,c=a.animationBegin,u=a.animationDuration,d=a.animationEasing,p=a.animationId,f=this.state.prevPoints;return g.createElement(it,{begin:c,duration:u,isActive:s,easing:d,from:{t:0},to:{t:1},key:"pie-".concat(p),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(m){var h=m.t,y=o.map(function(v,x){var b=f&&f[x];if(b){var P=K(b.cx,v.cx),A=K(b.cy,v.cy),j=K(b.size,v.size);return q(q({},v),{},{cx:P(h),cy:A(h),size:j(h)})}var S=K(0,v.size);return q(q({},v),{},{size:S(h)})});return g.createElement(H,null,n.renderSymbolsStatically(y))})}},{key:"renderSymbols",value:function(){var n=this.props,a=n.points,o=n.isAnimationActive,s=this.state.prevPoints;return o&&a&&a.length&&(!s||!Te(s,a))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(a)}},{key:"renderErrorBar",value:function(){var n=this.props.isAnimationActive;if(n&&!this.state.isAnimationFinished)return null;var a=this.props,o=a.points,s=a.xAxis,c=a.yAxis,u=a.children,d=at(u,Dt);return d?d.map(function(p,f){var m=p.props,h=m.direction,y=m.dataKey;return g.cloneElement(p,{key:"".concat(h,"-").concat(y,"-").concat(o[f]),data:o,xAxis:s,yAxis:c,layout:h==="x"?"vertical":"horizontal",dataPointFormatter:function(x,b){return{x:x.cx,y:x.cy,value:h==="x"?+x.node.x:+x.node.y,errorVal:re(x,b)}}})}):null}},{key:"renderLine",value:function(){var n=this.props,a=n.points,o=n.line,s=n.lineType,c=n.lineJointType,u=W(this.props,!1),d=W(o,!1),p,f;if(s==="joint")p=a.map(function(A){return{x:A.cx,y:A.cy}});else if(s==="fitting"){var m=mn(a),h=m.xmin,y=m.xmax,v=m.a,x=m.b,b=function(j){return v*j+x};p=[{x:h,y:b(h)},{x:y,y:b(y)}]}var P=q(q(q({},u),{},{fill:"none",stroke:u&&u.fill},d),{},{points:p});return g.isValidElement(o)?f=g.cloneElement(o,P):De(o)?f=o(P):f=g.createElement(Se,Ne({},P,{type:c})),g.createElement(H,{className:"recharts-scatter-line",key:"recharts-scatter-line"},f)}},{key:"render",value:function(){var n=this.props,a=n.hide,o=n.points,s=n.line,c=n.className,u=n.xAxis,d=n.yAxis,p=n.left,f=n.top,m=n.width,h=n.height,y=n.id,v=n.isAnimationActive;if(a||!o||!o.length)return null;var x=this.state.isAnimationFinished,b=_e("recharts-scatter",c),P=u&&u.allowDataOverflow,A=d&&d.allowDataOverflow,j=P||A,S=Q(y)?this.id:y;return g.createElement(H,{className:b,clipPath:j?"url(#clipPath-".concat(S,")"):null},P||A?g.createElement("defs",null,g.createElement("clipPath",{id:"clipPath-".concat(S)},g.createElement("rect",{x:P?p:p-m/2,y:A?f:f-h/2,width:P?m:m*2,height:A?h:h*2}))):null,s&&this.renderLine(),this.renderErrorBar(),g.createElement(H,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!v||x)&&ot.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}}])})(X.PureComponent);ne(Fe,"displayName","Scatter");ne(Fe,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!lt.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});ne(Fe,"getComposedData",function(e){var t=e.xAxis,r=e.yAxis,n=e.zAxis,a=e.item,o=e.displayedData,s=e.xAxisTicks,c=e.yAxisTicks,u=e.offset,d=a.props.tooltipType,p=at(a.props.children,kt),f=Q(t.dataKey)?a.props.dataKey:t.dataKey,m=Q(r.dataKey)?a.props.dataKey:r.dataKey,h=n&&n.dataKey,y=n?n.range:Be.defaultProps.range,v=y&&y[0],x=t.scale.bandwidth?t.scale.bandwidth():0,b=r.scale.bandwidth?r.scale.bandwidth():0,P=o.map(function(A,j){var S=re(A,f),N=re(A,m),_=!Q(h)&&re(A,h)||"-",k=[{name:Q(t.dataKey)?a.props.name:t.name||t.dataKey,unit:t.unit||"",value:S,payload:A,dataKey:f,type:d},{name:Q(r.dataKey)?a.props.name:r.name||r.dataKey,unit:r.unit||"",value:N,payload:A,dataKey:m,type:d}];_!=="-"&&k.push({name:n.name||n.dataKey,unit:n.unit||"",value:_,payload:A,dataKey:h,type:d});var $=me({axis:t,ticks:s,bandSize:x,entry:A,index:j,dataKey:f}),C=me({axis:r,ticks:c,bandSize:b,entry:A,index:j,dataKey:m}),T=_!=="-"?n.scale(_):v,D=Math.sqrt(Math.max(T,0)/Math.PI);return q(q({},A),{},{cx:$,cy:C,x:$-D,y:C-D,xAxis:t,yAxis:r,zAxis:n,width:2*D,height:2*D,size:T,node:{x:S,y:N,z:_},tooltipPayload:k,tooltipPosition:{x:$,y:C},payload:A},p&&p[j]&&p[j].props)});return q({points:P},u)});var ar=Ct({chartName:"LineChart",GraphicalChild:ae,axisComponents:[{axisType:"xAxis",AxisComp:oe},{axisType:"yAxis",AxisComp:Le}],formatAxisMap:$t}),ir=Ct({chartName:"ComposedChart",GraphicalChild:[ae,le,pe,Fe],axisComponents:[{axisType:"xAxis",AxisComp:oe},{axisType:"yAxis",AxisComp:Le},{axisType:"zAxis",AxisComp:Be}],formatAxisMap:$t});function or(e,t){const r=Nt(e);return isNaN(t)?cn(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function sr(e){const t=Nt(e);return t.setHours(23,59,59,999),t}function Ue(e,t){return or(e,-t)}const Ht="rounded-full px-3 py-1 text-sm font-mono font-bold",qt=e=>{const t=e.match(/hsl\((\d+(?:\.\d+)?)\s+(\d+(?:\.\d+)?)%\s+(\d+(?:\.\d+)?)%\)/);if(!t)return"#000";const[,r,n,a]=t,o=Number(r),s=Number(n)/100,c=Number(a)/100,u=(1-Math.abs(2*c-1))*s,d=u*(1-Math.abs(o/60%2-1)),p=c-u/2;let f=0,m=0,h=0;o>=0&&o<60?(f=u,m=d):o>=60&&o<120?(f=d,m=u):o>=120&&o<180?(m=u,h=d):o>=180&&o<240?(m=d,h=u):o>=240&&o<300?(f=d,h=u):(f=u,h=d);const y=Math.round((f+p)*255),v=Math.round((m+p)*255),x=Math.round((h+p)*255);return .2126*y+.7152*v+.0722*x>155?"#000":"#fff"};function lr({avgRpe:e,avgPerformance:t,avgEngagement:r,avgFatigue:n}){const a=[{key:"rpe",title:"Difficulté Moy",value:e,invert:!0},{key:"performance",title:"Performance Moy",value:t,invert:!1},{key:"engagement",title:"Engagement Moy",value:r,invert:!1},{key:"fatigue",title:"Fatigue Moy",value:n,invert:!0}];return i.jsx("div",{className:"grid grid-cols-2 gap-3 md:grid-cols-4",children:a.map(o=>{const s=$e(o.value??null,{invert:o.invert})??"hsl(var(--muted-foreground))";return i.jsxs(L,{children:[i.jsx(R,{className:"p-4 pb-2",children:i.jsx(I,{className:"text-xs uppercase text-muted-foreground",children:o.title})}),i.jsx(M,{className:"p-4 pt-0",children:i.jsx(Ot,{className:Ht,style:{backgroundColor:s,color:qt(s)},children:o.value?o.value.toFixed(1):"-"})})]},o.key)})})}function vr(){const{user:e,userId:t,role:r,selectedAthleteId:n,selectedAthleteName:a}=en(),o=(r==="coach"||r==="admin")&&(n!==null||!!a),s=o?a:e,c=o?n:t,u=c??s,[d,p]=X.useState("all"),[f,m]=X.useState(""),[h,y]=X.useState(""),[v,x]=X.useState(30),[b,P]=X.useState(30),{data:A}=Ge({queryKey:["sessions",u],queryFn:()=>ke.getSessions(s,c),enabled:!!s}),j=nn({queryKey:["strength_history",u,"progress",d,f,h],queryFn:({pageParam:l=0})=>ke.getStrengthHistory(s,{athleteId:c,limit:10,offset:l,order:"desc",status:d==="all"?void 0:d,from:f||void 0,to:h||void 0}),enabled:!!s,getNextPageParam:l=>{const w=l.pagination.offset+l.pagination.limit;return w<l.pagination.total?w:void 0},initialPageParam:0}),S=j.data?.pages.flatMap(l=>l.runs)??[],N=un(Ue(new Date,b)).toISOString(),_=sr(new Date).toISOString(),{data:k}=Ge({queryKey:["strength_history_summary",u,"progress",b,N,_],queryFn:()=>ke.getStrengthHistory(s,{athleteId:c,limit:200,order:"desc",from:N,to:_}),enabled:!!s}),{data:$}=Ge({queryKey:["strength_history_aggregate",u,"progress",b,N,_],queryFn:()=>ke.getStrengthHistoryAggregate(s,{athleteId:c,period:"day",limit:200,order:"asc",from:N,to:_}),enabled:!!s}),C=k?.runs??[],T=k?.exercise_summary??[],D=$?.periods??[],Y=l=>{if(!A)return[];const w=Ue(new Date,l),ee=A.filter(O=>new Date(O.date)>=w).reverse(),U=new Map;return ee.forEach(O=>{const F=be(new Date(O.date),"dd/MM");U.has(F)||U.set(F,{date:F,distance:0,effort:0,rpe:0,performance:0,engagement:0,fatigue:0,count:0,rpeCount:0,performanceCount:0,engagementCount:0,fatigueCount:0});const z=U.get(F);z.distance+=O.distance,z.effort+=O.effort,z.count+=1,O.rpe!==null&&O.rpe!==void 0&&(z.rpe+=O.rpe,z.rpeCount+=1),O.performance!==null&&O.performance!==void 0&&(z.performance+=O.performance,z.performanceCount+=1),O.engagement!==null&&O.engagement!==void 0&&(z.engagement+=O.engagement,z.engagementCount+=1),O.fatigue!==null&&O.fatigue!==void 0&&(z.fatigue+=O.fatigue,z.fatigueCount+=1)}),Array.from(U.values()).map(O=>({...O,effort:Math.round(O.effort/O.count*10)/10,rpe:O.rpeCount?Math.round(O.rpe/O.rpeCount*10)/10:null,performance:O.performanceCount?Math.round(O.performance/O.performanceCount*10)/10:null,engagement:O.engagementCount?Math.round(O.engagement/O.engagementCount*10)/10:null,fatigue:O.fatigueCount?Math.round(O.fatigue/O.fatigueCount*10)/10:null}))},G=A?A.filter(l=>new Date(l.date)>=Ue(new Date,v)):[],B=G.length,E=G.reduce((l,w)=>(l.distance+=w.distance,l.duration+=w.duration,w.rpe!==null&&w.rpe!==void 0&&(l.rpeSum+=w.rpe,l.rpeCount+=1),w.performance!==null&&w.performance!==void 0&&(l.performanceSum+=w.performance,l.performanceCount+=1),w.engagement!==null&&w.engagement!==void 0&&(l.engagementSum+=w.engagement,l.engagementCount+=1),w.fatigue!==null&&w.fatigue!==void 0&&(l.fatigueSum+=w.fatigue,l.fatigueCount+=1),l),{distance:0,duration:0,rpeSum:0,rpeCount:0,performanceSum:0,performanceCount:0,engagementSum:0,engagementCount:0,fatigueSum:0,fatigueCount:0}),ze=E.rpeCount?E.rpeSum/E.rpeCount:null,Ve=E.performanceCount?E.performanceSum/E.performanceCount:null,We=E.engagementCount?E.engagementSum/E.engagementCount:null,Xt=E.fatigueCount?E.fatigueSum/E.fatigueCount:null;B&&E.duration/B;const Yt=B?E.distance/B:0,xe=Y(v),He=l=>l==="rpe"||l==="effort"||l==="fatigue",qe=l=>{const ee=(Array.isArray(l?.logs)?l.logs:[]).map(F=>F?.rpe!==null&&F?.rpe!==void 0?Number(F.rpe):null).filter(F=>F!==null&&Number.isFinite(F));if(ee.length>0)return ee.reduce((F,z)=>F+z,0)/ee.length;const U=l?.feeling??l?.rpe??null,O=U!=null?Number(U):null;return O!==null&&Number.isFinite(O)?O:null},Gt=l=>l==null||Number.isNaN(l)?"-":l.toFixed(1),ct=[...C].sort((l,w)=>{const ee=new Date(l.started_at||l.date||l.created_at||0).getTime(),U=new Date(w.started_at||w.date||w.created_at||0).getTime();return ee-U}).map(l=>({date:be(new Date(l.started_at||l.date||l.created_at||new Date),"dd/MM"),feeling:qe(l)})),ut=D.map(l=>({date:l.period,label:be(new Date(l.period),"dd/MM"),tonnage:Math.round(l.tonnage??0),volume:Math.round(l.volume??0)})),Zt=D.reduce((l,w)=>l+(w.tonnage??0),0),Qt=D.reduce((l,w)=>l+(w.volume??0),0),Ut=C.length,Xe=C.map(l=>qe(l)).filter(l=>l!==null&&Number.isFinite(l)),Ee=Xe.length?Xe.reduce((l,w)=>l+w,0)/Xe.length:null,Ye=[...T].map(l=>({exerciseId:Number(l.exercise_id),name:l.exercise_name||`Exercice ${l.exercise_id}`,totalSets:Number(l.total_sets??0),totalReps:Number(l.total_reps??0),totalVolume:Number(l.total_volume??0),maxWeight:l.max_weight!==null&&l.max_weight!==void 0?Number(l.max_weight):null,lastPerformedAt:l.last_performed_at??null})).sort((l,w)=>w.totalVolume-l.totalVolume),dt=Ye.slice(0,8),Jt=l=>{if(!l)return"-";const w=new Date(l);return Number.isNaN(w.getTime())?"-":be(w,"dd/MM/yyyy")};return i.jsxs("div",{className:"space-y-6 pb-8",children:[i.jsx("h1",{className:"text-3xl font-display font-bold uppercase italic text-primary",children:"Progression"}),i.jsxs(sn,{defaultValue:"swim",className:"w-full",children:[i.jsxs(ln,{className:"grid w-full grid-cols-2",children:[i.jsx(yt,{value:"swim",children:"Natation"}),i.jsx(yt,{value:"strength",children:"Musculation"})]}),i.jsxs(vt,{value:"swim",className:"space-y-6 animate-in fade-in motion-reduce:animate-none",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2",children:[i.jsx("span",{className:"text-xs uppercase text-muted-foreground",children:"Période"}),i.jsxs(ft,{value:String(v),onValueChange:l=>x(Number(l)),children:[i.jsx(pt,{className:"h-8 w-[140px]",children:i.jsx(mt,{})}),i.jsxs(ht,{children:[i.jsx(ce,{value:"7",children:"7 jours"}),i.jsx(ce,{value:"30",children:"30 jours"}),i.jsx(ce,{value:"365",children:"365 jours"})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-3",children:[i.jsxs(L,{children:[i.jsx(R,{className:"p-4 pb-2",children:i.jsxs(I,{className:"text-xs uppercase text-muted-foreground",children:["Volume (",v,"j)"]})}),i.jsxs(M,{className:"p-4 pt-0 text-2xl font-bold font-mono",children:[E.distance.toLocaleString(),"m"]})]}),i.jsxs(L,{children:[i.jsx(R,{className:"p-4 pb-2",children:i.jsxs(I,{className:"text-xs uppercase text-muted-foreground",children:["Séances (",v,"j)"]})}),i.jsx(M,{className:"p-4 pt-0 text-2xl font-bold font-mono",children:B})]}),i.jsxs(L,{children:[i.jsx(R,{className:"p-4 pb-2",children:i.jsx(I,{className:"text-xs uppercase text-muted-foreground",children:"Distance Moy"})}),i.jsxs(M,{className:"p-4 pt-0 text-2xl font-bold font-mono",children:[Math.round(Yt).toLocaleString(),"m"]})]})]}),i.jsx(lr,{avgRpe:ze,avgPerformance:Ve,avgEngagement:We,avgFatigue:Xt}),i.jsxs(L,{children:[i.jsx(R,{children:i.jsx(I,{children:"Volume Quotidien"})}),i.jsx(M,{className:"h-[250px] w-full",children:xe.length===0?i.jsx("div",{className:"flex h-full items-center justify-center text-sm text-muted-foreground",children:"Aucune donnée disponible."}):i.jsx(je,{width:"100%",height:"100%",children:i.jsxs(Qe,{data:xe,children:[i.jsx(Ae,{strokeDasharray:"3 3",opacity:.1,vertical:!1}),i.jsx(oe,{dataKey:"date",fontSize:10,tickLine:!1,axisLine:!1}),i.jsx(Pe,{cursor:{fill:"transparent"}}),i.jsx(pe,{dataKey:"distance",fill:"hsl(var(--primary))",radius:[4,4,0,0]})]})})})]}),i.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[{key:"rpe",title:"RPE"},{key:"performance",title:"Performance"},{key:"engagement",title:"Engagement"},{key:"fatigue",title:"Fatigue"}].map(l=>i.jsxs(L,{children:[i.jsx(R,{children:i.jsx(I,{children:l.title})}),i.jsx(M,{className:"h-[240px] w-full",children:xe.length===0?i.jsx("div",{className:"flex h-full items-center justify-center text-sm text-muted-foreground",children:"Aucune donnée disponible."}):i.jsx(je,{width:"100%",height:"100%",children:i.jsxs(Qe,{data:xe,children:[i.jsx(Ae,{strokeDasharray:"3 3",opacity:.1,vertical:!1}),i.jsx(oe,{dataKey:"date",fontSize:10,tickLine:!1,axisLine:!1}),i.jsx(Le,{domain:[0,5],tickLine:!1,axisLine:!1,fontSize:10}),i.jsx(Pe,{cursor:{fill:"transparent"},formatter:w=>[w??"-",l.title]}),i.jsx(pe,{dataKey:l.key,radius:[4,4,0,0],children:xe.map((w,ee)=>i.jsx(kt,{fill:$e(w[l.key],{invert:He(l.key)})},`${l.key}-${w.date}-${ee}`))})]})})})]},l.key))})]}),i.jsxs(vt,{value:"strength",className:"space-y-6 animate-in fade-in motion-reduce:animate-none",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-2",children:[i.jsx("span",{className:"text-xs uppercase text-muted-foreground",children:"Période"}),i.jsxs(ft,{value:String(b),onValueChange:l=>P(Number(l)),children:[i.jsx(pt,{className:"h-8 w-[140px]",children:i.jsx(mt,{})}),i.jsxs(ht,{children:[i.jsx(ce,{value:"7",children:"7 jours"}),i.jsx(ce,{value:"30",children:"30 jours"}),i.jsx(ce,{value:"365",children:"365 jours"})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-4",children:[i.jsxs(L,{children:[i.jsx(R,{className:"p-4 pb-2",children:i.jsxs(I,{className:"text-xs uppercase text-muted-foreground",children:["Tonnage (",b,"j)"]})}),i.jsxs(M,{className:"p-4 pt-0 text-2xl font-bold font-mono",children:[Math.round(Zt).toLocaleString()," kg"]})]}),i.jsxs(L,{children:[i.jsx(R,{className:"p-4 pb-2",children:i.jsxs(I,{className:"text-xs uppercase text-muted-foreground",children:["Volume (",b,"j)"]})}),i.jsxs(M,{className:"p-4 pt-0 text-2xl font-bold font-mono",children:[Math.round(Qt).toLocaleString()," reps"]})]}),i.jsxs(L,{children:[i.jsx(R,{className:"p-4 pb-2",children:i.jsxs(I,{className:"text-xs uppercase text-muted-foreground",children:["Séances (",b,"j)"]})}),i.jsx(M,{className:"p-4 pt-0 text-2xl font-bold font-mono",children:Ut})]}),i.jsxs(L,{children:[i.jsx(R,{className:"p-4 pb-2",children:i.jsx(I,{className:"text-xs uppercase text-muted-foreground",children:"Ressenti Moy"})}),i.jsx(M,{className:"p-4 pt-0",children:i.jsx(Ot,{className:Ht,style:{backgroundColor:$e(Ee??null,{invert:He("rpe")})??"hsl(var(--muted-foreground))",color:qt($e(Ee??null,{invert:He("rpe")})??"hsl(var(--muted-foreground))")},children:Ee!==null?Ee.toFixed(1):"-"})})]})]}),i.jsxs(L,{children:[i.jsx(R,{children:i.jsxs(I,{children:["Tonnage & Volume (",b,"j)"]})}),i.jsx(M,{className:"h-[250px] w-full",children:ut.length===0?i.jsx("div",{className:"flex h-full items-center justify-center text-sm text-muted-foreground",children:"Aucune donnée disponible."}):i.jsx(je,{width:"100%",height:"100%",children:i.jsxs(ir,{data:ut,children:[i.jsx(Ae,{strokeDasharray:"3 3",opacity:.1,vertical:!1}),i.jsx(oe,{dataKey:"label",fontSize:10,tickLine:!1,axisLine:!1}),i.jsx(Pe,{}),i.jsx(pe,{dataKey:"tonnage",name:"Tonnage",fill:"hsl(var(--primary))",radius:[4,4,0,0]}),i.jsx(pe,{dataKey:"volume",name:"Volume",fill:"hsl(var(--accent))",radius:[4,4,0,0]}),i.jsx(ae,{type:"monotone",dataKey:"tonnage",stroke:"hsl(var(--primary))",strokeWidth:2,dot:!1}),i.jsx(ae,{type:"monotone",dataKey:"volume",stroke:"hsl(var(--accent))",strokeWidth:2,dot:!1})]})})})]}),i.jsxs(L,{children:[i.jsx(R,{children:i.jsx(I,{children:"Ressenti Séances"})}),i.jsx(M,{className:"h-[250px] w-full",children:ct.length===0?i.jsx("div",{className:"flex h-full items-center justify-center text-sm text-muted-foreground",children:"Aucune donnée disponible."}):i.jsx(je,{width:"100%",height:"100%",children:i.jsxs(ar,{data:ct,children:[i.jsx(Ae,{strokeDasharray:"3 3",opacity:.1,vertical:!1}),i.jsx(oe,{dataKey:"date",fontSize:10,tickLine:!1,axisLine:!1}),i.jsx(Le,{domain:[0,10],hide:!0}),i.jsx(Pe,{}),i.jsx(ae,{type:"monotone",dataKey:"feeling",stroke:"hsl(var(--foreground))",strokeWidth:2,dot:{r:4}})]})})})]}),i.jsxs(L,{children:[i.jsx(R,{children:i.jsx(I,{children:"Volume par exercice"})}),i.jsx(M,{className:"h-[260px] w-full",children:dt.length===0?i.jsx("div",{className:"flex h-full items-center justify-center text-sm text-muted-foreground",children:"Aucune donnée d'exercice disponible."}):i.jsx(je,{width:"100%",height:"100%",children:i.jsxs(Qe,{data:dt,children:[i.jsx(Ae,{strokeDasharray:"3 3",opacity:.1,vertical:!1}),i.jsx(oe,{dataKey:"name",fontSize:10,tickLine:!1,axisLine:!1,interval:0}),i.jsx(Pe,{cursor:{fill:"transparent"},formatter:l=>[`${Number(l).toLocaleString()} kg`,"Volume"]}),i.jsx(pe,{dataKey:"totalVolume",fill:"hsl(var(--primary))",radius:[4,4,0,0]})]})})})]}),i.jsxs(L,{children:[i.jsx(R,{children:i.jsx(I,{children:"Stats par exercice"})}),i.jsx(M,{children:i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs(rn,{children:[i.jsx(an,{children:i.jsxs(Ze,{children:[i.jsx(ue,{children:"Exercice"}),i.jsx(ue,{className:"text-right",children:"Séries"}),i.jsx(ue,{className:"text-right",children:"Répétitions"}),i.jsx(ue,{className:"text-right",children:"Volume"}),i.jsx(ue,{className:"text-right",children:"Charge max"}),i.jsx(ue,{className:"text-right",children:"Dernière séance"})]})}),i.jsx(on,{children:Ye.length===0?i.jsx(Ze,{children:i.jsx(ie,{colSpan:6,className:"text-center text-sm text-muted-foreground",children:"Aucun exercice enregistré."})}):Ye.map(l=>i.jsxs(Ze,{children:[i.jsx(ie,{className:"font-medium",children:l.name}),i.jsx(ie,{className:"text-right font-mono",children:l.totalSets}),i.jsx(ie,{className:"text-right font-mono",children:l.totalReps}),i.jsxs(ie,{className:"text-right font-mono",children:[l.totalVolume.toLocaleString()," kg"]}),i.jsx(ie,{className:"text-right font-mono",children:l.maxWeight!==null?`${l.maxWeight} kg`:"-"}),i.jsx(ie,{className:"text-right text-sm text-muted-foreground",children:Jt(l.lastPerformedAt)})]},l.exerciseId))})]})})})]}),i.jsxs(L,{children:[i.jsx(R,{children:i.jsx(I,{children:"Historique récent"})}),i.jsxs(M,{className:"space-y-3",children:[S.length===0&&i.jsx("div",{className:"text-center text-sm text-muted-foreground py-6",children:"Aucun historique disponible."}),S.map(l=>i.jsxs("div",{className:"flex items-center justify-between border-b border-border/60 pb-2 last:border-b-0 last:pb-0",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-semibold",children:be(new Date(l.started_at||l.date||l.created_at||new Date),"dd/MM/yyyy")}),i.jsx("div",{className:"text-xs uppercase text-muted-foreground",children:l.status||"Séance"})]}),i.jsxs("div",{className:"text-sm font-mono font-semibold",children:[Gt(qe(l)),"/10"]})]},l.id)),j.hasNextPage&&i.jsx(tn,{variant:"outline",size:"sm",className:"w-full",onClick:()=>j.fetchNextPage(),disabled:j.isFetchingNextPage,children:j.isFetchingNextPage?"Chargement...":"Charger plus"})]})]})]})]})]})}export{lr as SwimKpiCompactGrid,vr as default};
