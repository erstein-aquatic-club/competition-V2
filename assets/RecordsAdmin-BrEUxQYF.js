import{c as he,r as n,u as ge,d as j,j as e}from"./vendor-query-DyA9aSKS.js";import{a as l}from"./api-B5IjPmXE.js";import{c as ne,u as fe,d as je,B as x,x as ve,a as y,P as be,I as _,C as Ne,g as ye,i as _e,j as Se,Z as Ce,e as ke}from"./index-BUlp20at.js";import{S as le}from"./switch-gXWPXyKZ.js";import{B as ce}from"./badge-CghSrVcS.js";import{S as I,a as $,b as A,c as E,d as R}from"./select-DfS6T2_L.js";import{D as we,a as Fe,b as Ie,c as $e,d as Ae,e as Ee}from"./dialog-CV4PhZgZ.js";import{I as Re}from"./InlineBanner-QI1waNUt.js";import{s as De}from"./swim-DVfUvcWt.js";import{E as Me}from"./eye-CtEg2SZx.js";import{C as re}from"./chevron-down-plo-zOO5.js";import{C as Pe}from"./circle-alert-fUFF5lRq.js";import"./vendor-react-BzrpNAyj.js";import"./vendor-charts-BrQ8X25f.js";import"./vendor-supabase-DFPLkPj_.js";import"./vendor-motion-lao-Njgm.js";import"./index-DCX2sNhR.js";import"./index-Q1dVTVYJ.js";import"./index-BfHUgfcP.js";import"./chevron-up-CWPgMYZC.js";import"./index-CWgT4Wh-.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],F=ne("arrow-right",Le);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],Ve=ne("git-merge",Te),de=[{value:"M",label:"Garçon"},{value:"F",label:"Fille"}],qe=r=>r==="user"?"Compte":"Ancien",ae=r=>{if(!r)return"-";const a=new Date(r);return Number.isNaN(a.getTime())?r:a.toLocaleDateString("fr-FR")+" "+a.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})},Ue=r=>{if(!r)return"Jamais";const a=new Date(r);return Number.isNaN(a.getTime())?r:a.toLocaleDateString("fr-FR")},ze=(r,a=30)=>{if(!r)return!0;const g=new Date(r);return Number.isNaN(g.getTime())?!0:Date.now()-g.getTime()>a*24*60*60*1e3},Be=r=>{switch(r){case"success":return"default";case"running":return"secondary";case"error":return"destructive";default:return"outline"}},Ke=r=>{switch(r){case"success":return"OK";case"running":return"En cours";case"error":return"Erreur";case"pending":return"En attente";default:return r}},ie=({swimmer:r,onUpdate:a,onImport:g,onMerge:u,importPending:S})=>{const d=ze(r.last_imported_at),C=r.is_active&&(!r.iuf||!r.sex||!r.birthdate),f=r.id??`user-${r.user_id??"unknown"}`;return e.jsxs("div",{className:y("rounded-xl border bg-card p-3 space-y-2",C&&"border-amber-300 bg-amber-50/30 dark:border-amber-700 dark:bg-amber-950/20",d&&!C&&r.is_active&&"border-amber-200/50",!r.is_active&&"opacity-60"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold truncate",children:r.display_name}),e.jsx(ce,{variant:r.source_type==="manual"?"secondary":"outline",className:"shrink-0 text-[10px] px-1.5 py-0",children:qe(r.source_type)})]}),e.jsx(le,{checked:!!r.is_active,onCheckedChange:c=>a({is_active:c})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{defaultValue:r.iuf??"",placeholder:"IUF",onBlur:c=>a({iuf:c.target.value.trim()||null}),className:y("h-8 text-xs flex-1 min-w-0",!r.iuf&&r.is_active&&"ring-2 ring-destructive/50")},`${f}-${r.iuf??""}`),e.jsxs(I,{value:r.sex??"",onValueChange:c=>a({sex:c||null}),children:[e.jsx($,{className:y("h-8 w-24 text-xs shrink-0",!r.sex&&r.is_active&&"ring-2 ring-destructive/50"),children:e.jsx(A,{placeholder:"Sexe"})}),e.jsx(E,{children:de.map(c=>e.jsx(R,{value:c.value,children:c.label},c.value))})]}),e.jsx(_,{type:"number",placeholder:"Année",defaultValue:r.birthdate?new Date(r.birthdate).getFullYear():"",onBlur:c=>{const p=c.target.value.trim();p&&/^\d{4}$/.test(p)?a({birthdate:`${p}-01-01`}):p||a({birthdate:null})},className:y("h-8 w-[4.5rem] text-xs shrink-0",!r.birthdate&&r.is_active&&"ring-2 ring-amber-400/50")},`${f}-birth-${r.birthdate??""}`)]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:y("text-[11px]",d&&r.is_active?"text-amber-600 dark:text-amber-400":"text-muted-foreground"),children:["Maj : ",Ue(r.last_imported_at)]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[u&&e.jsxs(x,{size:"sm",variant:"outline",className:"h-7 text-xs",onClick:u,children:[e.jsx(Ve,{className:"h-3 w-3 mr-1"}),"Fusionner"]}),r.is_active&&r.iuf?e.jsx(x,{size:"sm",variant:"outline",className:"h-7 text-xs",disabled:S,onClick:g,children:"Importer"}):r.is_active&&!r.iuf?e.jsx("span",{className:"text-[11px] text-muted-foreground",children:"IUF requis"}):null]})]})]})};function ms(){const r=fe(s=>s.role),{toast:a}=je(),g=he(),[u,S]=n.useState({display_name:"",iuf:"",sex:""}),[d,C]=n.useState([]),[f,c]=n.useState(!1),[p,Y]=n.useState(null),[J,oe]=n.useState(!1),[U,ue]=n.useState(!1),[z,X]=n.useState(!1),[v,D]=n.useState(null),[m,M]=n.useState(null),[i,P]=n.useState(null),[b,k]=n.useState(null),L=r==="coach"||r==="admin",B=r==="admin",{data:Z=[],refetch:T}=ge({queryKey:["import-logs"],queryFn:()=>l.getImportLogs({limit:20}),enabled:L}),N=n.useCallback(async()=>{if(L){c(!0),Y(null);try{await l.syncClubRecordSwimmersFromUsers();const s=await l.getClubRecordSwimmers();C(s)}catch(s){const t=De(s,"Impossible de charger la liste.");Y(t.message),C([])}finally{c(!1)}}},[L]);n.useEffect(()=>{N()},[N]),n.useEffect(()=>{B&&(l.getAppSettings("import_rate_limits").then(s=>{s&&D(s)}),l.getAppSettings("ffn_auto_sync").then(s=>{s&&M(s)}))},[B]);const W=j({mutationFn:()=>l.createClubRecordSwimmer({display_name:u.display_name.trim(),iuf:u.iuf.trim()||null,sex:u.sex?u.sex:null,is_active:!0}),onSuccess:()=>{a({title:"Nageur ajouté"}),S({display_name:"",iuf:"",sex:""}),X(!1),N()},onError:s=>{a({title:s?.message||"Impossible d'ajouter le nageur",variant:"destructive"})}}),me=j({mutationFn:({id:s,payload:t})=>l.updateClubRecordSwimmer(s,t),onSuccess:()=>{N(),a({title:"Sauvegardé"})},onError:s=>{a({title:s?.message||"Mise à jour impossible",variant:"destructive"})}}),xe=j({mutationFn:({userId:s,payload:t})=>l.updateClubRecordSwimmerForUser(s,t),onSuccess:()=>{N(),a({title:"Sauvegardé"})},onError:()=>{a({title:"Mise à jour impossible",variant:"destructive"})}}),ee=(s,t)=>{if(s.source_type==="user"&&s.user_id){xe.mutate({userId:s.user_id,payload:t});return}s.id&&me.mutate({id:s.id,payload:t})},K=j({mutationFn:()=>l.importClubRecords(),onSuccess:s=>{const t=s?.summary??s,o=s?.recalc_stats;let H=t?`Performances importées: ${t.imported??0}. Erreurs: ${t.errors??0}.`:"";o&&(H+=` Records: ${o.club_records_upserted} (${o.processed} perfs traitées).`,o.skipped_no_age&&(H+=` Ignorées (pas d'âge): ${o.skipped_no_age}.`)),a({title:"Import terminé",description:H}),N(),T(),g.invalidateQueries({queryKey:["club-records"]})},onError:s=>{const t=s?.message?.includes("Rate limit")||s?.message?.includes("Limite")?s.message:"Import impossible";a({title:t,variant:"destructive"}),T()}}),Q=j({mutationFn:({iuf:s,name:t})=>l.importSingleSwimmer(s,t),onSuccess:(s,t)=>{a({title:`Import de ${t.name??t.iuf}`,description:`${s.total_found} performances trouvées, ${s.new_imported} nouvelles importées.`}),T(),l.recalculateClubRecords().then(()=>{g.invalidateQueries({queryKey:["club-records"]})}),N()},onError:(s,t)=>{const o=s?.message?.includes("Rate limit")||s?.message?.includes("Limite")?s.message:`Erreur import ${t.name??t.iuf}`;a({title:o,variant:"destructive"}),T()}}),se=j({mutationFn:s=>l.updateAppSettings("import_rate_limits",s),onSuccess:()=>{a({title:"Limites sauvegardées"})},onError:()=>{a({title:"Erreur de sauvegarde",variant:"destructive"})}}),te=j({mutationFn:s=>l.updateAppSettings("ffn_auto_sync",s),onSuccess:()=>{a({title:"Planning sauvegardé"})},onError:()=>{a({title:"Erreur de sauvegarde",variant:"destructive"})}}),G=j({mutationFn:({manualId:s,userSwimmerId:t})=>l.mergeClubRecordSwimmers(s,t),onSuccess:s=>{a({title:"Profils fusionnés",description:`IUF ${s.iuf_transferred??"—"} transféré, ${s.performances_reassigned} performance(s) rattachée(s).`}),P(null),k(null),N(),g.invalidateQueries({queryKey:["club-records"]})},onError:s=>{a({title:s?.message||"Fusion impossible",variant:"destructive"})}}),{activeSwimmers:V,inactiveSwimmers:w}=n.useMemo(()=>{const s=[...d].sort((t,o)=>t.source_type!==o.source_type?t.source_type.localeCompare(o.source_type):t.display_name.localeCompare(o.display_name));return{activeSwimmers:s.filter(t=>t.is_active),inactiveSwimmers:s.filter(t=>!t.is_active)}},[d]),pe=n.useMemo(()=>d.filter(s=>s.source_type==="user"&&s.is_active),[d]),h=n.useMemo(()=>b?d.find(s=>s.id===b)??null:null,[b,d]),q=n.useMemo(()=>d.filter(s=>s.is_active&&(!s.iuf||!s.sex||!s.birthdate)).length,[d]),O=j({mutationFn:()=>l.recalculateClubRecords(),onSuccess:s=>{const t=s?.recalc_stats,o=t?`${t.swimmers_with_sex} nageur(s), ${t.total_performances} perfs, ${t.processed} traitées, ${t.club_records_upserted} records.${t.skipped_no_swimmer?` Ignorées (pas de nageur): ${t.skipped_no_swimmer}.`:""}${t.skipped_no_event_code?` Ignorées (épreuve inconnue): ${t.skipped_no_event_code}.`:""}${t.skipped_no_age?` Ignorées (pas d'âge): ${t.skipped_no_age}.`:""}${t.unmapped_event_codes?.length?` Épreuves inconnues: ${t.unmapped_event_codes.join(", ")}`:""}`:"";a({title:"Records recalculés",description:o}),g.invalidateQueries({queryKey:["club-records"]})},onError:()=>{a({title:"Erreur de recalcul",variant:"destructive"})}});return L?e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold uppercase italic text-primary",children:"Records club"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Import des performances FFN et gestion des nageurs."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(x,{onClick:()=>K.mutate(),disabled:K.isPending,children:K.isPending?"Import en cours…":"Mettre à jour"}),e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>O.mutate(),disabled:O.isPending,children:[e.jsx(ve,{className:y("h-4 w-4 mr-1",O.isPending&&"animate-spin")}),"Recalculer"]}),e.jsxs(x,{variant:"ghost",size:"sm",onClick:()=>{window.location.hash="#/records-club"},children:[e.jsx(Me,{className:"h-4 w-4 mr-1"}),"Voir les records"]})]})]}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",onClick:()=>X(!z),className:"flex items-center gap-2 text-sm font-semibold text-muted-foreground py-1 active:opacity-70",children:[e.jsx(be,{className:"h-4 w-4"}),"Ajouter un ancien nageur",e.jsx(re,{className:y("h-3 w-3 transition-transform",z&&"rotate-180")})]}),z&&e.jsxs("div",{className:"mt-2 grid gap-2 sm:grid-cols-[2fr_1fr_1fr_auto] rounded-xl border bg-card p-3",children:[e.jsx(_,{placeholder:"Nom du nageur",value:u.display_name,onChange:s=>S(t=>({...t,display_name:s.target.value}))}),e.jsx(_,{placeholder:"IUF",value:u.iuf,onChange:s=>S(t=>({...t,iuf:s.target.value}))}),e.jsxs(I,{value:u.sex,onValueChange:s=>S(t=>({...t,sex:s})),children:[e.jsx($,{children:e.jsx(A,{placeholder:"Sexe"})}),e.jsx(E,{children:de.map(s=>e.jsx(R,{value:s.value,children:s.label},s.value))})]}),e.jsx(x,{onClick:()=>W.mutate(),disabled:!u.display_name.trim()||W.isPending,children:"Ajouter"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xs font-semibold uppercase tracking-[0.15em] text-muted-foreground",children:"Nageurs suivis"}),!f&&d.length>0&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[V.length," actif",V.length!==1?"s":""]})]}),e.jsx(Re,{variant:"amber",icon:e.jsx(Pe,{}),label:`${q} nageur${q>1?"s":""} incomplet${q>1?"s":""}`,sublabel:"IUF, sexe et année de naissance requis pour les records",visible:!f&&q>0,animate:!1}),f&&e.jsx("div",{className:"space-y-2",children:[1,2,3,4].map(s=>e.jsxs("div",{className:"rounded-xl border p-3 animate-pulse motion-reduce:animate-none",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-4 w-32 rounded bg-muted"}),e.jsx("div",{className:"ml-auto h-6 w-10 rounded bg-muted"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("div",{className:"h-8 flex-1 rounded bg-muted"}),e.jsx("div",{className:"h-8 w-24 rounded bg-muted"}),e.jsx("div",{className:"h-8 w-[4.5rem] rounded bg-muted"})]})]},s))}),p&&e.jsx("p",{className:"text-sm text-destructive",children:p}),!f&&!p&&d.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"Aucun nageur disponible."}),!f&&!p&&V.length>0&&e.jsx("div",{className:"space-y-2",children:V.map(s=>e.jsx(ie,{swimmer:s,onUpdate:t=>ee(s,t),onImport:s.iuf?()=>Q.mutate({iuf:s.iuf,name:s.display_name}):void 0,onMerge:s.source_type==="manual"&&s.is_active?()=>{P(s),k(null)}:void 0,importPending:Q.isPending},s.id??`user-${s.user_id??"unknown"}`))}),!f&&!p&&w.length>0&&e.jsxs("div",{className:"border-t pt-2",children:[e.jsxs("button",{type:"button",onClick:()=>ue(!U),className:"flex w-full items-center gap-2 rounded-md px-2 py-2 text-sm font-medium text-muted-foreground hover:bg-muted/50 transition-colors",children:[e.jsx(re,{className:y("h-4 w-4 transition-transform",U&&"rotate-180")}),"Archive (",w.length," nageur",w.length>1?"s":""," inactif",w.length>1?"s":"",")"]}),U&&e.jsx("div",{className:"mt-2 space-y-2",children:w.map(s=>e.jsx(ie,{swimmer:s,onUpdate:t=>ee(s,t),importPending:Q.isPending},s.id??`user-${s.user_id??"unknown"}`))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xs font-semibold uppercase tracking-[0.15em] text-muted-foreground",children:"Historique des imports"}),Z.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"Aucun import effectué."}):e.jsx("div",{className:"space-y-1.5",children:Z.map(s=>e.jsxs("div",{className:"rounded-lg border px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium truncate",children:s.swimmer_name??s.swimmer_iuf}),e.jsx(ce,{variant:Be(s.status),className:"text-[10px] px-1.5 py-0 shrink-0",children:Ke(s.status)})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-0.5 text-[11px] text-muted-foreground mt-0.5",children:[e.jsxs("span",{children:[s.performances_found??0," trouvées"]}),e.jsxs("span",{children:[s.performances_imported??0," importées"]}),e.jsx("span",{children:ae(s.started_at)})]}),s.error_message&&e.jsx("p",{className:"text-[11px] text-destructive truncate mt-0.5",children:s.error_message})]},s.id))})]}),e.jsx(we,{open:!!i,onOpenChange:s=>{s||(P(null),k(null))},children:e.jsxs(Fe,{className:"max-w-lg",children:[e.jsxs(Ie,{children:[e.jsx($e,{children:"Fusionner les profils"}),e.jsx(Ae,{children:"Transférer l'IUF, le sexe et l'année de l'ancien profil vers le compte du nageur."})]}),i&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"rounded-xl border p-3 space-y-1.5 bg-muted/30",children:[e.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-wider text-muted-foreground",children:"Ancien"}),e.jsx("p",{className:"text-sm font-semibold",children:i.display_name}),e.jsxs("div",{className:"space-y-0.5 text-xs text-muted-foreground",children:[e.jsxs("p",{children:["IUF : ",e.jsx("span",{className:"font-mono",children:i.iuf??"—"})]}),e.jsxs("p",{children:["Sexe : ",i.sex==="M"?"Garçon":i.sex==="F"?"Fille":"—"]}),e.jsxs("p",{children:["Année : ",i.birthdate?new Date(i.birthdate).getFullYear():"—"]})]})]}),e.jsxs("div",{className:"rounded-xl border p-3 space-y-1.5",children:[e.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-wider text-muted-foreground",children:"Compte"}),e.jsxs(I,{value:b?String(b):"",onValueChange:s=>k(Number(s)),children:[e.jsx($,{className:"h-8 text-xs",children:e.jsx(A,{placeholder:"Choisir un nageur inscrit…"})}),e.jsx(E,{children:pe.map(s=>e.jsx(R,{value:String(s.id),children:s.display_name},s.id))})]}),h&&e.jsxs("div",{className:"space-y-0.5 text-xs text-muted-foreground",children:[e.jsxs("p",{children:["IUF : ",e.jsx("span",{className:"font-mono",children:h.iuf??"—"})]}),e.jsxs("p",{children:["Sexe : ",h.sex==="M"?"Garçon":h.sex==="F"?"Fille":"—"]}),e.jsxs("p",{children:["Année : ",h.birthdate?new Date(h.birthdate).getFullYear():"—"]})]})]})]}),h&&e.jsxs("div",{className:"rounded-lg bg-muted/50 p-2.5 space-y-1",children:[e.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-wider text-muted-foreground mb-1",children:"Transferts prévus"}),i.iuf&&!h.iuf&&e.jsxs("p",{className:"text-xs flex items-center gap-1.5",children:[e.jsx(F,{className:"h-3 w-3 text-primary shrink-0"}),"IUF ",e.jsx("span",{className:"font-mono text-primary",children:i.iuf})]}),i.sex&&!h.sex&&e.jsxs("p",{className:"text-xs flex items-center gap-1.5",children:[e.jsx(F,{className:"h-3 w-3 text-primary shrink-0"}),"Sexe : ",i.sex==="M"?"Garçon":"Fille"]}),i.birthdate&&!h.birthdate&&e.jsxs("p",{className:"text-xs flex items-center gap-1.5",children:[e.jsx(F,{className:"h-3 w-3 text-primary shrink-0"}),"Année : ",new Date(i.birthdate).getFullYear()]}),i.iuf&&e.jsxs("p",{className:"text-xs flex items-center gap-1.5",children:[e.jsx(F,{className:"h-3 w-3 text-primary shrink-0"}),"Performances FFN rattachées au compte"]}),e.jsxs("p",{className:"text-xs flex items-center gap-1.5 text-destructive",children:[e.jsx(F,{className:"h-3 w-3 shrink-0"}),"L'entrée « ",i.display_name," » sera supprimée"]})]})]}),e.jsxs(Ee,{children:[e.jsx(x,{variant:"outline",onClick:()=>{P(null),k(null)},children:"Annuler"}),e.jsx(x,{variant:"destructive",disabled:!i||!b||G.isPending,onClick:()=>{i?.id&&b&&G.mutate({manualId:i.id,userSwimmerId:b})},children:G.isPending?"Fusion…":"Fusionner"})]})]})}),B&&e.jsxs(Ne,{children:[e.jsxs(ye,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(_e,{children:"Paramètres d'import"}),e.jsx(Se,{children:"Limites mensuelles d'import par rôle."})]}),e.jsx(x,{variant:"ghost",size:"sm",onClick:()=>oe(!J),children:e.jsx(Ce,{className:"h-4 w-4"})})]}),J&&v&&e.jsxs(ke,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"Coach (par mois)"}),e.jsx(_,{type:"number",value:v.coach_monthly,onChange:s=>D({...v,coach_monthly:Number(s.target.value)}),min:-1})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"Nageur (par mois)"}),e.jsx(_,{type:"number",value:v.athlete_monthly,onChange:s=>D({...v,athlete_monthly:Number(s.target.value)}),min:-1})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"Admin (par mois, -1=illimité)"}),e.jsx(_,{type:"number",value:v.admin_monthly,onChange:s=>D({...v,admin_monthly:Number(s.target.value)}),min:-1})]})]}),e.jsx(x,{size:"sm",onClick:()=>se.mutate(v),disabled:se.isPending,children:"Enregistrer"}),m&&e.jsxs("div",{className:"space-y-3 border-t pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Mise à jour auto FFN"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Import hebdomadaire des performances de tous les nageurs actifs"})]}),e.jsx(le,{checked:m.enabled,onCheckedChange:s=>M({...m,enabled:s})})]}),m.enabled&&e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"Jour"}),e.jsxs(I,{value:String(m.day),onValueChange:s=>M({...m,day:Number(s)}),children:[e.jsx($,{className:"h-9",children:e.jsx(A,{})}),e.jsx(E,{children:[{value:"1",label:"Lundi"},{value:"2",label:"Mardi"},{value:"3",label:"Mercredi"},{value:"4",label:"Jeudi"},{value:"5",label:"Vendredi"},{value:"6",label:"Samedi"},{value:"0",label:"Dimanche"}].map(s=>e.jsx(R,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"Heure (UTC)"}),e.jsxs(I,{value:String(m.hour),onValueChange:s=>M({...m,hour:Number(s)}),children:[e.jsx($,{className:"h-9",children:e.jsx(A,{})}),e.jsx(E,{children:Array.from({length:24},(s,t)=>e.jsxs(R,{value:String(t),children:[String(t).padStart(2,"0"),":00"]},t))})]})]})]}),m.last_run&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Dernière exécution : ",ae(m.last_run)]}),e.jsx(x,{size:"sm",onClick:()=>te.mutate(m),disabled:te.isPending,children:"Enregistrer"})]})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-2xl font-display font-bold uppercase italic text-primary",children:"Records club"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Accès réservé aux coachs."})]})}export{ms as default};
