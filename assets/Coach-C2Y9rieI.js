const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CoachSwimmersOverview-CZnY-Ta6.js","assets/vendor-query-DyA9aSKS.js","assets/vendor-react-BzrpNAyj.js","assets/api-Bi5BofyP.js","assets/index-a77HTGTn.js","assets/vendor-charts-BrQ8X25f.js","assets/vendor-supabase-DFPLkPj_.js","assets/vendor-motion-lao-Njgm.js","assets/index-D43HjOHf.css","assets/swim-DKM5c2mA.js","assets/badge-D4lOcVQC.js","assets/arrow-left-Cfuqpj5u.js","assets/search-DlCs_c3r.js","assets/trophy-17j0wfM8.js","assets/bell-ring-CzhbyKHp.js","assets/chevron-right-2rf3VcwV.js","assets/zap-CvQdoVrN.js","assets/clock-DjDmXfdz.js","assets/CoachMessagesScreen-COIl3V29.js","assets/textarea-B64rzTdK.js","assets/select-BkX-jYEd.js","assets/index-BKdYfypj.js","assets/index-B2XLW6kS.js","assets/index-DCX2sNhR.js","assets/chevron-down-BdhKl7su.js","assets/chevron-up-oWpblg1w.js","assets/CoachSmsScreen-Dfb7-BOS.js","assets/command-0bOS5glq.js","assets/index-CRmjOTHB.js","assets/dialog-99fihmkL.js","assets/smsUtils-2BVYkKG3.js","assets/copy-CuMz7_74.js","assets/CoachCalendar-BFHXN8Ir.js","assets/CalendarGrid-NbXiTl6H.js","assets/chevron-left-GOKS7Zl1.js","assets/toggle-group-BWMmLBt5.js","assets/index-2OXxR3Al.js","assets/sheet-Cm9iCCxG.js","assets/InlineBanner-CUle5eZW.js","assets/circle-alert-6pHD8PNI.js","assets/trash-2-D_TQd7ii.js","assets/CoachGroupsScreen-DyKCZrjq.js","assets/checkbox-Ba8tyFj7.js","assets/separator-B_g0hLwl.js","assets/alert-dialog-C-2X36En.js","assets/collapsible-BiiHkrta.js","assets/user-plus-CnRPOP6z.js","assets/power-BRmyuw1s.js","assets/CoachCompetitionsScreen-BCVojBbb.js","assets/CoachObjectivesScreen-BnGu7ouV.js","assets/ObjectiveCard-BmXQeGj1.js","assets/CoachTrainingSlotsScreen-DZWxp8oj.js","assets/radio-group-BFNKMcWz.js","assets/circle-C9q_sMt3.js","assets/map-pin-uAke097h.js","assets/CoachSwimmerDetail-D-Rexszy.js","assets/tabs-BpGWLAcD.js","assets/weekTypeColor-Crpv0wog.js","assets/chart-column-ColJszP9.js","assets/date-DrpgLmFD.js","assets/vendor-date-B8Mnp-Vt.js","assets/pencil-TNQgbKf8.js","assets/StrengthCatalog-DQVhobAk.js","assets/SessionListView-Dxy2_Ujg.js","assets/play-B41G9zAh.js","assets/save-CLgTkwmI.js","assets/share-2-DJP2_OUO.js","assets/drawer-BsLxZSrz.js","assets/loader-circle-CIc3X2o8.js","assets/pen-CKPJBCs6.js","assets/SwimCatalog-Dxzx8mTF.js","assets/SwimSessionTimeline-Bc4_etpe.js","assets/SwimTimeInput-B3auWw99.js","assets/timer-BTx4XDyr.js","assets/swimSessionUtils-DN7EW4yB.js","assets/eye-YUT9QeT6.js","assets/sparkles-DnvWQVjc.js","assets/CoachSlotCalendar-C0YgdMTd.js","assets/eye-off-BHwUxevx.js","assets/calendar-Cl8cciYf.js"])))=>i.map(i=>d[i]);
import{b as ee,B as H,u as X,a as ue,C as xe,g as he,i as pe,U as se,j as ge,e as be,k as x,l as $,I as fe,W as Q,D as je,_ as h}from"./index-a77HTGTn.js";import{j as e,r as n,u as D}from"./vendor-query-DyA9aSKS.js";import{a as S}from"./api-Bi5BofyP.js";import{A as ye}from"./arrow-left-Cfuqpj5u.js";import{S as Ne}from"./search-DlCs_c3r.js";import{T as q}from"./trophy-17j0wfM8.js";import{B as W}from"./bell-ring-CzhbyKHp.js";import{C as R}from"./chevron-right-2rf3VcwV.js";import{Z as we}from"./zap-CvQdoVrN.js";import{C as ve}from"./clock-DjDmXfdz.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}],["path",{d:"M3.22 13H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"auskq0"}]],Z=ee("heart-pulse",ke);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]],Ce=ee("users-round",_e),J=({title:a,description:p,onBack:g,actions:t})=>e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(H,{variant:"ghost",size:"sm",className:"-ml-2",onClick:g,children:[e.jsx(ye,{className:"mr-2 h-4 w-4"}),"Retour"]}),e.jsx("h2",{className:"text-2xl font-display font-semibold uppercase italic text-primary",children:a}),p?e.jsx("p",{className:"text-sm text-muted-foreground",children:p}):null]}),t?e.jsx("div",{className:"flex items-center gap-2",children:t}):null]}),Se=n.lazy(()=>h(()=>import("./CoachSwimmersOverview-CZnY-Ta6.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]))),Ae=n.lazy(()=>h(()=>import("./CoachMessagesScreen-COIl3V29.js"),__vite__mapDeps([18,1,2,3,4,5,6,7,8,9,19,20,21,22,23,24,25,14,11,12,13,15,16,17]))),Ee=n.lazy(()=>h(()=>import("./CoachSmsScreen-Dfb7-BOS.js"),__vite__mapDeps([26,1,2,4,5,6,7,8,10,19,27,22,28,29,12,30,31,3,9,11,13,14,15,16,17]))),Le=n.lazy(()=>h(()=>import("./CoachCalendar-BFHXN8Ir.js"),__vite__mapDeps([32,1,2,33,34,4,5,6,7,8,15,13,3,9,20,21,22,23,24,25,35,36,37,28,38,39,40,11,12,14,16,17]))),De=n.lazy(()=>h(()=>import("./CoachGroupsScreen-DyKCZrjq.js"),__vite__mapDeps([41,1,2,3,4,5,6,7,8,9,10,42,23,22,43,37,28,44,45,11,46,24,47,40,12,13,14,15,16,17]))),Re=n.lazy(()=>h(()=>import("./CoachCompetitionsScreen-BCVojBbb.js"),__vite__mapDeps([48,1,2,3,4,5,6,7,8,9,19,37,28,22,44,42,23,20,21,24,25,11,12,13,14,15,16,17]))),Te=n.lazy(()=>h(()=>import("./CoachObjectivesScreen-BnGu7ouV.js"),__vite__mapDeps([49,1,2,3,4,5,6,7,8,9,19,10,20,21,22,23,24,25,35,36,37,28,44,50,11,12,13,14,15,16,17]))),Oe=n.lazy(()=>h(()=>import("./CoachTrainingSlotsScreen-DZWxp8oj.js"),__vite__mapDeps([51,1,2,3,4,5,6,7,8,9,10,43,37,28,22,44,20,21,23,24,25,52,36,53,34,15,17,54,40,11,12,13,14,16]))),ze=n.lazy(()=>h(()=>import("./CoachSwimmerDetail-D-Rexszy.js"),__vite__mapDeps([55,1,2,4,5,6,7,8,3,9,56,36,21,10,57,58,24,19,20,22,23,25,35,37,28,44,50,59,60,31,40,61,45,30,17,15,13,54,11]))),Fe=n.lazy(()=>h(()=>import("./StrengthCatalog-DQVhobAk.js"),__vite__mapDeps([62,1,2,3,4,5,6,7,8,9,52,36,21,23,53,19,29,28,22,42,44,56,20,24,25,63,34,64,65,15,39,61,66,40,67,27,12,68,69]))),Ie=n.lazy(()=>h(()=>import("./SwimCatalog-Dxzx8mTF.js"),__vite__mapDeps([70,1,2,3,4,5,6,7,8,9,29,28,22,44,15,71,72,25,73,74,75,24,17,63,34,64,65,21,36,53,39,61,66,40,19,20,23,31,76,59,60,12]))),Pe=n.lazy(()=>h(()=>import("./CoachSlotCalendar-C0YgdMTd.js"),__vite__mapDeps([77,1,2,4,5,6,7,8,10,3,9,37,28,22,42,23,43,44,17,54,68,61,31,78,75,40,74,12,34,15,79])));function V({children:a}){return e.jsxs("div",{className:"flex items-center gap-3 pb-0.5",children:[e.jsx("span",{className:"text-[9px] font-black uppercase tracking-[0.28em] text-muted-foreground/70",children:a}),e.jsx("div",{className:"flex-1 h-px bg-border/50"})]})}function Me({score:a}){if(a==null)return null;const p=Math.round(a),g=a>=3.5?"bg-emerald-500":a>=2.5?"bg-amber-500":"bg-red-500";return e.jsx("div",{className:"flex items-center gap-0.5",children:Array.from({length:5}).map((t,r)=>e.jsx("div",{className:`h-1.5 w-1.5 rounded-full ${r<p?g:"bg-muted"}`},r))})}const Be=({onNavigate:a,onOpenRecordsAdmin:p,onOpenRecordsClub:g,onOpenAthlete:t,athletes:r,athletesLoading:A,kpiLoading:j,fatigueAlerts:d,mostLoadedAthlete:f,formeScores:T,swimSessionCount:I,strengthSessionCount:P})=>{const O=new Date().toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"}),[w,m]=n.useState(""),b=n.useDeferredValue(w.trim().toLocaleLowerCase("fr-FR")),v=n.useMemo(()=>b?r.filter(s=>{const o=s.display_name.toLocaleLowerCase("fr-FR"),N=s.group_label?.toLocaleLowerCase("fr-FR")??"";return o.includes(b)||N.includes(b)}).slice(0,6):r.slice(0,5),[r,b]),c=d.length>0,y={label:"Créer une séance",detail:"Natation · Explorer la bibliothèque",action:()=>a("swim")},z=[{label:"Natation",icon:Q,action:()=>a("swim"),color:"text-cyan-500"},{label:"Muscu",icon:je,action:()=>a("strength"),color:"text-violet-500"},{label:"Groupes",icon:Ce,action:()=>a("groups"),color:"text-emerald-500"},{label:"Échéances",icon:$,action:()=>a("competitions"),color:"text-orange-500"},{label:"Créneaux",icon:ve,action:()=>a("training-slots"),color:"text-blue-500"},{label:"SMS",icon:W,action:()=>a("sms"),color:"text-rose-500"},{label:"Records",icon:q,action:g,color:"text-orange-500"},{label:"Admin rec.",icon:q,action:p,color:"text-slate-500"}];return e.jsxs("div",{className:"space-y-5 pb-24",children:[e.jsx("style",{children:`
        @keyframes cta-breathe {
          0%, 100% { opacity: 0.55; transform: scale(1); }
          50%       { opacity: 0.85; transform: scale(1.06); }
        }
        @keyframes cta-breathe-alert {
          0%, 100% { opacity: 0.45; }
          50%       { opacity: 0.85; }
        }
        @keyframes shimmer-slide {
          0%   { transform: translateX(-100%) skewX(-12deg); }
          100% { transform: translateX(300%) skewX(-12deg); }
        }
        .cta-glow     { animation: cta-breathe 3.5s ease-in-out infinite; }
        .cta-glow-alert { animation: cta-breathe-alert 1.4s ease-in-out infinite; }
        .cta-shimmer  { animation: shimmer-slide 2.8s ease-in-out infinite 0.8s; }
      `}),e.jsxs("div",{className:"sticky top-0 z-20 -mx-4 border-b bg-background/95 px-4 py-3 backdrop-blur",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>a("home"),className:"shrink-0 rounded-full border px-3 py-2 text-sm font-semibold active:bg-muted",children:"Aujourd'hui"}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ne,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(fe,{value:w,onChange:s=>m(s.target.value),placeholder:"Rechercher un nageur",className:"h-10 rounded-full pl-9"})]}),e.jsx(H,{size:"sm",className:"shrink-0 rounded-full",onClick:()=>a("messaging"),children:"Message"})]}),e.jsx("p",{className:"mt-2 text-[11px] uppercase tracking-[0.18em] text-muted-foreground capitalize",children:O})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsx(V,{children:"Le Quotidien"}),e.jsxs("button",{type:"button",onClick:y.action,className:["relative w-full overflow-hidden rounded-3xl text-white transition-all duration-200 active:scale-[0.97]",c?"bg-gradient-to-br from-rose-500 via-red-500 to-orange-500":"bg-gradient-to-br from-primary via-primary/80 to-primary/60"].join(" "),children:[e.jsx("div",{className:c?"cta-glow-alert absolute inset-0":"cta-glow absolute inset-0",style:{background:c?"radial-gradient(ellipse at 20% 60%, rgba(255,80,60,0.6) 0%, transparent 65%)":"radial-gradient(ellipse at 20% 60%, rgba(255,255,255,0.2) 0%, transparent 65%)"}}),e.jsx("div",{className:"cta-shimmer absolute top-0 bottom-0 left-0 w-1/3 pointer-events-none",style:{background:"linear-gradient(90deg, transparent, rgba(255,255,255,0.12), transparent)"}}),e.jsxs("div",{className:"relative flex items-center gap-4 px-6 py-7",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[c&&e.jsxs("div",{className:"mb-2.5 inline-flex items-center gap-1.5 rounded-full bg-white/20 px-2.5 py-1",children:[e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-white opacity-75"}),e.jsx("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-white"})]}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-[0.22em]",children:"Attention requise"})]}),e.jsx("p",{className:"text-[1.6rem] font-bold leading-tight tracking-tight",children:y.label}),e.jsx("p",{className:"mt-1.5 text-sm opacity-75",children:y.detail})]}),e.jsx("div",{className:"flex h-14 w-14 shrink-0 items-center justify-center rounded-2xl bg-white/15 backdrop-blur-sm border border-white/20",children:c?e.jsx(Z,{className:"h-7 w-7 animate-pulse"}):e.jsx(Q,{className:"h-7 w-7"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>a("objectives"),className:"flex items-center gap-2.5 rounded-2xl border bg-card px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-xl bg-amber-100 dark:bg-amber-900/30",children:e.jsx(q,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Objectifs"}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Temps cibles"})]})]}),e.jsxs("button",{type:"button",onClick:()=>a("messaging"),className:"flex items-center gap-2.5 rounded-2xl border bg-card px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-xl bg-blue-100 dark:bg-blue-900/30",children:e.jsx(W,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Message"}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"Notifier un groupe"})]})]})]})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsx(V,{children:"Tour de Contrôle"}),e.jsxs("div",{className:["rounded-3xl border p-4 space-y-3 transition-colors",c?"border-red-200 bg-red-50/70 dark:border-red-900/50 dark:bg-red-950/25":"bg-card border-border"].join(" "),children:[c&&!j&&e.jsx("div",{className:"space-y-1.5",children:d.map(s=>e.jsxs("button",{type:"button",onClick:()=>a("swimmers"),className:"flex w-full items-center gap-3 rounded-2xl bg-white/70 dark:bg-black/20 px-3.5 py-2.5 text-left transition-colors active:bg-white/90",children:[e.jsxs("span",{className:"relative flex h-3 w-3 shrink-0",children:[e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-red-400 opacity-60"}),e.jsx("span",{className:"relative inline-flex h-3 w-3 rounded-full bg-red-500"})]}),e.jsx("span",{className:"flex-1 text-sm font-semibold text-red-900 dark:text-red-200",children:s.athleteName}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-red-600 dark:text-red-400",children:"Fatigue max"}),e.jsx(R,{className:"h-3.5 w-3.5 text-red-400"})]},s.athleteName))}),e.jsxs("div",{className:"grid grid-cols-2 gap-2.5",children:[e.jsxs("div",{className:["rounded-2xl p-3.5",c?"bg-white/50 dark:bg-black/20":"bg-muted/40"].join(" "),children:[e.jsxs("div",{className:"mb-2 flex items-center gap-1.5",children:[e.jsx(Z,{className:`h-3.5 w-3.5 ${d.length>0?"text-red-500":"text-muted-foreground"}`}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-[0.18em] text-muted-foreground",children:"Alertes"})]}),e.jsx("p",{className:`text-4xl font-black tabular-nums leading-none ${d.length>0?"text-red-600 dark:text-red-400":"text-foreground"}`,children:j?"–":d.length}),e.jsx("p",{className:"mt-1.5 text-[11px] text-muted-foreground truncate",children:j?"Calcul…":d.length>0?d.slice(0,2).map(s=>s.athleteName.split(" ")[0]).join(", "):"Aucune alerte"})]}),e.jsxs("div",{className:["rounded-2xl p-3.5",c?"bg-white/50 dark:bg-black/20":"bg-muted/40"].join(" "),children:[e.jsxs("div",{className:"mb-2 flex items-center gap-1.5",children:[e.jsx(we,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-[0.18em] text-muted-foreground",children:"Plus chargé"})]}),e.jsx("p",{className:"text-2xl font-black truncate leading-none",children:j?"–":f?.athleteName?.split(" ")[0]??"–"}),e.jsx("p",{className:"mt-1.5 text-[11px] text-muted-foreground",children:j?"Calcul…":f?`Charge ${Math.round(f.loadScore)}`:"Pas de données"})]})]})]})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-0.5",children:[e.jsx("span",{className:"text-[9px] font-black uppercase tracking-[0.28em] text-muted-foreground/70",children:"Nageurs"}),e.jsx("div",{className:"flex-1 h-px bg-border/50"}),w?e.jsx("button",{type:"button",onClick:()=>m(""),className:"text-[10px] font-bold text-primary",children:"Effacer"}):e.jsxs("button",{type:"button",onClick:()=>a("swimmers"),className:"flex items-center gap-0.5 text-[10px] font-bold text-primary",children:["Tous ",e.jsx(R,{className:"h-3 w-3"})]})]}),e.jsx("div",{className:"overflow-hidden rounded-3xl border bg-card shadow-sm",children:A?e.jsx("div",{className:"divide-y divide-border/60",children:[1,2,3,4].map(s=>e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3.5",children:[e.jsx("div",{className:"h-9 w-9 animate-pulse rounded-full bg-muted"}),e.jsxs("div",{className:"flex-1 space-y-1.5",children:[e.jsx("div",{className:"h-3.5 w-28 animate-pulse rounded bg-muted"}),e.jsx("div",{className:"h-3 w-18 animate-pulse rounded bg-muted"})]})]},s))}):v.length===0?e.jsx("p",{className:"px-4 py-8 text-center text-sm text-muted-foreground",children:"Aucun nageur trouvé."}):e.jsx("div",{className:"divide-y divide-border/60",children:v.map(s=>{const o=d.some(E=>E.athleteName===s.display_name),N=s.display_name.charAt(0).toUpperCase(),F=s.id!=null?T.get(s.id)??null:null;return e.jsxs("button",{type:"button",onClick:()=>t(s),className:"flex w-full items-center gap-3 px-4 py-3.5 text-left transition-colors active:bg-muted",children:[s.avatar_url?e.jsx("img",{src:s.avatar_url,alt:"",className:["h-9 w-9 shrink-0 rounded-full object-cover border",o?"border-red-400/60 ring-2 ring-red-400/60 ring-offset-1":"border-border"].join(" ")}):e.jsx("div",{className:["flex h-9 w-9 shrink-0 items-center justify-center rounded-full text-sm font-bold transition-all",o?"bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-400 ring-2 ring-red-400/60 ring-offset-1":"bg-primary/10 text-primary"].join(" "),children:N}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"truncate text-sm font-semibold",children:s.display_name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"truncate text-[11px] text-muted-foreground",children:s.group_label||"Sans groupe"}),F!=null&&e.jsx(Me,{score:F})]})]}),o?e.jsxs("span",{className:"inline-flex shrink-0 items-center gap-1 rounded-full bg-red-100 px-2.5 py-1 text-[9px] font-black uppercase tracking-widest text-red-600 dark:bg-red-900/30 dark:text-red-400",children:[e.jsx("span",{className:"h-1.5 w-1.5 animate-pulse rounded-full bg-current"}),"Alerte"]}):e.jsx(R,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]},s.id??s.display_name)})})})]}),e.jsxs("section",{className:"space-y-2.5",children:[e.jsx(V,{children:"Arsenal"}),e.jsxs("div",{className:"space-y-2 rounded-3xl border bg-card p-3 shadow-sm",children:[e.jsxs("button",{type:"button",onClick:()=>a("calendar"),className:"flex w-full items-center gap-3 rounded-2xl bg-muted/40 px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-9 w-9 shrink-0 items-center justify-center rounded-xl bg-violet-100 dark:bg-violet-900/30",children:e.jsx($,{className:"h-4.5 w-4.5 text-violet-600 dark:text-violet-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Calendrier · Assigner"}),e.jsxs("p",{className:"text-[11px] text-muted-foreground",children:[I??0," séances nat · ",P??0," muscu"]})]}),e.jsx(R,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]}),e.jsx("div",{className:"grid grid-cols-4 gap-1.5",children:z.map(s=>e.jsxs("button",{type:"button",onClick:s.action,className:"flex flex-col items-center gap-1.5 rounded-2xl border bg-card px-1.5 py-3 text-center transition-colors active:bg-muted",children:[e.jsx(s.icon,{className:`h-4.5 w-4.5 ${s.color}`}),e.jsx("span",{className:"text-[9px] font-semibold leading-tight text-muted-foreground",children:s.label})]},s.label))}),e.jsxs("button",{type:"button",onClick:()=>a("swimmers"),className:"flex w-full items-center gap-3 rounded-2xl bg-muted/40 px-4 py-3.5 text-left transition-colors active:bg-muted",children:[e.jsx("div",{className:"flex h-9 w-9 shrink-0 items-center justify-center rounded-xl bg-blue-100 dark:bg-blue-900/30",children:e.jsx(se,{className:"h-4.5 w-4.5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Voir tous les nageurs"}),e.jsx("p",{className:"text-[11px] text-muted-foreground",children:A?"Chargement…":`${r.length} nageur${r.length>1?"s":""}`})]}),e.jsx(R,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]})]})]})]})},Y=a=>a.toISOString().split("T")[0],qe=a=>new Date(a.completed_at||a.started_at||a.date||a.created_at||0).getTime(),Ve=a=>{if(!a.length)return null;const p=a.reduce((t,r)=>t+r,0)/a.length,g=Math.min(5,Math.max(1,Math.round(p)));return{average:p,rating:g}};function $e(){const a=X(s=>s.role),p=X(s=>s.setSelectedAthlete),[,g]=ue(),[t,r]=n.useState(()=>window.location.hash.match(/[?&]section=([^&]+)/)?.[1]||"home"),A=7,[j,d]=n.useState(null);n.useEffect(()=>{const s="/coach",o=t&&t!=="home"?`#${s}?section=${t}`:`#${s}`;window.location.hash!==o&&window.history.replaceState(null,"",o)},[t]),n.useEffect(()=>{const s=()=>{r("home"),d(null)};return window.addEventListener("nav:reset",s),()=>window.removeEventListener("nav:reset",s)},[]),n.useEffect(()=>{const s=o=>{const N=o.detail;r(N),d(null)};return window.addEventListener("nav:section",s),()=>window.removeEventListener("nav:section",s)},[]);const f=a==="coach"||a==="admin",T=t==="home"||t==="calendar",I=t==="home"||t==="messaging"||t==="sms"||t==="swimmers"||t==="athlete"||t==="calendar"||t==="groups"||t==="objectives",P=t==="messaging"||t==="sms"||t==="calendar"||t==="groups"||t==="training-slots",{data:O}=D({queryKey:["swim_catalog"],queryFn:()=>S.getSwimCatalog(),enabled:f&&T}),{data:w}=D({queryKey:["strength_catalog"],queryFn:()=>S.getStrengthSessions(),enabled:f&&T}),{data:m=[],isLoading:b}=D({queryKey:["athletes"],queryFn:()=>S.getAthletes(),enabled:f&&I}),v=n.useMemo(()=>m.slice(0,5),[m]),{data:c=[]}=D({queryKey:["groups"],queryFn:()=>S.getGroups(),enabled:f&&P}),y=D({queryKey:["coach-kpis",A,v.map(s=>s.id??s.display_name)],enabled:f&&t==="home"&&v.length>0,queryFn:async()=>{const s=A,o=new Date;o.setDate(o.getDate()-s);const N=Y(o),F=Y(new Date),E=await Promise.all(v.map(async i=>{const[M,ne]=await Promise.all([S.getSessions(i.display_name,i.id),S.getStrengthHistory(i.display_name,{athleteId:i.id,limit:50,from:N,to:F})]),B=M.filter(l=>new Date(l.date).getTime()>=o.getTime()),re=B.map(l=>l.fatigue??l.feeling).filter(l=>Number.isFinite(l)),le=B.reduce((l,u)=>l+(Number(u.duration)||0)*(Number(u.effort)||0),0),U=(ne?.runs??[]).filter(l=>qe(l)>=o.getTime()),ie=U.map(l=>l.fatigue??l.feeling??l.rpe).filter(l=>Number.isFinite(Number(l))).map(l=>Number(l)),oe=U.reduce((l,u)=>{const _=Number(u.feeling??u.rpe??0),C=Number(u.duration??0);if(C>0&&_>0)return l+C*_;const L=Array.isArray(u.logs)?u.logs.length:0;return l+L*5},0),ce=Ve([...re,...ie]),k=B[0];let G=null;if(k){const l=[],u=k.effort,_=k.fatigue??k.feeling,C=k.performance,L=k.engagement;u!=null&&Number.isFinite(u)&&l.push(6-u),_!=null&&Number.isFinite(_)&&l.push(6-_),C!=null&&Number.isFinite(C)&&l.push(C),L!=null&&Number.isFinite(L)&&l.push(L),l.length>0&&(G=Math.round(l.reduce((de,me)=>de+me,0)/l.length*10)/10)}return{athleteId:i.id,athleteName:i.display_name,loadScore:le+oe,fatigueRating:ce,formeScore:G}})),te=E.filter(i=>i.fatigueRating?.rating===5).map(i=>({athleteName:i.athleteName,rating:i.fatigueRating?.rating??0})),ae=E.filter(i=>i.loadScore>0).sort((i,M)=>M.loadScore-i.loadScore)[0],K=new Map;for(const i of E)i.athleteId!=null&&K.set(i.athleteId,i.formeScore);return{fatigueAlerts:te,mostLoadedAthlete:ae??null,formeScores:K}}}),z=s=>{if(p({id:s.id??null,name:s.display_name}),s.id==null){g("/progress");return}d(s),r("athlete")};return f?e.jsxs("div",{className:"space-y-6",children:[t==="home"?e.jsx(Be,{onNavigate:r,onOpenRecordsAdmin:()=>g("/records-admin"),onOpenRecordsClub:()=>g("/records-club"),onOpenAthlete:z,athletes:m,athletesLoading:b,kpiLoading:y.isLoading,fatigueAlerts:y.data?.fatigueAlerts??[],mostLoadedAthlete:y.data?.mostLoadedAthlete??null,formeScores:y.data?.formeScores??new Map,swimSessionCount:O?.length,strengthSessionCount:w?.length}):null,t==="swim"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Pe,{onBack:()=>r("home"),onOpenLibrary:()=>r("swim-library")})}):null,t==="swim-library"?e.jsxs("div",{className:"space-y-6",children:[e.jsx(J,{title:"Bibliothèque natation",description:"Templates de séances.",onBack:()=>r("swim")}),e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Ie,{})})]}):null,t==="strength"?e.jsxs("div",{className:"space-y-6",children:[e.jsx(J,{title:"Bibliothèque musculation",description:"Consultez et créez des séances musculation.",onBack:()=>r("home"),actions:e.jsxs(H,{variant:"outline",size:"sm",onClick:()=>r("calendar"),children:[e.jsx($,{className:"mr-1.5 h-3.5 w-3.5"}),"Assigner"]})}),e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Fe,{})})]}):null,t==="swimmers"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Se,{athletes:m,athletesLoading:b,onBack:()=>r("home"),onOpenAthlete:z})}):null,t==="athlete"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(ze,{athleteId:j?.id??null,athleteName:j?.display_name??null,onBack:()=>r("home")})}):null,t==="messaging"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Ae,{onBack:()=>r("home"),athletes:m,groups:c,athletesLoading:b})}):null,t==="sms"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Ee,{onBack:()=>r("home"),athletes:m,groups:c,athletesLoading:b})}):null,t==="calendar"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Le,{onBack:()=>r("home"),athletes:m,groups:c,swimSessions:O,strengthSessions:w})}):null,t==="groups"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(De,{onBack:()=>r("home"),athletes:m,groups:c,athletesLoading:b})}):null,t==="competitions"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Re,{onBack:()=>r("home")})}):null,t==="objectives"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Te,{onBack:()=>r("home"),athletes:m,athletesLoading:b})}):null,t==="training-slots"?e.jsx(n.Suspense,{fallback:e.jsx(x,{}),children:e.jsx(Oe,{onBack:()=>r("home"),groups:c})}):null]}):e.jsx("div",{className:"flex items-center justify-center min-h-[60vh] animate-in fade-in motion-reduce:animate-none",children:e.jsxs(xe,{className:"w-full max-w-sm shadow-xl border-t-4 border-t-primary",children:[e.jsxs(he,{children:[e.jsxs(pe,{className:"flex items-center gap-2 uppercase italic",children:[e.jsx(se,{className:"h-5 w-5 text-primary"}),"Accès Coach"]}),e.jsx(ge,{children:"Cette section est réservée aux coachs et administrateurs."})]}),e.jsx(be,{children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Connectez-vous avec un compte autorisé pour accéder aux outils de gestion."})})]})})}const ss=Object.freeze(Object.defineProperty({__proto__:null,default:$e},Symbol.toStringTag,{value:"Module"}));export{J as C,Ce as U,ss as a};
