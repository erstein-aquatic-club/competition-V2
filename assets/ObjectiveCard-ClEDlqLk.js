import{j as t}from"./vendor-query-DyA9aSKS.js";import{B as p}from"./badge-DpymrwRv.js";const M=["50NL","100NL","200NL","400NL","800NL","1500NL","50DOS","100DOS","200DOS","50BR","100BR","200BR","50PAP","100PAP","200PAP","200QN","400QN"];function g(e){const n=e.match(/^(\d+)(NL|DOS|BR|PAP|QN)$/);if(!n)return e;const s={NL:"Nage Libre",DOS:"Dos",BR:"Brasse",PAP:"Papillon",QN:"4 Nages"};return`${n[1]}m ${s[n[2]]||n[2]}`}function x(e){const n=Math.floor(e/60),s=e%60,a=Math.floor(s),l=Math.round((s-a)*100);return`${n}:${String(a).padStart(2,"0")}:${String(l).padStart(2,"0")}`}function v(e){const n=e.match(/^(\d+):(\d{2})[.::](\d{2})$/);return n?parseInt(n[1])*60+parseInt(n[2])+parseInt(n[3])/100:null}const L={"50NL":["50 NL","50 Nage Libre"],"100NL":["100 NL","100 Nage Libre"],"200NL":["200 NL","200 Nage Libre"],"400NL":["400 NL","400 Nage Libre"],"800NL":["800 NL","800 Nage Libre"],"1500NL":["1500 NL","1500 Nage Libre"],"50DOS":["50 Dos"],"100DOS":["100 Dos"],"200DOS":["200 Dos"],"50BR":["50 Brasse","50 Bra."],"100BR":["100 Brasse","100 Bra."],"200BR":["200 Brasse","200 Bra."],"50PAP":["50 Papillon","50 Pap","50 Pap."],"100PAP":["100 Papillon","100 Pap","100 Pap."],"200PAP":["200 Papillon","200 Pap","200 Pap."],"200QN":["200 4 Nages","200 4N","200 4 N."],"400QN":["400 4 Nages","400 4N","400 4 N."]},B={NL:"border-l-blue-500",DOS:"border-l-emerald-500",BR:"border-l-red-500",PAP:"border-l-violet-500",QN:"border-l-amber-500"};function D(e){const n=e.match(/^(\d+)(NL|DOS|BR|PAP|QN)$/);return n?n[2]:null}const O={50:1,100:4,200:10,400:15,800:30,1500:45};function S(e){const n=e.match(/^(\d+)(NL|DOS|BR|PAP|QN)$/);return n?Number(n[1]):null}function w(e,n,s){if(e<=n)return 100;const a=S(s),l=a?O[a]??10:10,r=n+l;return e>=r?0:Math.round((r-e)/(r-n)*100)}function y(e,n,s){const a=L[n];if(!a)return null;const l=a.map(o=>o.toLowerCase());let r=null;for(const o of e)o.time_seconds!=null&&l.includes(o.event_code.toLowerCase())&&(s!=null&&o.pool_length!=null&&o.pool_length!==s||(r===null||o.time_seconds<r.time)&&(r={time:o.time_seconds,date:o.competition_date??null}));return r}function j(e){return e>=100?"bg-emerald-500":e>=75?"bg-green-500":e>=50?"bg-yellow-500":e>=25?"bg-orange-500":"bg-red-500"}function R(e){const n=new Date;n.setHours(0,0,0,0);const s=new Date(e+"T00:00:00");return Math.ceil((s.getTime()-n.getTime())/(1e3*60*60*24))}const $={NL:"#3b82f6",DOS:"#10b981",BR:"#f43f5e",PAP:"#8b5cf6",QN:"#f59e0b"},_="#a1a1aa",A={NL:"border-t-blue-500",DOS:"border-t-emerald-500",BR:"border-t-rose-500",PAP:"border-t-violet-500",QN:"border-t-amber-500"};function E(e){const n=new Date(e+"T00:00:00"),s=new Date;s.setHours(0,0,0,0);const a=Math.round((s.getTime()-n.getTime())/(1e3*60*60*24));return a<=0?"aujourd'hui":a===1?"hier":a<60?`il y a ${a}j`:`il y a ${Math.round(a/30)}m`}function f({size:e=40,strokeWidth:n=3,progress:s,color:a}){const l=(e-n)/2,r=2*Math.PI*l,o=s!=null?Math.min(Math.max(s,0),100):0,m=r-o/100*r;return t.jsxs("svg",{width:e,height:e,viewBox:`0 0 ${e} ${e}`,className:"shrink-0","aria-hidden":!0,children:[t.jsx("circle",{cx:e/2,cy:e/2,r:l,fill:"none",stroke:"currentColor",strokeWidth:n,className:"text-muted-foreground/10"}),s!=null&&t.jsx("circle",{cx:e/2,cy:e/2,r:l,fill:"none",stroke:a,strokeWidth:n,strokeDasharray:r,strokeDashoffset:m,strokeLinecap:"round",transform:`rotate(-90 ${e/2} ${e/2})`,className:"transition-all duration-700"}),s==null&&t.jsx("circle",{cx:e/2,cy:e/2,r:3,fill:a})]})}function Q({children:e}){return t.jsx("div",{className:"grid grid-cols-2 gap-2",children:e})}function C({objective:e,performances:n=[],onClick:s,compact:a=!1,showCoachBadge:l=!1}){const r=!!e.event_code,o=r?D(e.event_code):null,m=o?$[o]??_:_,N=o?A[o]??"":"",P=o?B[o]??"":"",d=r?y(n,e.event_code,e.pool_length):null;let i=null,c=null;d&&e.target_time_seconds!=null&&e.event_code&&(i=d.time-e.target_time_seconds,c=w(d.time,e.target_time_seconds,e.event_code));const b=!!e.competition_name,u=e.competition_date?R(e.competition_date):null,h=s?"button":"div";return a?t.jsxs(h,{type:s?"button":void 0,className:["w-full text-left flex items-center gap-2.5 rounded-lg border-l-4 px-2.5 py-1.5",P||"border-l-muted-foreground/20","bg-card transition-colors hover:bg-muted/30 active:scale-[0.995]"].join(" "),onClick:s,children:[t.jsx(f,{size:22,strokeWidth:2.5,progress:c,color:m}),t.jsxs("div",{className:"flex-1 min-w-0 flex items-baseline gap-1.5",children:[t.jsx("span",{className:"text-xs font-semibold truncate",children:r?g(e.event_code):e.text??"—"}),r&&e.pool_length&&t.jsxs("span",{className:"text-[10px] text-muted-foreground/50 shrink-0",children:[e.pool_length,"m"]})]}),e.target_time_seconds!=null&&t.jsx("span",{className:"text-[11px] font-mono tabular-nums text-primary shrink-0",children:x(e.target_time_seconds)}),i!=null&&t.jsx("span",{className:`text-[10px] font-mono tabular-nums shrink-0 ${i<=0?"text-emerald-500 font-semibold":"text-muted-foreground/60"}`,children:i<=0?"OK":`+${i.toFixed(2)}`}),l&&t.jsx(p,{variant:"secondary",className:"text-[8px] px-1 py-0 leading-tight shrink-0",children:"C"})]}):t.jsx(h,{type:s?"button":void 0,className:["w-full text-left rounded-xl border shadow-sm bg-card overflow-hidden",N?`border-t-[3px] ${N}`:"","transition-all hover:shadow-md active:scale-[0.98]"].join(" "),onClick:s,children:t.jsxs("div",{className:"px-3 pt-3 pb-2.5 space-y-2",children:[t.jsxs("div",{className:"flex items-start justify-between gap-1",children:[t.jsxs("div",{className:"min-w-0",children:[t.jsx("p",{className:"text-sm font-semibold truncate leading-tight",children:r?g(e.event_code):"Objectif"}),r&&e.pool_length&&t.jsxs("p",{className:"text-[10px] text-muted-foreground/50 mt-0.5",children:[e.pool_length,"m"]})]}),l&&t.jsx(p,{variant:"secondary",className:"text-[9px] px-1 py-0 leading-tight shrink-0",children:"Coach"})]}),e.text&&t.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 leading-relaxed",children:e.text}),e.target_time_seconds!=null&&t.jsxs("div",{className:"flex items-center gap-2.5",children:[t.jsx(f,{size:40,strokeWidth:3,progress:c,color:m}),t.jsxs("div",{className:"flex-1 min-w-0 space-y-0.5",children:[t.jsx("p",{className:"text-sm font-mono tabular-nums text-primary font-semibold leading-none",children:x(e.target_time_seconds)}),d&&t.jsxs("p",{className:"text-[10px] font-mono tabular-nums text-muted-foreground/50 leading-none",children:[x(d.time),d.date&&t.jsx("span",{className:"text-muted-foreground/30 font-sans ml-1",children:E(d.date)})]}),i!=null&&t.jsx("p",{className:`text-xs font-mono tabular-nums font-semibold leading-none ${i<=0?"text-emerald-500":"text-amber-500"}`,children:i<=0?"Atteint":`+${i.toFixed(2)}s`}),!d&&n.length>0&&t.jsx("p",{className:"text-[10px] text-muted-foreground/40 italic",children:"Pas encore de temps"})]})]}),!r&&t.jsxs("div",{className:"flex items-center gap-2.5",children:[t.jsx(f,{size:40,strokeWidth:3,progress:null,color:m}),t.jsx("p",{className:"text-[10px] text-muted-foreground/40 italic",children:"Objectif qualitatif"})]}),c!=null&&t.jsx("div",{className:"h-1 w-full rounded-full bg-black/5 dark:bg-white/5 overflow-hidden",children:t.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${j(c)}`,style:{width:`${Math.min(c,100)}%`}})}),b&&t.jsxs("p",{className:"text-[10px] text-muted-foreground/50 truncate",children:[e.competition_name,u!=null&&u>0&&t.jsxs("span",{children:[" · J-",u]})]})]})})}export{M as F,C as O,Q as a,g as e,x as f,v as p};
