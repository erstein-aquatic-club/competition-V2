import{r as d,j as e,c as Es,u as J,d as P}from"./vendor-query-DyA9aSKS.js";import{a as k}from"./api-DIuKLiVz.js";import{c as Ze,D as ye,C as ks,a as Y,L as j,I as S,P as Z,d as Ds,B as $,f as oe,s as Pe}from"./index-DfCTHwSJ.js";import{R as Fs,a as Ae}from"./radio-group-BD3I5JME.js";import{T as ee}from"./textarea-D2BcR9Gs.js";import{D as se,a as te,b as fe,c as ge}from"./dialog-BXpltr_-.js";import{C as Te}from"./checkbox-hsJ2hayB.js";import{A as qe,a as Re,b as Oe,c as $e,d as Ke,e as Qe,f as Le,g as ze}from"./alert-dialog-BopAuMhG.js";import{T as es,a as ss,b as je,c as ve}from"./tabs-CMDRENcy.js";import{S as de,a as ue,b as me,c as xe,d as T}from"./select-C4AVB2qK.js";import{A as Ms,a as Is,F as Ps,S as As,b as Ts,c as qs,d as Ue}from"./SessionListView-S-kasCwM.js";import{D as Rs,a as Os,b as $s,c as Ks}from"./drawer-BEZ7rx6Q.js";import{C as Qs,c as Ls,d as zs,e as Us,f as Be,g as Bs,P as ts,a as rs,b as ns}from"./command-DdnxVnds.js";import{C as is}from"./chevron-down-DLWAi4Ep.js";import{C as Gs}from"./index-CXOr2eWV.js";import{T as Ne}from"./trash-2-UzlyXWd_.js";import{F as Ws}from"./Coach-CV6LSxDu.js";import{C as Vs}from"./chevron-right-wZxBeQZj.js";import{P as Hs}from"./pencil-Dd28Sc-a.js";import{L as Ge}from"./loader-circle-vc8M5JUO.js";import{C as Js}from"./circle-alert-Bz0TPjta.js";import{S as Xs}from"./search-BEXCl-FJ.js";import{P as Ys}from"./pen-BbCLs8WE.js";import"./vendor-react-BzrpNAyj.js";import"./swim-BAOxK4yQ.js";import"./vendor-charts-BrQ8X25f.js";import"./vendor-supabase-DFPLkPj_.js";import"./vendor-motion-lao-Njgm.js";import"./index-BqzabBji.js";import"./index-BmscoyfW.js";import"./circle-DKmWFn9e.js";import"./index-Csq_I9bq.js";import"./chevron-up-16geqd_h.js";import"./chevron-left-CIdP6Ax0.js";import"./play-5mLYkvdk.js";import"./save-CcGKTnVe.js";import"./share-2-D-fXWqeX.js";import"./arrow-left-D1A-trWm.js";import"./badge-B4vNJuhd.js";import"./zap-C2JaxEWi.js";import"./message-square-V8wf0u-o.js";import"./trophy-D0MFdRrH.js";import"./clock-DJe0pGSV.js";import"./bell-ring-BaKoQcBx.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],et=Ze("ellipsis",Zs);/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],We=Ze("upload",st);function tt({exercises:t,selectedId:n,onSelect:x}){const[c,u]=d.useState(!1),o=t.find(i=>i.id===n),v=t.filter(i=>i.exercise_type!=="warmup"),g=t.filter(i=>i.exercise_type==="warmup"),N=i=>{x(i),u(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",onClick:()=>u(!0),className:"flex w-full items-center gap-2 rounded-xl border border-input bg-background px-3 py-2 text-sm hover:bg-accent/50",children:[o?.illustration_gif?e.jsx("img",{src:o.illustration_gif,alt:"",className:"h-7 w-7 shrink-0 rounded-md object-cover"}):e.jsx("div",{className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-md bg-muted",children:e.jsx(ye,{className:"h-3.5 w-3.5 text-muted-foreground"})}),e.jsx("span",{className:"min-w-0 flex-1 truncate text-left font-medium",children:o?.nom_exercice??"Choisir un exercice"}),e.jsx(is,{className:"h-4 w-4 shrink-0 text-muted-foreground"})]}),e.jsx(Rs,{open:c,onOpenChange:u,children:e.jsxs(Os,{className:"max-h-[85vh]",children:[e.jsx($s,{className:"pb-0",children:e.jsx(Ks,{children:"Choisir un exercice"})}),e.jsxs(Qs,{className:"mt-2",shouldFilter:!0,children:[e.jsx(Ls,{placeholder:"Rechercher...",className:"h-12"}),e.jsxs(zs,{className:"max-h-[60vh] px-1 pb-safe",children:[e.jsx(Us,{children:"Aucun exercice trouvé"}),v.length>0&&e.jsx(Be,{heading:"Travail",children:v.map(i=>e.jsx(Ve,{exercise:i,isSelected:i.id===n,onSelect:()=>N(i.id)},i.id))}),g.length>0&&e.jsx(Be,{heading:"Échauffement",children:g.map(i=>e.jsx(Ve,{exercise:i,isSelected:i.id===n,onSelect:()=>N(i.id)},i.id))})]})]})]})})]})}function Ve({exercise:t,isSelected:n,onSelect:x}){return e.jsxs(Bs,{value:t.nom_exercice,onSelect:x,className:"flex items-center gap-3 rounded-xl px-2 py-2.5",children:[t.illustration_gif?e.jsx("img",{src:t.illustration_gif,alt:"",className:"h-9 w-9 shrink-0 rounded-lg object-cover",loading:"lazy",decoding:"async"}):e.jsx("div",{className:"flex h-9 w-9 shrink-0 items-center justify-center rounded-lg bg-muted",children:e.jsx(ye,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx("span",{className:"min-w-0 flex-1 truncate text-sm font-medium",children:t.nom_exercice}),n&&e.jsx(Gs,{className:"h-4 w-4 shrink-0 text-primary"})]})}function rt({exercise:t,exercises:n,exerciseFilter:x,index:c,totalItems:u,onChange:o,onDelete:v,onMoveUp:g,onMoveDown:N}){const[i,p]=d.useState(!1),[y,M]=d.useState(!1),F=n.filter(m=>x==="all"?!0:m.exercise_type===x),C=n.find(m=>m.id===t.exercise_id),D=C?.nom_exercice??"Exercice",q=C?.exercise_type==="warmup",h=C?.illustration_gif;return e.jsxs(e.Fragment,{children:[e.jsxs(ks,{className:Y("rounded-2xl border-border transition-all",i&&"ring-1 ring-primary/20"),children:[e.jsxs("button",{type:"button",className:"flex w-full items-center gap-3 p-3 text-left",onClick:()=>p(!i),children:[e.jsx("span",{className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-full bg-muted text-xs font-bold text-muted-foreground",children:c+1}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"truncate text-sm font-semibold",children:D}),q&&e.jsx("span",{className:"shrink-0 rounded-full bg-amber-100 px-2 py-0.5 text-[10px] font-semibold text-amber-800",children:"Échauf."})]}),e.jsxs("div",{className:"mt-0.5 text-xs text-muted-foreground",children:[t.sets,"×",t.reps,t.percent_1rm?` @ ${t.percent_1rm}% 1RM`:"",t.rest_seconds?` · ${t.rest_seconds}s repos`:""]})]}),h&&e.jsx("button",{type:"button",className:"shrink-0 rounded-lg overflow-hidden border border-border bg-muted",onClick:m=>{m.stopPropagation(),M(!0)},children:e.jsx("img",{src:h,alt:D,className:"h-9 w-9 object-cover"})}),e.jsx(is,{className:Y("h-4 w-4 shrink-0 text-muted-foreground transition-transform",i&&"rotate-180")})]}),i&&e.jsxs("div",{className:"border-t border-border px-3 pb-3 pt-3 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(j,{className:"text-xs",children:"Séries"}),e.jsx(S,{type:"number",inputMode:"numeric",value:t.sets===0?"":t.sets,onChange:m=>o("sets",m.target.value===""?0:Number(m.target.value)),className:"rounded-xl h-10"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(j,{className:"text-xs",children:"Reps"}),e.jsx(S,{type:"number",inputMode:"numeric",value:t.reps===0?"":t.reps,onChange:m=>o("reps",m.target.value===""?0:Number(m.target.value)),className:"rounded-xl h-10"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(j,{className:"text-xs",children:"% 1RM"}),e.jsx(S,{type:"number",inputMode:"numeric",value:t.percent_1rm===0?"":t.percent_1rm,onChange:m=>o("percent_1rm",m.target.value===""?0:Number(m.target.value)),className:"rounded-xl h-10"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(j,{className:"text-xs",children:"Repos (s)"}),e.jsx(S,{type:"number",inputMode:"numeric",value:t.rest_seconds===0?"":t.rest_seconds,onChange:m=>o("rest_seconds",m.target.value===""?0:Number(m.target.value)),className:"rounded-xl h-10"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(j,{className:"text-xs",children:"Exercice"}),e.jsx(tt,{exercises:F,selectedId:t.exercise_id,onSelect:m=>o("exercise_id",m)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(j,{className:"text-xs",children:"Notes"}),e.jsx(ee,{value:t.notes??"",onChange:m=>o("notes",m.target.value||null),placeholder:"Notes optionnelles...",className:"rounded-xl min-h-[60px]"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{type:"button",onClick:m=>{m.stopPropagation(),g()},disabled:c===0,className:"inline-flex h-9 w-9 items-center justify-center rounded-full hover:bg-muted disabled:opacity-30","aria-label":"Monter",children:e.jsx(Ms,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:m=>{m.stopPropagation(),N()},disabled:c===u-1,className:"inline-flex h-9 w-9 items-center justify-center rounded-full hover:bg-muted disabled:opacity-30","aria-label":"Descendre",children:e.jsx(Is,{className:"h-4 w-4"})})]}),e.jsxs("button",{type:"button",onClick:m=>{m.stopPropagation(),v()},className:"inline-flex h-9 items-center gap-2 rounded-full px-3 text-xs font-medium text-destructive hover:bg-destructive/10",children:[e.jsx(Ne,{className:"h-3.5 w-3.5"}),"Supprimer"]})]})]})]}),h&&e.jsx(se,{open:y,onOpenChange:M,children:e.jsx(te,{className:"sm:max-w-md p-2",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("img",{src:h,alt:D,className:"w-full max-h-[70vh] object-contain rounded-lg"}),e.jsx("p",{className:"text-sm font-medium text-center",children:D})]})})})]})}const nt=t=>t==="endurance"||t==="hypertrophie"||t==="force"?t:"endurance";function it({session:t,exercises:n,editingSessionId:x,folders:c,onSessionChange:u,onCycleChange:o,onSave:v,onCancel:g,onAddItem:N,onUpdateItem:i,onRemoveItem:p,onReorderItems:y,onExerciseDialogOpen:M,isSaving:F}){const[C,D]=d.useState("all"),[q,h]=d.useState(!1),[m,B]=d.useState(!1),K=new Map(n.map(l=>[l.id,l])),z=t.items.reduce((l,_)=>l+(_.sets||0),0),Q=l=>{l>0&&y(l,l-1)},re=l=>{l<t.items.length-1&&y(l,l+1)},U=()=>{h(!0)};return e.jsxs("div",{className:"space-y-4 animate-in slide-in-from-bottom-4",children:[e.jsx(Ps,{isEditing:!!x,isSaving:F,onSave:v,onCancel:g,onPreview:U}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx(As,{name:t.title,onNameChange:l=>u({...t,title:l}),showDuration:!1,showTotalDistance:!1,collapsible:!0,collapsed:m,onToggleCollapse:()=>B(!m),collapsedSummary:e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-medium text-foreground",children:t.title||"Sans titre"}),e.jsx("span",{children:"·"}),e.jsx("span",{className:"capitalize",children:t.cycle}),e.jsx("span",{children:"·"}),e.jsxs("span",{children:[z," séries"]})]}),additionalFields:e.jsxs(e.Fragment,{children:[c&&c.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground",children:"Dossier"}),e.jsx("div",{className:"mt-1",children:e.jsxs(de,{value:t.folder_id?.toString()??"none",onValueChange:l=>u({...t,folder_id:l==="none"?null:parseInt(l)}),children:[e.jsx(ue,{className:"rounded-2xl",children:e.jsx(me,{})}),e.jsxs(xe,{children:[e.jsx(T,{value:"none",children:"Aucun"}),c.map(l=>e.jsx(T,{value:l.id.toString(),children:l.name},l.id))]})]})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground",children:"Cycle"}),e.jsx("div",{className:"mt-1",children:e.jsxs(de,{value:t.cycle,onValueChange:l=>o(nt(l)),children:[e.jsx(ue,{className:"rounded-2xl",children:e.jsx(me,{})}),e.jsxs(xe,{children:[e.jsx(T,{value:"endurance",children:"Endurance"}),e.jsx(T,{value:"hypertrophie",children:"Hypertrophie"}),e.jsx(T,{value:"force",children:"Force"})]})]})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground",children:"Séries totales"}),e.jsx("div",{className:"mt-1 rounded-2xl border border-border bg-muted px-3 py-2 text-sm font-semibold",children:z})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground",children:"Description"}),e.jsx("div",{className:"mt-1",children:e.jsx(ee,{value:t.description,onChange:l=>u({...t,description:l.target.value}),placeholder:"Description optionnelle...",className:"rounded-2xl min-h-[60px]"})})]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm font-semibold",children:["Exercices (",t.items.length,")"]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(de,{value:C,onValueChange:l=>D(l),children:[e.jsxs(ue,{className:"h-8 w-auto gap-1 rounded-full border-dashed text-xs",children:[e.jsx(Ws,{className:"h-3 w-3"}),e.jsx(me,{})]}),e.jsxs(xe,{children:[e.jsx(T,{value:"all",children:"Tous"}),e.jsx(T,{value:"strength",children:"Travail"}),e.jsx(T,{value:"warmup",children:"Échauf."})]})]})})]}),e.jsx("div",{className:"space-y-2",children:t.items.map((l,_)=>e.jsx(rt,{exercise:l,exercises:n,exerciseFilter:C,index:_,totalItems:t.items.length,onChange:(R,G)=>i(_,R,G),onDelete:()=>p(_),onMoveUp:()=>Q(_),onMoveDown:()=>re(_)},`${l.exercise_id}-${_}`))}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{type:"button",onClick:N,className:"inline-flex items-center gap-2 rounded-full bg-primary px-4 py-2 text-xs font-semibold text-primary-foreground",children:[e.jsx(Z,{className:"h-4 w-4"})," Ajouter un exercice"]}),e.jsxs("button",{type:"button",onClick:M,className:"inline-flex items-center gap-2 rounded-full border border-border px-4 py-2 text-xs font-semibold hover:bg-muted",children:[e.jsx(Z,{className:"h-4 w-4"})," Nouvel exercice"]})]})]}),e.jsx(se,{open:q,onOpenChange:h,children:e.jsxs(te,{className:"sm:max-w-3xl",children:[e.jsx(fe,{children:e.jsx(ge,{children:"Aperçu de la séance"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-lg font-semibold",children:t.title||"Sans titre"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.description||"—"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Cycle : ",t.cycle]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Exercices"}),e.jsx("div",{className:"space-y-2",children:t.items.slice().sort((l,_)=>(l.order_index??0)-(_.order_index??0)).map((l,_)=>{const R=K.get(l.exercise_id);return e.jsxs("div",{className:"rounded-xl border px-3 py-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("span",{className:"font-medium",children:[_+1,". ",R?.nom_exercice??"Exercice"]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:R?.exercise_type==="warmup"?"Échauffement":"Travail"})]}),e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:[l.sets," séries • ",l.reps," reps • ",l.percent_1rm,"% 1RM •"," ",l.rest_seconds,"s"]})]},`${l.exercise_id}-${_}`)})})]})]})]})})]})}function He({name:t,count:n,children:x,onRename:c,onDelete:u,defaultOpen:o=!1}){const[v,g]=d.useState(o),[N,i]=d.useState(!1),[p,y]=d.useState(t),[M,F]=d.useState(!1),C=d.useRef(null);d.useEffect(()=>{N&&(C.current?.focus(),C.current?.select())},[N]);const D=()=>{const h=p.trim();h&&h!==t?c(h):y(t),i(!1)},q=()=>{y(t),i(!1)};return e.jsxs("div",{children:[e.jsxs("div",{className:Y("flex items-center gap-1 rounded-xl px-2 py-1.5 cursor-pointer select-none hover:bg-muted/50"),onClick:()=>{N||g(h=>!h)},children:[e.jsx(Vs,{className:Y("h-4 w-4 shrink-0 text-muted-foreground transition-transform",v&&"rotate-90")}),N?e.jsx(S,{ref:C,className:"h-7 text-sm rounded-lg flex-1",value:p,onChange:h=>y(h.target.value),onClick:h=>h.stopPropagation(),onKeyDown:h=>{h.stopPropagation(),h.key==="Enter"&&D(),h.key==="Escape"&&q()},onBlur:D}):e.jsx("span",{className:"text-sm font-semibold truncate",children:t}),!N&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",n,")"]}),e.jsx("div",{className:"flex-1"}),e.jsxs(ts,{open:M,onOpenChange:F,children:[e.jsx(rs,{asChild:!0,children:e.jsx("button",{className:"h-10 w-10 shrink-0 inline-flex items-center justify-center rounded-full hover:bg-muted",onClick:h=>{h.stopPropagation()},children:e.jsx(et,{className:"h-4 w-4 text-muted-foreground"})})}),e.jsxs(ns,{align:"end",className:"w-40 p-1",onClick:h=>h.stopPropagation(),children:[e.jsxs("button",{className:"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm hover:bg-muted",onClick:()=>{F(!1),y(t),i(!0)},children:[e.jsx(Hs,{className:"h-4 w-4"}),"Rename"]}),e.jsxs("button",{className:"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm text-destructive hover:bg-muted",onClick:()=>{F(!1),u()},children:[e.jsx(Ne,{className:"h-4 w-4"}),"Delete"]})]})]})]}),v&&e.jsx("div",{className:"ml-4",children:x})]})}function pe({folders:t,currentFolderId:n,onMove:x,children:c}){const[u,o]=d.useState(!1);function v(g){x(g),o(!1)}return e.jsxs(ts,{open:u,onOpenChange:o,children:[e.jsx(rs,{asChild:!0,children:c??e.jsx("button",{className:"flex h-9 w-9 items-center justify-center rounded-full hover:bg-muted","aria-label":"Déplacer",title:"Déplacer vers un dossier",children:e.jsx(Ts,{className:"h-4 w-4"})})}),e.jsxs(ns,{className:"w-44 p-1",align:"end",children:[e.jsx("button",{className:"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm hover:bg-muted",style:{fontWeight:n?void 0:"bold"},onClick:()=>v(null),children:"Aucun dossier"}),t.map(g=>e.jsx("button",{className:"flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-sm hover:bg-muted",style:{fontWeight:n===g.id?"bold":void 0},onClick:()=>v(g.id),children:g.name},g.id))]})]})}const Je=[{key:"endurance",label:"Endurance",fieldSuffix:"endurance"},{key:"hypertrophie",label:"Hypertrophie",fieldSuffix:"hypertrophie"},{key:"force",label:"Force",fieldSuffix:"force"}],at=t=>t==="endurance"||t==="hypertrophie"||t==="force"?t:"endurance",Xe=({exercise:t,onChange:n,disabled:x=!1})=>e.jsxs(es,{defaultValue:"endurance",className:"w-full",children:[e.jsx(ss,{className:"grid w-full grid-cols-3",children:Je.map(c=>e.jsx(je,{value:c.key,children:c.label},c.key))}),Je.map(c=>{const u=`pct_1rm_${c.fieldSuffix}`,o=`Nb_series_${c.fieldSuffix}`,v=`Nb_reps_${c.fieldSuffix}`,g=`recup_${c.fieldSuffix}`,N=`recup_exercices_${c.fieldSuffix}`;return e.jsxs(ve,{value:c.key,className:`space-y-3 rounded-lg border p-3 ${x?"opacity-60":""}`,children:[e.jsx("p",{className:"text-sm font-semibold",children:c.label}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"% 1RM"}),e.jsx(S,{type:"number",value:t[u]??"",disabled:x,onChange:i=>n({[u]:i.target.value===""?null:Number(i.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Nb séries"}),e.jsx(S,{type:"number",value:t[o]??"",disabled:x,onChange:i=>n({[o]:i.target.value===""?null:Number(i.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Nb reps"}),e.jsx(S,{type:"number",value:t[v]??"",disabled:x,onChange:i=>n({[v]:i.target.value===""?null:Number(i.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Récup. séries (s)"}),e.jsx(S,{type:"number",value:t[g]??"",disabled:x,onChange:i=>n({[g]:i.target.value===""?null:Number(i.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Récup. exercices (s)"}),e.jsx(S,{type:"number",value:t[N]??"",disabled:x,onChange:i=>n({[N]:i.target.value===""?null:Number(i.target.value)})})]})]})]},c.key)})]}),lt={pct_1rm_endurance:60,pct_1rm_hypertrophie:75,pct_1rm_force:85,Nb_series_endurance:4,Nb_series_hypertrophie:3,Nb_series_force:3,Nb_reps_endurance:16,Nb_reps_hypertrophie:8,Nb_reps_force:3,recup_endurance:120,recup_hypertrophie:200,recup_force:300,recup_exercices_endurance:300,recup_exercices_hypertrophie:400,recup_exercices_force:500},X=t=>{const n=Number(t);return Number.isFinite(n)?n:0},he=(t,n,x,c)=>{const u=n==="force"?"force":n==="hypertrophie"?"hypertrophie":"endurance",o=`Nb_series_${u}`,v=`Nb_reps_${u}`,g=`pct_1rm_${u}`,N=`recup_${u}`;return{exercise_id:t.id,order_index:x,sets:X(t[o]),reps:X(t[v]),rest_seconds:X(t[N]),percent_1rm:X(t[g]),cycle_type:n,notes:c?.notes??""}},ct=()=>({nom_exercice:"",description:null,illustration_gif:null,exercise_type:"strength",warmup_reps:null,warmup_duration:null,...lt}),Ye=({exercise:t,warmupMode:n,onChange:x,onWarmupModeChange:c,idPrefix:u})=>e.jsxs("div",{className:"space-y-3 rounded-lg border p-3",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Paramètres d'échauffement"}),e.jsxs(Fs,{value:n,onValueChange:o=>{c(o==="duration"?"duration":"reps"),x(o==="duration"?{warmup_reps:null,warmup_duration:t.warmup_duration??0}:{warmup_duration:null,warmup_reps:t.warmup_reps??0})},className:"grid gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ae,{value:"reps",id:`${u}-warmup-reps`}),e.jsx(j,{htmlFor:`${u}-warmup-reps`,children:"Nombre de répétitions"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ae,{value:"duration",id:`${u}-warmup-duration`}),e.jsx(j,{htmlFor:`${u}-warmup-duration`,children:"Durée (secondes)"})]})]}),n==="duration"?e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Durée (s)"}),e.jsx(S,{type:"number",value:t.warmup_duration??"",onChange:o=>x({warmup_duration:o.target.value===""?null:Number(o.target.value)})})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Nombre de répétitions"}),e.jsx(S,{type:"number",value:t.warmup_reps??"",onChange:o=>x({warmup_reps:o.target.value===""?null:Number(o.target.value)})})]})]});function er(){const{toast:t}=Ds(),n=Es(),[x,c]=d.useState(!1),[u,o]=d.useState(null),[v,g]=d.useState(!1),[N,i]=d.useState(!1),[p,y]=d.useState(null),[M,F]=d.useState(null),[C,D]=d.useState(null),[q,h]=d.useState("reps"),[m,B]=d.useState("reps"),[K,z]=d.useState(!1),[Q,re]=d.useState(""),[U,l]=d.useState("sessions"),[_,R]=d.useState(null),G=async(s,r)=>{if(s.size>10485760){t({title:"Fichier trop volumineux",description:"La taille maximale est de 10 Mo.",variant:"destructive"});return}z(!0);try{const f=s.name.split(".").pop()??"gif",b=`exercises/${Date.now()}-${Math.random().toString(36).slice(2)}.${f}`,{error:L}=await Pe.storage.from("exercise-gifs").upload(b,s,{upsert:!1});if(L)throw L;const{data:Cs}=Pe.storage.from("exercise-gifs").getPublicUrl(b);r(Cs.publicUrl),t({title:"Image uploadée"})}catch(f){const b=f instanceof Error?f.message:"Réessayez.";t({title:"Erreur d'upload",description:b,variant:"destructive"})}finally{z(!1)}},[E,I]=d.useState({title:"",description:"",cycle:"endurance",items:[],folder_id:null}),[w,O]=d.useState({...ct()});d.useEffect(()=>{p&&B(p.warmup_duration!=null?"duration":"reps")},[p]);const{data:A,isLoading:as,error:ne,refetch:ls}=J({queryKey:["exercises"],queryFn:()=>k.getExercises()}),{data:W,isLoading:cs,error:os,refetch:ot}=J({queryKey:["strength_catalog"],queryFn:()=>k.getStrengthSessions()}),{data:V}=J({queryKey:["strength_folders","session"],queryFn:()=>k.getStrengthFolders("session")}),{data:be}=J({queryKey:["strength_folders","exercise"],queryFn:()=>k.getStrengthFolders("exercise")}),_e=s=>{const r=s.items?.reduce((a,f)=>a+(f.sets||0),0)??0;return e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"capitalize",children:s.cycle}),e.jsx("span",{children:"·"}),e.jsxs("span",{children:[s.items?.length??0," exos"]}),e.jsx("span",{children:"·"}),e.jsxs("span",{children:[r," séries"]})]})},ie=d.useMemo(()=>{if(!W)return[];if(!Q.trim())return W;const s=Q.toLowerCase();return W.filter(r=>r.title?.toLowerCase().includes(s))},[W,Q]),ds=ie.filter(s=>!s.folder_id),us=d.useMemo(()=>{const s=new Map;for(const r of ie)if(r.folder_id){const a=s.get(r.folder_id)??[];a.push(r),s.set(r.folder_id,a)}return s},[ie]),ms=d.useMemo(()=>(A??[]).filter(s=>!s.folder_id),[A]),xs=d.useMemo(()=>{const s=new Map;for(const r of A??[])if(r.folder_id){const a=s.get(r.folder_id)??[];a.push(r),s.set(r.folder_id,a)}return s},[A]),ps=P({mutationFn:s=>k.createExercise(s),onSuccess:()=>{n.invalidateQueries({queryKey:["exercises"]}),g(!1),t({title:"Exercice ajouté"})}}),we=P({mutationFn:s=>k.createStrengthSession(s),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_catalog"]}),c(!1),I({title:"",description:"",cycle:"endurance",items:[],folder_id:null}),t({title:"Séance créée avec succès"})}}),hs=P({mutationFn:s=>k.updateExercise(s),onSuccess:()=>{n.invalidateQueries({queryKey:["exercises"]}),n.invalidateQueries({queryKey:["strength_catalog"]}),i(!1),y(null),t({title:"Exercice mis à jour"})}}),fs=P({mutationFn:s=>k.deleteExercise(s),onSuccess:()=>{n.invalidateQueries({queryKey:["exercises"]}),n.invalidateQueries({queryKey:["strength_catalog"]}),D(null),t({title:"Exercice supprimé"})}}),ae=P({mutationFn:s=>k.deleteStrengthSession(s),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_catalog"]}),F(null),t({title:"Séance supprimée"})}}),Se=P({mutationFn:s=>k.updateStrengthSession(s),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_catalog"]}),c(!1),o(null),I({title:"",description:"",cycle:"endurance",items:[],folder_id:null}),t({title:"Séance mise à jour"})}}),gs=P({mutationFn:s=>k.persistStrengthSessionOrder(s)}),js=P({mutationFn:({name:s,type:r})=>k.createStrengthFolder(s,r),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_folders"]}),t({title:"Dossier créé"})}}),Ce=P({mutationFn:({id:s,name:r})=>k.renameStrengthFolder(s,r),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_folders"]}),t({title:"Dossier renommé"})}}),Ee=P({mutationFn:s=>k.deleteStrengthFolder(s),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_folders"]}),n.invalidateQueries({queryKey:["strength_catalog"]}),n.invalidateQueries({queryKey:["exercises"]}),t({title:"Dossier supprimé"})}}),le=P({mutationFn:({itemId:s,folderId:r,table:a})=>k.moveToFolder(s,r,a),onSuccess:()=>{n.invalidateQueries({queryKey:["strength_catalog"]}),n.invalidateQueries({queryKey:["exercises"]}),t({title:"Déplacé"})}}),vs=()=>{c(!1),o(null),I({title:"",description:"",cycle:"endurance",items:[],folder_id:null})},H=s=>{o(s.id),I({title:s.title??"",description:s.description??"",cycle:at(s.cycle),items:s.items?.map(r=>({exercise_id:r.exercise_id,order_index:r.order_index??0,sets:r.sets,reps:r.reps,rest_seconds:r.rest_seconds,percent_1rm:r.percent_1rm,cycle_type:r.cycle_type,notes:r.notes??""}))??[],folder_id:s.folder_id??null}),c(!0)},ys=s=>{y(s),i(!0)},Ns=()=>{const s={...E,items:ce(E.items)};u?Se.mutate({...s,id:u}):we.mutate(s)},ce=s=>s.map((r,a)=>({...r,order_index:a})),bs=()=>{const s=A?.[0];I(r=>({...r,items:[...r.items,s?he(s,r.cycle,r.items.length):{exercise_id:1,order_index:r.items.length,sets:0,reps:0,rest_seconds:0,percent_1rm:0}]}))},_s=(s,r,a)=>{const f=[...E.items];if(r==="exercise_id"){const b=A?.find(L=>L.id===a);b?f[s]=he(b,E.cycle,f[s].order_index??s,f[s]):f[s]={...f[s],exercise_id:Number(a)}}else f[s]={...f[s],[r]:a};I({...E,items:f})},ws=s=>{const r=ce(E.items.filter((a,f)=>f!==s));I({...E,items:r})},Ss=(s,r)=>{if(s===r)return;const a=[...E.items],[f]=a.splice(s,1);a.splice(r,0,f);const b=ce(a);I({...E,items:b}),u&&gs.mutate({id:u,title:E.title,description:E.description,cycle:E.cycle,items:b})},ke=e.jsx(se,{open:N,onOpenChange:i,children:e.jsxs(te,{className:"sm:max-w-3xl max-h-[85vh] overflow-y-auto pb-safe",children:[e.jsx(fe,{children:e.jsx(ge,{children:"Modifier l'exercice"})}),p&&e.jsxs("div",{className:"space-y-4",children:[p.exercise_type==="warmup"?e.jsx(Ye,{exercise:p,warmupMode:m,onChange:s=>y(r=>r&&{...r,...s}),onWarmupModeChange:B,idPrefix:"edit"}):null,e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Nom"}),e.jsx(S,{value:p.nom_exercice,onChange:s=>y({...p,nom_exercice:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Description"}),e.jsx(ee,{value:p.description??"",onChange:s=>y({...p,description:s.target.value===""?null:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Illustration (GIF)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{value:p.illustration_gif??"",onChange:s=>y({...p,illustration_gif:s.target.value===""?null:s.target.value}),placeholder:"https://...",className:"flex-1"}),e.jsx($,{type:"button",variant:"outline",size:"icon",disabled:K,onClick:()=>{const s=document.createElement("input");s.type="file",s.accept="image/*,.gif",s.onchange=r=>{const a=r.target.files?.[0];a&&G(a,f=>y(b=>b&&{...b,illustration_gif:f}))},s.click()},"aria-label":"Uploader une image",children:K?e.jsx(Ge,{className:"h-4 w-4 animate-spin"}):e.jsx(We,{className:"h-4 w-4"})})]}),p.illustration_gif&&e.jsx("img",{src:p.illustration_gif,alt:"Aperçu",className:"mt-2 h-20 w-20 rounded-lg object-cover border"})]}),p.exercise_type!=="warmup"?e.jsx(Xe,{exercise:p,onChange:s=>y(r=>r&&{...r,...s})}):null,e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{id:"warmup-flag-edit",checked:p.exercise_type==="warmup",onCheckedChange:s=>y({...p,exercise_type:s===!0?"warmup":"strength"})}),e.jsx(j,{htmlFor:"warmup-flag-edit",children:"Exercice d'échauffement (warmup)"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx($,{variant:"outline",onClick:()=>{i(!1),y(null)},className:"h-10",children:"Annuler"}),e.jsx($,{variant:"default",onClick:()=>{p?.id&&hs.mutate(p)},disabled:!p.nom_exercice.trim(),className:"h-10",children:"Enregistrer"})]})]})]})}),De=e.jsx(se,{open:v,onOpenChange:g,children:e.jsxs(te,{className:"sm:max-w-3xl max-h-[85vh] overflow-y-auto pb-safe",children:[e.jsx(fe,{children:e.jsx(ge,{children:"Créer un exercice"})}),e.jsxs("div",{className:"space-y-4",children:[w.exercise_type==="warmup"?e.jsx(Ye,{exercise:w,warmupMode:q,onChange:s=>O(r=>({...r,...s})),onWarmupModeChange:h,idPrefix:"create"}):null,e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Nom"}),e.jsx(S,{value:w.nom_exercice,onChange:s=>O({...w,nom_exercice:s.target.value}),placeholder:"ex: Rotations Élastique"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Description"}),e.jsx(ee,{value:w.description??"",onChange:s=>O({...w,description:s.target.value===""?null:s.target.value}),placeholder:"Détails, consignes..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{children:"Illustration (GIF)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{value:w.illustration_gif??"",onChange:s=>O({...w,illustration_gif:s.target.value===""?null:s.target.value}),placeholder:"https://...",className:"flex-1"}),e.jsx($,{type:"button",variant:"outline",size:"icon",disabled:K,onClick:()=>{const s=document.createElement("input");s.type="file",s.accept="image/*,.gif",s.onchange=r=>{const a=r.target.files?.[0];a&&G(a,f=>O(b=>({...b,illustration_gif:f})))},s.click()},"aria-label":"Uploader une image",children:K?e.jsx(Ge,{className:"h-4 w-4 animate-spin"}):e.jsx(We,{className:"h-4 w-4"})})]}),w.illustration_gif&&e.jsx("img",{src:w.illustration_gif,alt:"Aperçu",className:"mt-2 h-20 w-20 rounded-lg object-cover border"})]}),w.exercise_type!=="warmup"?e.jsx(Xe,{exercise:w,onChange:s=>O(r=>({...r,...s}))}):null,e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{id:"warmup-flag",checked:w.exercise_type==="warmup",onCheckedChange:s=>O({...w,exercise_type:s===!0?"warmup":"strength"})}),e.jsx(j,{htmlFor:"warmup-flag",children:"Exercice d'échauffement (warmup)"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx($,{variant:"outline",onClick:()=>g(!1),className:"h-10",children:"Annuler"}),e.jsx($,{variant:"default",onClick:()=>ps.mutate(w),disabled:!w.nom_exercice.trim(),className:"h-10",children:"Enregistrer"})]})]})]})}),Fe=e.jsx(qe,{open:!!M,onOpenChange:s=>{s||F(null)},children:e.jsxs(Re,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:"Supprimer la séance ?"}),e.jsxs(Ke,{children:['Cette action est définitive. La séance "',M?.title,'" sera supprimée.']})]}),e.jsxs(Qe,{children:[e.jsx(Le,{children:"Annuler"}),e.jsx(ze,{onClick:()=>{M?.id&&ae.mutate(M.id)},children:"Supprimer"})]})]})}),Me=e.jsx(qe,{open:!!C,onOpenChange:s=>{s||D(null)},children:e.jsxs(Re,{children:[e.jsxs(Oe,{children:[e.jsx($e,{children:"Supprimer l'exercice ?"}),e.jsxs(Ke,{children:[`Cette action est définitive. L'exercice "`,C?.nom_exercice,'" sera supprimé.']})]}),e.jsxs(Qe,{children:[e.jsx(Le,{children:"Annuler"}),e.jsx(ze,{onClick:()=>{C?.id&&fs.mutate(C.id)},children:"Supprimer"})]})]})});if(x)return e.jsxs(e.Fragment,{children:[De,ke,Fe,Me,e.jsx(it,{session:E,exercises:A??[],editingSessionId:u,folders:V,onSessionChange:I,onCycleChange:s=>{const r=E.items.map((a,f)=>{const b=A?.find(L=>L.id===a.exercise_id);return b?he(b,s,f,a):{...a,cycle_type:s}});I({...E,cycle:s,items:r})},onSave:Ns,onCancel:vs,onAddItem:bs,onUpdateItem:_s,onRemoveItem:ws,onReorderItems:Ss,onExerciseDialogOpen:()=>g(!0),isSaving:we.isPending||Se.isPending})]});if(as)return e.jsxs("div",{className:"space-y-4 p-4",children:[e.jsx(oe,{className:"h-7 w-64"}),e.jsx(oe,{className:"h-10 w-full rounded-2xl"}),e.jsx("div",{className:"space-y-3",children:Array.from({length:4}).map((s,r)=>e.jsx(oe,{className:"h-20 w-full rounded-2xl"},r))})]});if(ne)return e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[e.jsx(Js,{className:"h-12 w-12 text-destructive mb-4"}),e.jsx("h3",{className:"font-semibold",children:"Impossible de charger les données"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:ne instanceof Error?ne.message:"Une erreur s'est produite"}),e.jsx($,{variant:"default",onClick:()=>ls(),className:"mt-4 h-12 md:h-10",children:"Réessayer"})]});const Ie=s=>e.jsxs("div",{className:"flex items-center gap-3 rounded-xl px-3 py-2 hover:bg-muted/50",children:[s.illustration_gif?e.jsx("button",{type:"button",className:"shrink-0 rounded-lg overflow-hidden border border-border bg-muted",onClick:()=>R({url:s.illustration_gif,name:s.nom_exercice}),children:e.jsx("img",{src:s.illustration_gif,alt:s.nom_exercice,className:"h-10 w-10 object-cover",loading:"lazy",decoding:"async"})}):e.jsx("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-lg bg-muted",children:e.jsx(ye,{className:"h-4 w-4 text-muted-foreground"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"truncate text-sm font-medium",children:s.nom_exercice}),e.jsx("div",{className:"text-xs text-muted-foreground",children:s.exercise_type==="warmup"?"Échauffement":"Séries de travail"})]}),e.jsxs("div",{className:"flex shrink-0 items-center gap-1",children:[e.jsx(pe,{folders:be??[],currentFolderId:s.folder_id,onMove:r=>le.mutate({itemId:s.id,folderId:r,table:"dim_exercices"})}),e.jsx("button",{type:"button",onClick:()=>ys(s),className:"inline-flex h-9 w-9 items-center justify-center rounded-full hover:bg-muted","aria-label":"Modifier",children:e.jsx(Ys,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:()=>D(s),className:"inline-flex h-9 w-9 items-center justify-center rounded-full text-destructive hover:bg-destructive/10","aria-label":"Supprimer",children:e.jsx(Ne,{className:"h-4 w-4"})})]})]},s.id);return e.jsxs("div",{children:[De,ke,Fe,Me,_&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/60 flex items-center justify-center p-4",onClick:()=>R(null),children:e.jsxs("div",{className:"relative max-w-md w-full",onClick:s=>s.stopPropagation(),children:[e.jsx("img",{src:_.url,alt:_.name,className:"w-full max-h-[80vh] object-contain rounded-2xl"}),e.jsx("p",{className:"mt-2 text-sm font-medium text-center text-white",children:_.name})]})}),e.jsxs("div",{className:"flex items-center justify-between border-b border-border px-4 py-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-base font-semibold",children:"Musculation"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Catalogue"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>{const s=prompt("Nom du dossier");s?.trim()&&js.mutate({name:s.trim(),type:U==="sessions"?"session":"exercise"})},className:"inline-flex items-center gap-2 rounded-full border border-border px-3 py-2 text-xs font-semibold hover:bg-muted",children:[e.jsx(qs,{className:"h-4 w-4"})," Dossier"]}),U==="sessions"?e.jsxs("button",{type:"button",onClick:()=>{o(null),I({title:"",description:"",cycle:"endurance",items:[],folder_id:null}),c(!0)},className:"inline-flex items-center gap-2 rounded-full bg-primary px-3 py-2 text-xs font-semibold text-primary-foreground",children:[e.jsx(Z,{className:"h-4 w-4"})," Nouvelle"]}):e.jsxs("button",{type:"button",onClick:()=>g(!0),className:"inline-flex items-center gap-2 rounded-full bg-primary px-3 py-2 text-xs font-semibold text-primary-foreground",children:[e.jsx(Z,{className:"h-4 w-4"})," Ajouter"]})]})]}),e.jsx("div",{className:"p-4 space-y-4",children:e.jsxs(es,{value:U,onValueChange:s=>l(s),children:[e.jsxs(ss,{className:"grid w-full grid-cols-2",children:[e.jsx(je,{value:"sessions",children:"Séances"}),e.jsxs(je,{value:"exercises",children:["Exercices (",A?.length??0,")"]})]}),e.jsxs(ve,{value:"sessions",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-border bg-card px-3 py-2",children:[e.jsx(Xs,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("input",{className:"w-full bg-transparent text-sm outline-none placeholder:text-muted-foreground",placeholder:"Rechercher une séance",value:Q,onChange:s=>re(s.target.value)})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(Ue,{sessions:ds,isLoading:cs,error:os,renderTitle:s=>s.title??"Sans titre",renderMetrics:_e,renderExtraActions:s=>e.jsx(pe,{folders:V??[],currentFolderId:s.folder_id,onMove:r=>le.mutate({itemId:s.id,folderId:r,table:"strength_sessions"})}),onPreview:s=>H(s),onEdit:s=>H(s),onDelete:s=>F(s),canDelete:()=>!0,isDeleting:ae.isPending}),V?.map(s=>{const r=us.get(s.id)??[];return e.jsx(He,{name:s.name,count:r.length,onRename:a=>Ce.mutate({id:s.id,name:a}),onDelete:()=>Ee.mutate(s.id),children:r.length>0?e.jsx(Ue,{sessions:r,renderTitle:a=>a.title??"Sans titre",renderMetrics:_e,renderExtraActions:a=>e.jsx(pe,{folders:V??[],currentFolderId:a.folder_id,onMove:f=>le.mutate({itemId:a.id,folderId:f,table:"strength_sessions"})}),onPreview:a=>H(a),onEdit:a=>H(a),onDelete:a=>F(a),canDelete:()=>!0,isDeleting:ae.isPending}):e.jsx("div",{className:"rounded-xl border border-dashed border-border px-3 py-4 text-center text-xs text-muted-foreground",children:"Dossier vide"})},s.id)})]})]}),e.jsxs(ve,{value:"exercises",className:"space-y-3 mt-4",children:[e.jsx("div",{className:"space-y-1",children:ms.map(Ie)}),be?.map(s=>{const r=xs.get(s.id)??[];return e.jsx(He,{name:s.name,count:r.length,onRename:a=>Ce.mutate({id:s.id,name:a}),onDelete:()=>Ee.mutate(s.id),children:r.length>0?e.jsx("div",{className:"space-y-1",children:r.map(Ie)}):e.jsx("div",{className:"rounded-xl border border-dashed border-border px-3 py-4 text-center text-xs text-muted-foreground",children:"Dossier vide"})},s.id)})]})]})})]})}export{he as createStrengthItemFromExercise,er as default};
