import{j as n}from"./vendor-query-DyA9aSKS.js";import{B as p}from"./badge-B_1-XC-V.js";const E=["50NL","100NL","200NL","400NL","800NL","1500NL","50DOS","100DOS","200DOS","50BR","100BR","200BR","50PAP","100PAP","200PAP","200QN","400QN"];function h(e){const t=e.match(/^(\d+)(NL|DOS|BR|PAP|QN)$/);if(!t)return e;const s={NL:"Nage Libre",DOS:"Dos",BR:"Brasse",PAP:"Papillon",QN:"4 Nages"};return`${t[1]}m ${s[t[2]]||t[2]}`}function c(e){const t=Math.floor(e/60),s=e%60,r=Math.floor(s),o=Math.round((s-r)*100);return`${t}:${String(r).padStart(2,"0")}:${String(o).padStart(2,"0")}`}function y(e){const t=e.match(/^(\d+):(\d{2})[.::](\d{2})$/);return t?parseInt(t[1])*60+parseInt(t[2])+parseInt(t[3])/100:null}const _={"50NL":["50 NL","50 Nage Libre"],"100NL":["100 NL","100 Nage Libre"],"200NL":["200 NL","200 Nage Libre"],"400NL":["400 NL","400 Nage Libre"],"800NL":["800 NL","800 Nage Libre"],"1500NL":["1500 NL","1500 Nage Libre"],"50DOS":["50 Dos"],"100DOS":["100 Dos"],"200DOS":["200 Dos"],"50BR":["50 Brasse","50 Bra."],"100BR":["100 Brasse","100 Bra."],"200BR":["200 Brasse","200 Bra."],"50PAP":["50 Papillon","50 Pap","50 Pap."],"100PAP":["100 Papillon","100 Pap","100 Pap."],"200PAP":["200 Papillon","200 Pap","200 Pap."],"200QN":["200 4 Nages","200 4N","200 4 N."],"400QN":["400 4 Nages","400 4N","400 4 N."]},P={NL:"border-l-blue-500",DOS:"border-l-emerald-500",BR:"border-l-red-500",PAP:"border-l-violet-500",QN:"border-l-amber-500"};function b(e){const t=e.match(/^(\d+)(NL|DOS|BR|PAP|QN)$/);return t?t[2]:null}const L={50:1,100:4,200:10,400:15,800:30,1500:45};function B(e){const t=e.match(/^(\d+)(NL|DOS|BR|PAP|QN)$/);return t?Number(t[1]):null}function S(e,t,s){if(e<=t)return 100;const r=B(s),o=r?L[r]??10:10,a=t+o;return e>=a?0:Math.round((a-e)/(a-t)*100)}function D(e,t,s){const r=_[t];if(!r)return null;const o=r.map(l=>l.toLowerCase());let a=null;for(const l of e)l.time_seconds!=null&&o.includes(l.event_code.toLowerCase())&&(s!=null&&l.pool_length!=null&&l.pool_length!==s||(a===null||l.time_seconds<a.time)&&(a={time:l.time_seconds,date:l.competition_date??null}));return a}function O(e){return e>=100?"bg-emerald-500":e>=75?"bg-green-500":e>=50?"bg-yellow-500":e>=25?"bg-orange-500":"bg-red-500"}function A(e){const t=new Date;t.setHours(0,0,0,0);const s=new Date(e+"T00:00:00");return Math.ceil((s.getTime()-t.getTime())/(1e3*60*60*24))}const R={NL:"bg-blue-50/50 dark:bg-blue-950/15",DOS:"bg-emerald-50/50 dark:bg-emerald-950/15",BR:"bg-rose-50/50 dark:bg-rose-950/15",PAP:"bg-violet-50/50 dark:bg-violet-950/15",QN:"bg-amber-50/50 dark:bg-amber-950/15"};function C({objective:e,performances:t=[],onClick:s,compact:r=!1,showCoachBadge:o=!1}){const a=!!e.event_code,l=a?b(e.event_code):null,N=l?P[l]??"border-l-muted-foreground/30":"border-l-muted-foreground/30",g=l?R[l]??"bg-muted/20":"bg-muted/20",d=a?D(t,e.event_code,e.pool_length):null;let i=null,m=null;d&&e.target_time_seconds!=null&&e.event_code&&(i=d.time-e.target_time_seconds,m=S(d.time,e.target_time_seconds,e.event_code));const f=!!e.competition_name,u=e.competition_date?A(e.competition_date):null,x=s?"button":"div";return n.jsxs(x,{type:s?"button":void 0,className:["w-full text-left rounded-r-lg border-l-4",N,g,r?"px-2.5 py-1.5":"px-3 py-2.5","transition-colors",s?"hover:brightness-95 dark:hover:brightness-110 active:scale-[0.995]":""].join(" "),onClick:s,children:[n.jsxs("div",{className:"flex items-baseline gap-2 min-w-0",children:[n.jsx("span",{className:`font-semibold truncate ${r?"text-xs":"text-sm"}`,children:a?h(e.event_code):e.text?"Objectif":"—"}),a&&e.pool_length&&n.jsxs("span",{className:"text-muted-foreground/60 text-xs shrink-0",children:[e.pool_length,"m"]}),o&&n.jsx(p,{variant:"secondary",className:"text-[9px] px-1 py-0 leading-tight ml-auto shrink-0",children:"Coach"})]}),e.text&&n.jsx("p",{className:`text-muted-foreground mt-0.5 ${r?"text-[11px] truncate":"text-xs line-clamp-2"}`,children:e.text}),e.target_time_seconds!=null&&n.jsxs("div",{className:`flex items-center gap-3 mt-1.5 font-mono tabular-nums ${r?"text-[11px]":"text-xs"}`,children:[n.jsx("span",{className:"text-primary font-medium",children:c(e.target_time_seconds)}),d&&n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-muted-foreground",children:c(d.time)}),i!=null&&n.jsx("span",{className:i<=0?"text-emerald-600 font-semibold":"text-muted-foreground",children:i<=0?"Atteint":`+${i.toFixed(1)}s`})]})]}),a&&e.target_time_seconds!=null&&!d&&t.length>0&&n.jsx("p",{className:"text-[10px] text-muted-foreground/50 mt-1 italic",children:"Pas encore de temps enregistré"}),m!=null&&n.jsx("div",{className:"mt-1.5",children:n.jsx("div",{className:"h-1 w-full rounded-full bg-black/5 dark:bg-white/5 overflow-hidden",children:n.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${O(m)}`,style:{width:`${Math.min(m,100)}%`}})})}),f&&n.jsxs("p",{className:`text-muted-foreground/60 mt-1 ${r?"text-[10px]":"text-[11px]"}`,children:[e.competition_name,u!=null&&u>0&&n.jsxs("span",{className:"ml-1",children:["· J-",u]})]})]})}export{E as F,C as O,h as e,c as f,y as p};
